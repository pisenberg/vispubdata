<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Visualizing DIII-D Tokamak Magnetic Field Lines</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Greg</forename><surname>Schussman</surname></persName>
							<email>schussma@cs.ucdavis.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kwan-Liu</forename><surname>Ma</surname></persName>
							<email>ma@cs.ucdavis.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Schissel</surname></persName>
							<email>schissel@fusion.gat.com</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Todd</forename><surname>Evans</surname></persName>
							<email>evans@fusion.gat.com</email>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="institution">University of California</orgName>
								<address>
									<settlement>Davis</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Center for Image Processing and Integrated Com-puting (CIPIC)</orgName>
								<orgName type="department" key="dep2">Department of Computer Science</orgName>
								<orgName type="department" key="dep3">Davis</orgName>
								<orgName type="institution">Uni-versity of California</orgName>
								<address>
									<postCode>95616-8562</postCode>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<orgName type="department">General Atomics Court</orgName>
								<address>
									<addrLine>San Diego</addrLine>
									<postCode>3550, 92121-1194</postCode>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Visualizing DIII-D Tokamak Magnetic Field Lines</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-19T20:43+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Graphics hardware</term>
					<term>haloed lines</term>
					<term>illuminated lines</term>
					<term>interactive visualization</term>
					<term>magnetic field</term>
					<term>plasma physics</term>
					<term>tokamak</term>
				</keywords>
			</textClass>
			<abstract>
				<p>We demonstrate the use of a combination of perceptually effective techniques for visualizing magnetic field data from the DIII-D Tokamak. These techniques can be implemented to run very efficiently on machines with hardware support for OpenGL. Interactive speeds facilitate clear communication of magnetic field structure, enhancing fusion scientists&apos; understanding of their data, and thereby accelerating their research.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Fusion is the power source of the sun and other stars. It occurs when forms of the lightest atom, hydrogen, are combined to make helium in a very hot (100 million degrees centigrade) ionized gas or "plasma." In this process a small amount of matter involved in the reaction is converted to a large amount of energy. On earth, fusion could provide a safe, environmentally attractive and affordable long-term energy source.</p><p>One technique scientists have been using to contain this hot plasma on earth is called magnetic confinement. One implementation of this concept, called a tokamak, employs magnetic fields in a doughnut shaped configuration to confine the plasma <ref type="bibr" target="#b6">[7]</ref>. Experiments on tokamaks have involved plasma pulses where the hot plasma exists for tens of seconds and the pulse is repeated with a tens of minutes cycle time. Fundamental to this type of research is the detailed knowledge of the magnetic field topology since the tokamak magnetic field is generated in part from currents flowing in the hot plasma. This analysis is important in between pulses to guide the research and is also to be performed in more detail at the conclusion of experimental operation for comprehensive analysis of the results.</p><p>The DIII-D tokamak (a National Fusion Facility, http://fusion.gat.com) was designed and built in the late 1970s by General Atomics. Color Plate 1 shows the exterior of the DIII-D tokamak, with a cutaway exposing the interior. General Atomics, with main facilities in San Diego, California, specializes in diversified research and development in energy, defense, and other advanced technologies. The Fusion Group is a division of General Atomics, which conducts both experimental and computational fusion plasma research using the DIII-D. The scientific and engineering advances in the study of complex plasma physics are increasingly dependent on new approaches to computing, information handling, and communication <ref type="bibr" target="#b4">[5]</ref>. Scientists at General Atomics are conducting studies that grow rather quickly in both scale and complexity. Consequently, gleaning understanding from the results becomes increasingly problematic with traditional two-dimensional data analysis routines.</p><p>Visualization transforms raw data into graphical representations that utilize the high-bandwidth channel of the human visual system, exploiting the brain's remarkable ability to detect patterns and draw inferences. Interactive threedimensional visualization techniques would offer scientists at General Atomics much richer and more natural approaches to the exploration and analysis of their data. Their data analysis throughput will be increased, as well as their capability to communicate their findings. The resulting improved productivity will therefore accelerate the development of many key technologies at the Fusion Group, and significantly advance General Atomics' work in plasma physics.</p><p>In this case study, we describe the visualization technology we have developed in close collaboration with members of the Fusion Group at General Atomics. Specifically, interactive 3D visualization techniques and interfacing mechanisms have been developed for following magnetic field lines around a tokamak and examining the effect of small random variations in toroidal field coil placement on the vacuum magnetic topology. A mechanism has also been developed to aid scientists in identifying and learning about the formation of "magnetic islands". These islands form within the magnetic field that confines a plasma undergoing nuclear fusion in a tokamak and are detrimental to fusion confinement. In addition, the interactive 3D visualization capability allows the scientists to arbitrarily cut through the 3D surface to create a 2D plot, to rotate the 3D image, to animate any of the field lines, and to see the field lines from any perspective.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">RELATED WORK</head><p>Vector field visualization has been a hot topic of computer science research. The problem of displaying streamlines in fluid flow is similar to displaying magnetic field lines. Different visualization strategies must be developed for different purposes such as presentation, exploratory analysis, and remote visualization. However, the ability to identify features at different scales must be uniformly supported.</p><p>Traditionally, on graphics workstations, field lines have been rendered as flat-shaded line segments, or as polygonal tubes. <ref type="figure" target="#fig_0">Figure 1a</ref> illustrates how flat-shaded line segments impair the spatial perception of an image. Displaying field lines as polygonal tubes severely limits the number of lines that can be displayed in a scene, for several reasons. First, when the density of a collection of field lines approaches the radius of the tubes, the tubes intersect one another and no longer appear distinct. Second, rendering several polygons in place of a single line segment is much more expensive in terms of memory requirements and rendering speed. An accurate shading of line primitives can significantly improve spatial perception of structure of the lines. It has been shown that good illuminated lines can be displayed at interactive rates by utilizing texture mapping hardware <ref type="bibr" target="#b5">[6,</ref><ref type="bibr" target="#b7">8]</ref>. The idea is to color thin lines in a way that mimics the way we see thin fibers in the real world. For example, when looking at the hair on someone's head, most people do not see individual hairs. However, because of the way light reflects off of hair as it curves, producing highlights, it is easy to discern the overall structure of someone's haircut. <ref type="figure" target="#fig_0">Figure 1b</ref> was generated using this illumination technique.</p><p>Other perceptual issues such as halo and self-shadowing to derive highly informative visualization results have also been discussed <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b1">2,</ref><ref type="bibr" target="#b3">4]</ref>. It is common practice, when sketching 3D wireframe objects by hand, to break a line as it passes underneath a line that should be on top. From the standpoint of computer graphics, it is convenient to think of the lines as having a dark halo around them. When the lines and their halos are rendered, the halos obstruct the view of any lines passing behind them. <ref type="figure" target="#fig_0">Figure 1c</ref> shows an example of haloing, and how it conveys the relative depths of crossing lines. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">DIII-D FIELD LINE VISUALIZATION</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">The Data</head><p>Numerical simulations using the tokamak geometry calculate the magnetic field line topology inside the high temperature fusion plasma. The magnetic field strength at the outer boundary of the plasma is then compared to experimental measurements to ensure the accuracy of the calculation <ref type="bibr" target="#b2">[3]</ref>. Simulated low energy charged particles are placed at seed locations inside the plasma on a magnetic field line. In the simulation, the charged seed particles stick to the magnetic field lines. Therefore, seed particle paths correspond to the locations of conceptual magnetic field lines within the tokamak. Each magnetic field line path is calculated for 200 revolutions going the long way (toroidally) around the tokamak. The magnetic field line also twists the short way around (poloidally) as it makes those revolutions which results in a helical path for the field. The end of the magnetic field line after one revolution typically does not have the same location as the original starting point. Therefore, after 200 revolutions, the magnetic field line can be thought of as being spread out over an imaginary surface, usually shaped like a torus.</p><p>Each seed point generates a separate field line, which indicates a separate surface. These surfaces never intersect one another, and, ideally, they nest neatly one within another, similar to the layers of an onion. This idea is illustrated in the cutaway drawing in Color Plate 1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">The 3D view</head><p>To produce a 3D view, we combined haloing and illumination, providing a better overall sense of shape than either techique alone, as shown in <ref type="figure" target="#fig_1">Figure 2</ref>.</p><p>Our system achieved interactive frame rates by exploiting hardware texturing and display lists. Only two display lists are used to draw any given scene. One display list contains all halo line segments, and another contains all corresponding textured line segments.</p><p>For the illuminated field lines, we used a 128 by 128 pixel texture. This texture can be recalculated at interactive rates, in response to a user adjusting lighting parameters. In <ref type="bibr" target="#b5">[6]</ref>, light intensity at each point in a scene was given by a slightly modified version of the popular Phong illumination equation:</p><formula xml:id="formula_0">I = I ambient + I dif f use + I specular = ka + k d (L • N ) p + ks(V • R) n</formula><p>Where the dot product terms are replaced with approximations corresponding to lines instead of to surfaces. To compensate for the resulting excess brightness, the exponent p is added, improving spatial perception by reducing brightness and increasing contrast. For the pictures in this paper, we used the illumination parameters ka = 0.10, k d = 0.90, ks = 0.90, n = 78, and p = 4, which are different from those used in <ref type="bibr" target="#b5">[6]</ref>. These parameter values emphasize the surface shapes. The halo widths are 6 pixels, and the line widths are 1.5 pixels, antialiased. Although the 3D picture can become too cluttered when displaying more than one field line at at time, we allow the user to quickly change from viewing one field line to the next. This can be done one at a time, or by means of an animation. The net result is to provide the user with a good sense of where these surfaces are with respect to one another.</p><p>We permit the user to look at the field line from any angle or distance, including looking at the inside of the torus, as shown in Color Plate 3.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">The 2D view</head><p>The magnetic islands are of primary interest to the scientists. Although the three dimensional view of the field lines easily indicate the presence of a magnetic island, it does not readily produce a good sense of the shape of the island's cross section. If the torus were sliced like a pizza, the intersection of the field line with each slicing plane produces a poloidal plot. This plot shows 200 points per field line, one point indicating where each revolution of the field line intesected the slicing plane.</p><p>Magnetic islands can be on the order of millimeters, whereas the DIII-D tokamak data covers an area about 4. meters across. Therefore, we allow the user to interactively pan and zoom the poloidal plot. Color Plate 4 shows a sequence of views, progressively zoomed in on the edge of a magnetic island. We increased the point size as the user zooms, but impose an upper limit. This allows very close points to become distinct under greater magnification. The three dimensional view can become too cluttered when displaying more than one field line. The poloidal plot, however, can show the cross section of many field lines simultaneously because they form nice, distinct layers, as seen in Color Plate 4b. When constructing a poloidal plot for more than one field line, we assign different colors to the points to indicate which field line they come from. <ref type="figure" target="#fig_2">Figure 3</ref> shows a sequence of field lines. The first surface is contained within the second, and so on. The last picture corresponds to the outermost shell of the data. Each shell is contained within the next, with the exception of magnetic islands. <ref type="figure" target="#fig_2">Figure 3</ref>, Sample 0 shows a well behaved surface. <ref type="figure" target="#fig_2">Figure 3</ref>, Sample 11 shows the surface corresponding to one magnetic island. <ref type="figure" target="#fig_2">Figure 3</ref>, sample 42 shows a different island.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">RESULTS</head><p>In the case of a magnetic island, the surface does not form a torus shaped surface. Rather, it is squashed between layers When a magnetic field line indicates a surface that is not a torus, we see a magnetic island. Color Plate 3 shows a yellow island squeezed between well-behaved green and violet layers. The islands are very flat, so they appear as ribbons in the three dimensional view.</p><p>It is most useful to see both a 3D view and a 2D poloidal plot together. Color Plate 2a shows a blue circle in the 3D view, which indicates where the cutting plane is for the poloidal plot. In Color Plate 2b, the same blue circe is shown in the poloidal plot, along with the white points of an island.</p><p>A challenge to working with tokamak magnetic field lines is that there is no guarantee that they will trace out a nice surface. It is possible for the lines to spread out over the surface in a uniform way, as in <ref type="figure" target="#fig_2">Figure 3</ref>, Samples 0 and 11. It is also possible for the field line to cluster in dense groups in some areas while leaving gaps in others. The dense groups can almost look like ribbons. <ref type="figure" target="#fig_2">Figure 3</ref>, Samples 15, 37, 40, and 42 show these surfaces.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">CONCLUSIONS</head><p>Magnetic islands are detrimental to the energy confinement of high temperature plasmas contained within a tokamak. Visualizing the magnetic fields within the DIII-D tokamak can help scientists understand and combat magnetic islands.</p><p>We have constructed software to interactively present scientists with three dimensional views of tokamak magnetic fields. The field lines are rendered using techiques to enhance perception of their spatial structure. In addition, an interactive two dimensional plot of a cross section of the three dimensional field lines is available to the scientists. The combination of these two views enable scientists to interact more naturally and quickly with their data.</p><p>The seed particles described earlier are low energy and trace out the magnetic field lines. However, to increase the number of fusion reactions that occur within the plasma, the temperature of the plasma must be very high. The plasma temperature is raised either by injecting very energetic particles or by using Radio Frequency heating to raise the energy of particles that are in the plasma. Such high energy particles have very complex orbits that do not trace out the magnetic field lines. Understanding these complex orbits by utilizing better visualization techniques would be very helpful to the fusion research program. The visualization techniques described in this paper should be directly applicable to visualizing high energy particle orbits. Future work will address this issue. Finally, the ability to interactively run these simulations while visualizing these orbits would greatly enhance the efficiency of the scientific research.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">ACKNOWEDGEMENTS</head></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>(a) Flat Shaded lines are difficult to understand. (b) Illuminated lines provide a better sense of shape. (c) Haloed lines show which line is in front.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>Haloing and illumination enhance visual perception of the magnetic field line. (a) Constant color (flat shaded) lines make the image confusing. (b) Illumination clarifies the overall shape. (c) Haloing definitely shows the poloidal twist of the field line, but leaves the image looking two-dimensional. (d) Combined haloing and illumination conveys detailed field line structure as well as overall three-dimensional shape.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 3 :</head><label>3</label><figDesc>Slightly different seed locations can produce very different magnetic flux surfaces.</figDesc></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>This work has been supported by General Atomics, UC Digital Media Innovation Program (DiMI), and the National Science Foundation.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0" />			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">The haloed line effect for hidden line elimination</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Appel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">J</forename><surname>Rohlf</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">J</forename><surname>Stein</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1979-08" />
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="151" to="157" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Siggraph 99 Course notes: Lighting and Shading Techniques for Interactive Applications</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Blythe</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1999-08" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Statistical properties of intrinsic topological noise in tokamaks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">E</forename><surname>Evans</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 18th European Conference on Controlled Fusion and Plasma Physics</title>
		<meeting>the 18th European Conference on Controlled Fusion and Plasma Physics<address><addrLine>Berlin, Germany</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1991" />
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="11" to="65" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Visualizing 3D flow</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Victoria</forename><surname>Interrante</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Chester</forename><surname>Grosch</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Computer Graphics &amp; Applications</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="272" to="1716" />
			<date type="published" when="1998-08" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Enhanced computational infrastructure for data analysis at the DIII-D national fusion facility</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">P</forename><surname>Schissel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 26th European Conference on Controlled Fusion and Plasma Physics</title>
		<meeting>the 26th European Conference on Controlled Fusion and Plasma Physics<address><addrLine>Maastricht, Netherlands</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1999" />
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page">1225</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Fast Display of Illuminated Field Lines</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Detlev</forename><surname>Stalling</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Malte</forename><surname>Zöckler</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hans-Christian</forename><surname>Hege</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Visualization and Computer Graphics</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="118" to="128" />
			<date type="published" when="1997-04" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">John</forename><surname>Wesson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Tokamaks</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1987" />
			<publisher>Oxford University Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Interactive Visualization of 3D-Vector Fields Using Illuminated Streamlines</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Malte</forename><surname>Zöckler</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Detlev</forename><surname>Stalling</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hans-Christian</forename><surname>Hege</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of IEEE Visualization &apos;96</title>
		<meeting>IEEE Visualization &apos;96<address><addrLine>San Francisco</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1996-10" />
			<biblScope unit="page" from="107" to="113" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
