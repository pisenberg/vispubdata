<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Optimal Regular Volume Sampling</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Thomas</forename><surname>Theußl</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Institute of Computer Graphics and Algorithms Ý Graphics, Usability, and Visualization Lab</orgName>
								<orgName type="institution" key="instit1">Vienna University of Technology</orgName>
								<orgName type="institution" key="instit2">Simon Fraser University</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Torsten</forename><surname>Möller</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ý</forename><surname>Meister</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Eduard</forename><surname>Gröller</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Institute of Computer Graphics and Algorithms Ý Graphics, Usability, and Visualization Lab</orgName>
								<orgName type="institution" key="instit1">Vienna University of Technology</orgName>
								<orgName type="institution" key="instit2">Simon Fraser University</orgName>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<address>
									<settlement>San Diego</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Optimal Regular Volume Sampling</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-19T20:46+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>volume data</term>
					<term>Cartesian grid</term>
					<term>close packing</term>
					<term>hexagonal sampling</term>
					<term>body centered cubic</term>
				</keywords>
			</textClass>
			<abstract>
				<p>Figure 1: CT scans of a lobster and a tooth, represented on Cartesian and body-centered cubic grids (left and right images, respectively). The representation via body-centered cubic grids requires approximately 30% less samples.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Different grid structures have been studied extensively in various fields like chemistry <ref type="bibr" target="#b20">[18]</ref>, solid state physics <ref type="bibr" target="#b0">[1]</ref>, condensed matter physics <ref type="bibr" target="#b12">[10]</ref>, or crystallography <ref type="bibr" target="#b9">[7]</ref>. Researchers in these fields have studied the structure of atoms and molecules, which are often placed in a regular grid structure. This structure is optimized for energy states <ref type="bibr" target="#b0">1</ref> and results in covering space as closely as possible.</p><p>Results in multi-dimensional signal processing show that a Cartesian sampling structure is not the most efficient one <ref type="bibr" target="#b18">[16]</ref>. Efficiency here is measured in terms of sampling points per unit hyper-volume. Under the assumption that the sampled function is isotropic and band-limited the resulting frequency support would be a hyper-sphere. Hence the most efficient sampling scheme would arrange the replicated (hyper-spherical) frequency response as densely as possible in frequency domain.</p><p>The problem of how to place as many (hyper-)spheres as possible in a fixed (hyper-)volume is known as the sphere packing problem <ref type="bibr" target="#b16">[14]</ref>. This has been studied by many mathematicians in up to quite staggering dimensions (Conway and Sloane <ref type="bibr" target="#b2">[3]</ref> give examples of dimensions up to 1048584). The problem of packing spheres optimally was stated in 1900 by Hilbert as his now famous Problem 18 <ref type="bibr" target="#b8">[6]</ref>. It is still not solved completely. However, several regular grid structures are known which are optimal. Among these is the body-centered cubic (bcc) grid, which turns out to be particularly easy to use.</p><p>In the image processing community it is well known that sampling an image on a Cartesian grid is not optimal. By using a hexagonal sampling scheme one can save 13.4% of the samples <ref type="bibr" target="#b14">[12]</ref>. Research has been directed to adapt algorithms like straight line generation <ref type="bibr" target="#b11">[9]</ref>, distance transformations <ref type="bibr" target="#b1">[2]</ref>, or oversampling <ref type="bibr" target="#b10">[8]</ref> to hexagonal grids. However, the Cartesian structure of display devices limits the use of hexagonal grids for image processing so that 2D hexagonal grids are rarely used.</p><p>In volume visualization, or generally when dealing with 3D functions we are not bound to Cartesian grids. The representation of the function we want to visualize can be chosen arbitrarily since typically only two-dimensional projections of the data set are examined. Since a bcc grid can represent isotropic, band-limited data as accurately as Cartesian grids using 29.3% fewer samples <ref type="bibr" target="#b3">[4]</ref> 2 , the advantages of using a bcc grid are significant. In this paper we show how to take advantage of hexagonal sampling in volume rendering. We outline and propose solutions for the inherent issues of re-sampling of rectangular grids as well as interpolation and gradient estimation.</p><p>The remainder of this paper is organized as follows. We summarize the results of hexagonal sampling in 2D and derive an optimal sampling scheme in 3D in Section 2. In Section 3 we show how the splatting algorithm can be adopted for bcc grids, including storing of the data and gradient estimation. In Section 4 we examine acquisition techniques for data sampled on bcc grids. In Section 5 we present the results of our experiments. Some ideas for future work are presented in Section 6, and we derive conclusions of our studies in Section 7.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Baseband Optimal Sampling</head><p>Usually, no a priori knowledge is available about the (continuous) underlying functions we are sampling. Therefore, we assume that these functions are isotropic, i.e., that they do not have a preferred direction. Another common assumption is that they are bandlimited. Both assumptions together result in the property that the frequency responses of such functions are hyper-spheres (circles in 2D and spheres in 3D, respectively).</p><p>Sampling such spherically band-limited functions results in replicating the primary spectrum in the frequency domain <ref type="bibr" target="#b17">[15]</ref>. In order to reconstruct the underlying continuous signal perfectly, we need to ensure that the samples in spatial domain are close enough, so that the aliased spectra in the frequency domain do not overlap. Optimal sampling is achieved when the number of samples that fulfill this condition is minimal. In 1D this is also known as the Nyquist sampling rate. In order to optimally sample in higher dimensions (i.e., to use as few samples as possible), aliased spectra in the frequency domain have to be packed as closely as possible. This problem is known as the sphere packing problem <ref type="bibr" target="#b16">[14]</ref>, which has been extensively studied and solutions for regular packing structures in 2D and 3D exist.</p><p>As a motivation and for the sake of simplicity we will first describe our method to find an optimal sampling pattern in 2D before we delve into the mysterious structure of 3D Euclidian space.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Optimal sampling density in 2D</head><p>We will describe sampling as a mapping from indices to actual sample positions <ref type="bibr" target="#b3">[4]</ref>:</p><formula xml:id="formula_0">Ü Ý Î ¡<label>(1)</label></formula><p>Here the integers are the indices of the sample and Ü Ý is the corresponding sampling position. The matrix Î , which is called sampling matrix, describes the mapping itself, e.g.,</p><formula xml:id="formula_1">ÎÖ Ø¾ Ì½ ¼ ¼ Ì¾ (2)</formula><p>is the matrix for rectangular sampling which simplifies to the commonly used regular (Cartesian) sampling for Ì½ Ì¾. </p><formula xml:id="formula_2">´ ½ ¾µ ¼for ¾ ½ • ¾ ¾ Ï ¾ (7)</formula><p>where Ï is the maximum frequency in the data set. This baseband can be inscribed, for example, in a square with length Ð ¾Ï Ù¾ must be equal to ¾Ï (see <ref type="figure" target="#fig_1">Fig. 2</ref>). Calculating the sampling matrices from these periodicity matrices, we end up with</p><formula xml:id="formula_3">ÎÖ Ø¾ Ï ¼ ¼ Ï (8) where det ÎÖ Ø¾ ¾ Ï ¾ (9) and Î Ü¾ ¾ Ô ¿ Ï ½ Ô ¿ Ï ¼ Ï (10) where det Î Ü¾ ¾ Ï ¾ ¾ Ô ¿ (11)</formula><p>The sampling density is proportional to ½ det Î <ref type="bibr" target="#b3">[4]</ref>. By taking the ratio det ÎÖ Ø¾ det Î Ü¾ Ô ¿ ¾ ¼ <ref type="bibr" target="#b14">(12)</ref> we see that hexagonal sampling requires 13.4% fewer samples than rectangular sampling. </p><formula xml:id="formula_4">T 1 T 2 y . . . u 2 . . . W u 1 ω x ω hexagonal sampling . . . T 1 T 2 x . . . y y u 1 u 2 . . . W .</formula><p>. . </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Optimal sampling density in 3D</head><p>Analogous to the 2D case, we can describe the mapping from indices to coordinates Ü Ý Þ for rectilinear grids using the following matrix:</p><formula xml:id="formula_5">ÎÖ Ø¿ ¼ Ì½ ¼ ¼ ¼ Ì¾ ¼ ¼ ¼ Ì¿ ½ (13)</formula><p>which is regular (rectangular) when Ì½ Ì¾ Ì¿.</p><p>As expected, regular rectangular sampling in 3D is (as in 2D) not optimal. It is important to note that an optimal sphere packing for arbitrary packing structures in 3D is not known. However, several optimal packing structures, all with equal sampling density, are known for the case of regular sampling, i.e., structures that can be described by three base vectors. Fortunately, this is exactly what we need, since we do not want to sacrifice the implicit indexing of the grid points that makes regular grid representations so attractive.</p><p>Among the optimal regular packing structures are the hexagonal close packed (hcp) structure and the face centered cubic (fcc) structure <ref type="bibr" target="#b2">[3]</ref>. In order to achieve a close packing in the frequency domain using an fcc lattice (the reason why not using an hcp lattice is explained at the end of this section), we use the following matrix:</p><formula xml:id="formula_6">Í Í ¼ Ù ¼ Ù ¼ Ù Ù Ù Ù ¼ ½<label>(14)</label></formula><p>An fcc lattice consists of simple cubic cells with additional sampling points in the center of each cell face. One cell of an fcc lattice is depicted in <ref type="figure" target="#fig_2">Fig. 3</ref> with the base vectors from Eq. 14.</p><p>By plugging Eq. 14 in Eq. 4 we end up with a sampling matrix in spatial domain which describes a body centered cubic (bcc) lattice:</p><formula xml:id="formula_7">Î ½ ¾ ¼ Ì Ì Ì Ì Ì Ì Ì Ì Ì ½<label>(15)</label></formula><p>with Ì ¾ Ù . A bcc lattice also consists of a simple cubic cell but with only one additional sampling point, which is right in the center of the cell. <ref type="figure" target="#fig_3">Fig. 4</ref> depicts one cell of a bcc lattice. Note, that the base vectors of <ref type="figure" target="#fig_3">Fig. 4</ref> do not correspond to Eq. 15, as these are rather unintuitive. We chose another set of base vectors, which is more convenient for our purpose of indexing the data points (see Section 3.1). They are described by the sampling matrix</p><formula xml:id="formula_8">Î ¼ Ì ¼ ½ ¾ Ì ¼ Ì ½ ¾ Ì ¼ ¼ ½ ¾ Ì ½ (16)</formula><p>It is easily verified that the sampling matrices in Eqs. <ref type="bibr" target="#b17">15</ref>  </p><p>For the fcc lattice, Ù must be equal to By again taking the ratio det ÎÖ Ø¿ det Î ¼ ¼ <ref type="bibr" target="#b21">(19)</ref> we see that we need 29.3% fewer samples than with rectangular sampling. This means that if we sample a function on a regular rectangular grid with sampling distance ÌÖ, we can increase the sampling distance Ì for a bcc grid to Ô ¾ÌÖ.</p><formula xml:id="formula_10">Ô ¾Ï, which yields det Î ¿ Ï ¿ Ô ¾<label>(18)</label></formula><p>In the above example we started with an fcc lattice in the frequency domain which resulted in a bcc lattice in the spatial domain. We could also choose an hcp lattice, since it has the same packing density as an fcc lattice <ref type="bibr" target="#b2">[3]</ref>. However, an hcp lattice in the frequency domain is also an hcp lattice in the spatial domain and hcp lattices are rather difficult to index <ref type="bibr" target="#b9">[7]</ref>. Therefore, we prefer to use a bcc grid.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Implementation Details</head><p>In order to use a bcc grid in practice we have to address some inherent implementation issues. First, we must think about how to organize the grid in memory. We present a scheme which stores the sampling points in a three-dimensional array. The addressing scheme is of special importance, since we want to take advantage of the implicit ordering in regular grid structures. Next we describe the slight modifications necessary to use splatting on bcc grids. Here we need to address issues of interpolation. In order to incorporate shading in our rendering algorithm we describe two methods for estimating gradients on grid points of a bcc lattice.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Storage scheme</head><p>For the sake of simplicity and clarity of figures, we first present our storage scheme in 2D, then extend it to 3D.</p><p>In 2D the optimal sampling pattern is hexagonal sampling. Hexagonal sampling as described by Eq. 3, results in rather awkward indexing as we still want to sample a rectangular area. The meaning of the matrix in Eq. 3 is to shift the Ø row by the amount ½ ¾ Ì½ . Since this holds for infinite long rows, the result would be the same to shift the same row by ½ ¾ Ì½´ ¾µ ½ ¾ Ì½ Ì½. Extending this idea and since we actually like to describe a finite, rectangular area, we shift only rows with odd index which is achieved by the following matrix:</p><formula xml:id="formula_11">Î Ü¾ Ì½ ½ ¾ Ì½´ mod ¾µ ¼ Ì¾ for Ì¾ Ô ¿ ¾ Ì½ (20)</formula><p>The effect is illustrated in <ref type="figure">Fig. 5</ref>. On the left, the result of applying Eq. 3 can be seen whereas the effect of applying Eq. 20 is depicted on the right.</p><p>The same problem exists in 3D. However, the solution is as simple as in 2D. The following matrix</p><formula xml:id="formula_12">Î ¼ Ì ¼ ½ ¾ Ì´ mod ¾µ ¼ Ì ½ ¾ Ì´ mod ¾µ ¼ ¼ ½ ¾ Ì ½ (21)</formula><p>shifts only planes with odd z-coordinates half a unit in x and y direction. The result is that the slices with even z coordinates make up a 3D Cartesian grid, the slices with odd z coordinates also make up a 3D Cartesian grid which is shifted to the centers of the first grid. <ref type="figure">Fig. 6</ref> shows a bcc grid with the two inter-penetrating Cartesian grids marked differently. In practice we still store the data in a 3D array with an implicit shift of slices with odd z coordinates.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Splatting on bcc grids</head><p>Adapting Westover's splatting algorithm <ref type="bibr" target="#b21">[19]</ref> to bcc grids is straightforward. This algorithm gains its power by using spherical reconstruction kernels. These kernels have a spherical extent in the frequency domain. Hence these kernels preserve a spherical region during the reconstruction process. Since the aliased spectra for the hexagonal grid are redistributed so that they do not overlap with the primary spectrum, we can use the existing spherical kernels without any modifications.</p><p>Since the data is still organized in a 3D array, we traverse it in a back to front manner. Care has to be taken when traversing in z-direction as planes with odd and even z-coordinates have to be separated. Before applying the transformation matrix we apply the sampling matrix (Eq. 21) to shift the voxels to the correct position.  One more thing has to be changed in existing code: the computation of gradients for shading. For this purpose, we adapted central differences to bcc grids.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Central Differences on bcc grids</head><p>Gradients are rather important in volume visualization. They are most often used for classification and shading. Therefore, we need to be able to compute gradients on bcc grids. The most commonly used method to estimate gradients is the central differences method. There are two ways to adapt this method to bcc grids.</p><p>The first idea exploits the fact that we have a Cartesian grid structure in all the slices that are parallel to a major axis direction. Hence partial derivatives in each direction can be computed through standard central differences. However, using our indexing scheme we have to adopt the following equation for computing the central difference in the z direction:</p><formula xml:id="formula_13">Þ Ü Ý Þ ½ ¾Ì´ Ü Ý Þ • ¾ Ü Ý Þ ¾ µ (22)</formula><p>This method requires exactly as many operations as central differences on Cartesian grids. The conceptual problem with this method is that we do not use the actual closest points in order to estimate the derivatives. This can be rectified in our second method. For the second method we follow the philosophy that the eight closest points should have the main impact on the reconstructed value. Hence we are computing the average of the central differences at each edge of the cubic cell that the current point is located in (compare <ref type="figure" target="#fig_3">Fig. 4</ref>). This corresponds to applying an analytic, spherically symmetric, trilinear derivative filter at grid points, resulting in the following formulas for the partial derivatives:</p><formula xml:id="formula_14">Ü Ü Ý Þ ½ Ì ¾ ¼ ½ ¾ ½ ½ ´ µ Ü Ý Þ Ý Ü Ý Þ ½ Ì ¾ ¼ ½ ¾ ½ ½ ´ µ Ü Ý Þ (23) Þ Ü Ý Þ ½ Ì ¾ ¼ ½ ¾ ½ ½ ´ µ Ü Ý Þ with Ñ Ñ • Þ mod ¾µ and ´Üµ ½ if Ü ¼ or Ü ½ ½ if Ü ½<label>(24)</label></formula><p>The introduction of Ñ and ´Üµ are due to the properties of our storage scheme. This method requires 8 operations per partial derivative as opposed to one subtraction per partial derivative for Cartesian grids. However, as we are calculating the gradients in a preprocessing step, this has no major impact on the rendering performance.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Acquisition of Optimally Regular Sampled Volume Data</head><p>After having settled technical details about using optimally sampled regular volume data, we have to deal with the question where to get data sets sampled on such bcc grids. There are several possibilities. The first possibility is to sample artificial data sets, given as 3D analytic functions, like a sphere or the Marschner-Lobb function <ref type="bibr" target="#b13">[11]</ref>, on a bcc grid. Generally, data sets obtained via voxelization <ref type="bibr" target="#b19">[17]</ref> can straightforwardly be generated on a bcc grid. This is especially useful for evaluating the applicability of bcc grids as the frequency content of such data can directly be controlled.</p><p>Second, there is of course the possibility to resample data sets on Cartesian grids to a bcc grid. Since this resampling step has to be performed only once when generating the new data set, an arbitrarily good reconstruction kernel (e.g., a rather wide windowed sinc) can be used.</p><p>The third and most interesting possibility is to take raw data from modalities like CT or MRI and directly generate bcc grid data sets from them. Raw data from tomography data sets (CT, PET, SPECT) is typically given by many 2D or 1D projections. Hence adapting the reconstruction algorithm for bcc grids has the potential of speeding up these typically very costly operations by almost 30%. Likewise image data acquired in the frequency domain (e.g. MRI) could be (re)sampled onto an fcc grid. We could easily acquire the samples in the frequency domain on a face centered cubic grid and use a modified inverse FFT to generate a bcc grid data set. That would allow either faster acquisition times or more accurate images when samples are acquired on a bcc grid.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Results</head><p>We performed several tests to evaluate the applicability of bcc grids. First, we compared our gradient reconstruction schemes to the commonly used central differences on Cartesian grids. Then, we modified an existing splatter to operate on bcc grids. Finally, as sampling on bcc grids results in a compression of the data, we also compared it to existing compression techniques for volumetric data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Gradient estimation</head><p>In order to evaluate the quality of the gradient approximation we used three different analytical functions for comparison purposes: spherical with linear falloff:</p><formula xml:id="formula_15">½´Ü Ý Þµ Ô Ü ¾ • Ý ¾ • Þ ¾<label>(25)</label></formula><p>Sinc function:</p><formula xml:id="formula_16">¾´Ü Ý Þµ × Ò´ÔÜ ¾ • Ý ¾ • Þ ¾ µ Ô Ü ¾ • Ý ¾ • Þ ¾<label>(26)</label></formula><p>simplified Marschner-Lobb:</p><formula xml:id="formula_17">¿´Ü Ý Þµ × Ò Ü ¾ • Ý ¾ • Þ ¾ µ<label>(27)</label></formula><p>We computed the actual function values at the positions defined by the bcc grid so that no errors were introduced during the sampling process. We then applied our two gradient reconstruction schemes and computed the difference of the normals with the analytically computed normals at the sampling grid. We recorded two errors -the error in the magnitude of the normal as well as the angular error in the normal. We then looked at these errors in one slice at a time. Since in our indexing scheme an xy-slice (z is constant) is easy to extract we chose xy slices. Furthermore, we were interested in how well these errors compare to errors introduced by central differences and linear filtering on regular rectilinear grids. Hence we computed the normals as if the original data set was given on a rectangular grid using central differences and linear interpolation. The results of our experiment can be seen in <ref type="figure" target="#fig_7">Fig 7 (a)</ref> -(c). The first row shows the relative error in magnitude and the second row shows the angular error. Column one depicts the error of our first gradient reconstruction method (Eq. 22) that is based on central differences at the grid point itself. Column 2 corresponds to method two (Eq. 23), which is the average of all central differences at the of the cube edges surrounding the sampling point. In the last column we computed the linearly interpolated central differences, assuming the data set was given on a regular grid with corresponding dimensions. <ref type="figure" target="#fig_7">Fig 7(a)</ref> shows the error images for function ½. In this image an angular error of 15 degrees and an amplitude error of 30% corresponds to white (255). <ref type="figure" target="#fig_7">Fig. 7(b)</ref> shows the error images for function   Here an angular error of 30 degrees and an amplitude error of 60% corresponds to white (255). Finally the results for function ¿ are displayed in <ref type="figure" target="#fig_7">Fig. 7(c)</ref>. Here 5 degrees for the angular error and 10% for the amplitude error correspond to white (255). From these images we conclude that both our difference methods are quite comparable with central differencing and linear interpolation on regular grids. Hence one need not to worry about quality loss by using bcc grids for volume rendering applications. Furthermore since there are no large differences between the two introduced methods in Section 3.3, we don't find the expensive operations of method 2 justified.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Splatting</head><p>We rendered several different data sets using both a usual Cartesian grid and a bcc grid. All images were generated using the same transfer function and viewing parameters. <ref type="figure">Fig. 8</ref> shows images of the Marschner-Lobb data set sampled on a ¼ ¢ ¼ ¢ ¼ Cartesian grid (as described by Marschner and Lobb <ref type="bibr" target="#b13">[11]</ref>) on the left respectively a ¾ ¢ ¾ ¢ bcc grid on the right. This data set is quite demanding for a straightforward splatter and there are some visible differences in the results. The image generated from the bcc grid is rather blurred whereas the image from the Cartesian grid exhibits strong artifacts, especially in diagonal directions. The same phenomenon, but less obvious, can be observed in <ref type="figure">Fig. 1</ref>, which depicts images generated from CT scans of a lobster and a tooth. The data sets that we used for rendering the images in Color Plate 1 were produced using a high-quality interpolation filter. We used the ¿ -4EF filter as designed by Möller et al. <ref type="bibr" target="#b15">[13]</ref>. In Color Plate 1 we show results of rendering the "neghip" data set as well as the High Potential Iron Protein data set by Louis Noodleman and David Case, of Scripps Clinic, La Jolla, California, as well as the fuel injection data set. Again, a regular Cartesian grid was used on the left and a bcc grid on the right. There are some visible differences in the images. Since we classify different values that represent two different grid positions one cannot expect identical pictures. Hence we see some differences resulting from the problem of pre-classification <ref type="bibr" target="#b22">[20]</ref>.</p><p>We also did some timings which are reported in <ref type="table" target="#tab_3">Table 1</ref>. It is interesting to note that the speedup for some data sets were bigger than expected. This could have been caused by the decreased memory caching necessary. For a very small data set (lobster) we saw expected speedups near 30%.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Compression</head><p>Our results indicate that the resampled data have the potential to lead to better compression. We were able to show that our compression ratios for practical data sets are better than what was achieved using the gzip utility. Also, our overall compression ratios were better then previously reported <ref type="bibr" target="#b6">[5]</ref>. <ref type="table">Table 2</ref> shows compression ratios of various volume data sets. Note that the last two columns give percentages as compared to the original data size indicating the overall compression ratio, which is what we are interested in.</p><p>However, the compression of synthetic data sets is a rather surprising result and needs to be further investigated.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Future Work</head><p>We would like to adopt other volume rendering algorithms to body centered cubic grids and see how they perform. As the bcc grid actually consists of two Cartesian grids which are shifted with respect to each other, it should be possible to design a shear-warp algorithm for bcc grids. For the same reason it should be possible to accelerate volume rendering by the use of graphics hardware.</p><p>It would also be necessary to come up with a ray-casting algorithm. For this purpose it would be interesting to investigate the effects of interpolating within bcc grids. Therefore, we would like to adopt the filter analysis and design method of Möller et al. <ref type="bibr" target="#b15">[13]</ref> to bcc grids. Since each sampling point in a bcc grid has eight nearest neighbors (as opposed to a Cartesian grid), spherically symmetric filters deserve a more thorough investigation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Conclusions</head><p>We have presented a sampling scheme for volume data which saves 29.3% samples as compared to Cartesian grids. We assume that the functions we are dealing with are isotropic and band-limited, i.e., their frequency spectra are spheres. Therefore, a sampling pattern can be used in a way such that the replicas in frequency domain (introduced by the sampling process) are packed closely. There is no unique sampling pattern which achieves this. However, a body centered cubic grid results in a close packing in frequency domain and is easy to use. With this sampling pattern we reduce data size and improve rendering rates without loss of quality.</p><p>To demonstrate the applicability in volume rendering, we have adopted the splatting algorithm to bcc grids. This requires just a few changes of an existing code and is straightforward to implement. In order to perform classification and shading of the data we developed two gradient reconstruction schemes. Empirical experiments with analytical 3D functions show that these are comparable with central differences commonly used on Cartesian grids. We believe that significant gains can be achieved by using bcc grids in volume visualization and volume graphics in general.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>2D regular rectangular and hexagonal sampling in the spatial and frequency domains.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 3 :</head><label>3</label><figDesc>One cell of an fcc lattice with base vectors Ù . The black dots mark additional sample points (in the center of the faces) as compared to a simple cubic cell.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 4 :</head><label>4</label><figDesc>One cell of a bcc structure with base vectors . The only difference to a simple cubic cell is one additional sample point right in the center of the cell, marked with a black dot.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 5 : 20 Figure 6 :</head><label>5206</label><figDesc>Different indexing schemes. The image on the left corresponds to Eq. 3. The figure on the right corresponds to Eq. A bcc grid interpreted as two inter-penetrating Cartesian grids.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 7 :</head><label>7</label><figDesc>Difference images of analytically calculated gradients to our gradient estimation schemes (see Sec. 3.3), first two columns, and central differences with linear interpolation, third column, for (a) sphere, (b) Sinc, and (c) simplified Marschner-Lobb function. The top rows show the error in magnitude whereas the bottom rows show the angular error.(a) error in magnitude by 30% and an angular error of 15 degrees corresponds to white, (b) amplitude error of 60% and an angular error of 30 degrees corresponds to white, (c) amplitude error of 10% and an angular error of 5 degrees corresponds to white.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>and 16   describe the same set of sample points.To guarantee that the replicas in frequency domain do not overlap, Ù must be equal to ¾Ï for rectangular sampling. Since the periodicity matrix is analogous to the 2D periodicity matrix we end up with</figDesc><table /><note>det ÎÖ Ø¿¿ Ï ¿</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>Table 1 :</head><label>1</label><figDesc>Timings for several different datasets are reported in seconds per frame.</figDesc><table><row><cell>Data set</cell><cell cols="3">rectilinear bcc grid speedup</cell></row><row><cell>uncbrain</cell><cell>1.51</cell><cell>0.8</cell><cell>47%</cell></row><row><cell>hipip</cell><cell>0.103</cell><cell>0.059</cell><cell>43%</cell></row><row><cell>lobster</cell><cell>0.056</cell><cell>0.043</cell><cell>23%</cell></row></table><note>¾.</note></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1">This is, of course, a serious oversimplification. However, for almost all the elements the lowest energy state is crystalline<ref type="bibr" target="#b12">[10]</ref>.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8">Acknowledgments</head><p>We thank the Master for his inspirations and guidance. We also would like to thank Ziemowit Trzesicki for his help in providing code for the resampling of the grids as well as Steven Kilthau for letting us adopt his splatting code for our bcc grids.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">Solid State Physics</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">W</forename><surname>Ashcroft</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">D</forename><surname>Mermin</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1976" />
			<publisher>Prentice-Hall, Inc., Holt, Rinehart and Winston</publisher>
		</imprint>
	</monogr>
	<note>1st edition</note>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Distance transformations on hexagonal grids</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Borgefors</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pattern Recognition Letters</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="97" to="105" />
			<date type="published" when="1989" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title level="m" type="main">Sphere Packings, Lattices and Groups</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Conway</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J A</forename><surname>Sloane</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1998" />
			<publisher>Springer</publisher>
		</imprint>
	</monogr>
	<note>3rd edition</note>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title level="m" type="main">Multidimensional Digital Signal Processing</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">E</forename><surname>Dudgeon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">M</forename><surname>Mersereau</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1984" />
			<publisher>Prentice-Hall, Inc</publisher>
			<pubPlace>Englewood-Cliffs, NJ</pubPlace>
		</imprint>
	</monogr>
	<note>1st edition</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Marschner-Lobb data set rendered by splatting with a Cartesian grid on the left and a bcc grid on the right. original bcc grid original (gzipped) bcc (gzipped) % original % bcc uncbrain 9502732</title>
	</analytic>
	<monogr>
		<title level="j">Figure</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Table 2: Compression ratios of several volume data sets. The last two columns give the percentage as compared to the original data size</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Lossless compression of volume data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Fowler</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Yagel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 1994 Symposium on Volume Visualization</title>
		<editor>Arie Kaufman and Wolfgang Krueger</editor>
		<meeting>the 1994 Symposium on Volume Visualization</meeting>
		<imprint>
			<biblScope unit="page" from="43" to="50" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Acm</forename><surname>Siggraph</surname></persName>
		</author>
		<idno>ISBN 0-89791-741-3</idno>
		<imprint>
			<date type="published" when="1994-10" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Mathematische Probleme. Nachrichten der Königlichen Gesellschaft der Wissenschaften zu Göttingen, mathematisch-physikalische Klasse</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Hilbert</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1900" />
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="253" to="297" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title level="m" type="main">Handbook of Crystallography</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">G</forename><surname>Jackson</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1991" />
			<publisher>Springer</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Computer graphics on a hexagonal grid</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">N</forename><surname>Lester</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Sandor</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computers and Graphics</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="401" to="409" />
			<date type="published" when="1984" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">The generation of straight lines on hexagonal grids</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yong-Kui</forename><surname>Liu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computer Graphics Forum</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="27" to="31" />
			<date type="published" when="1993-03" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">P</forename><surname>Marder</surname></persName>
		</author>
		<title level="m">Condensed Matter Physics</title>
		<imprint>
			<publisher>John Wiley &amp; Sons</publisher>
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">An evaluation of reconstruction filters for volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">R</forename><surname>Marschner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">J</forename><surname>Lobb</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Conference on Visualization</title>
		<editor>R. Daniel Bergeron and Arie E. Kaufman</editor>
		<meeting>the Conference on Visualization<address><addrLine>Los Alamitos, CA, USA, Oc</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE Computer Society Press</publisher>
			<date type="published" when="1994" />
			<biblScope unit="page" from="100" to="107" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">The processing of hexagonally sampled two-dimensional signals</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">M</forename><surname>Mersereau</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proceedings of the IEEE</title>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="930" to="946" />
			<date type="published" when="1979-06" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Design of accurate and smooth filters for function and derivative reconstruction</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Möller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Mueller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Kurzion</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Machiraju</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Yagel</surname></persName>
		</author>
		<idno>0-8186-9180-8</idno>
	</analytic>
	<monogr>
		<title level="m">Symposium on Volume Visualization</title>
		<meeting><address><addrLine>North Carolina</addrLine></address></meeting>
		<imprint>
			<publisher>ACM SIGGRAPH</publisher>
			<date type="published" when="1998-10" />
			<biblScope unit="page" from="143" to="151" />
		</imprint>
		<respStmt>
			<orgName>Held in Research Triangle Park</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">The sphere packing problem</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J A</forename><surname>Sloane</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">ICM: Proceedings of the International Congress of Mathematicians</title>
		<imprint>
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title level="m" type="main">Discrete-Time Signal Processing</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">V</forename><surname>Oppenheim</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">W</forename><surname>Schafer</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1989" />
			<publisher>Prentice Hall Inc</publisher>
			<pubPlace>Englewood Cliffs</pubPlace>
		</imprint>
	</monogr>
	<note>2nd edition</note>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Sampling and reconstruction of wave-number-limited functions in AE-dimensional Euclidean spaces</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">P</forename><surname>Petersen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Middleton</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Information and Control</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="279" to="323" />
			<date type="published" when="1962" />
			<publisher>December</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Alias-free voxelization of geometric objects</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Srámek</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">E</forename><surname>Kaufman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Visualization and Computer Graphics</title>
		<editor>Hans Hagen</editor>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="251" to="267" />
			<date type="published" when="1999" />
			<publisher>IEEE Computer Society</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">F</forename><surname>Wells</surname></persName>
		</author>
		<title level="m">Structural Inorganic Chemistry. Oxford University Press</title>
		<imprint>
			<date type="published" when="1984" />
		</imprint>
	</monogr>
	<note>5th edition</note>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Footprint evaluation for volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Westover</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">SIGGRAPH &apos;90 Proceedings)</title>
		<imprint>
			<date type="published" when="1990-08" />
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="367" to="376" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Opacity-weighted color interpolation for volume sampling</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Craig</forename><forename type="middle">M</forename><surname>Wittenbrink</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Thomas</forename><surname>Malzbender</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><forename type="middle">E</forename><surname>Goss</surname></persName>
		</author>
		<idno>0-8186-9180-8</idno>
	</analytic>
	<monogr>
		<title level="m">Volume Visualization Symposium</title>
		<imprint>
			<date type="published" when="1998-10" />
			<biblScope unit="page" from="135" to="142" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
