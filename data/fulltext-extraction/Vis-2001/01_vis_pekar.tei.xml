<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Fast Detection of Meaningful Isosurfaces for Volume Data Visualization</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Vladimir</forename><surname>Pekar</surname></persName>
							<email>vladimir.pekar@philips.com</email>
							<affiliation key="aff0">
								<orgName type="institution">Philips Research Laboratories</orgName>
								<address>
									<settlement>Hamburg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Institute for Signal Processing</orgName>
								<orgName type="institution">Medical University of Lübeck</orgName>
								<address>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Rafael</forename><surname>Wiemker</surname></persName>
							<email>rafael.wiemker@philips.com</email>
							<affiliation key="aff0">
								<orgName type="institution">Philips Research Laboratories</orgName>
								<address>
									<settlement>Hamburg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Daniel</forename><surname>Hempel</surname></persName>
							<email>daniel.hempel@philips.com</email>
							<affiliation key="aff0">
								<orgName type="institution">Philips Research Laboratories</orgName>
								<address>
									<settlement>Hamburg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<address>
									<settlement>San Diego</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Fast Detection of Meaningful Isosurfaces for Volume Data Visualization</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-19T20:45+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>I.3.3 [Computer Graphics]: Picture/Image Generation-Display algorithms</term>
					<term>J.2 [Physical Sciences and Engineering]: Mathematics and statistics</term>
					<term>J.3 [Life and Medical Sciences]: Medical information systems Volume data visualization, surface rendering, volume rendering, isosurfaces, divergence theorem</term>
				</keywords>
			</textClass>
			<abstract>
				<p>Automatic detection of meaningful isosurfaces is important for producing informative visualizations of volume data, especially when no information about the data origin and imaging protocol is available. We propose a computationally efficient method for the automated detection of intensity transitions in volume data. In this approach, the dominant transitions correspond to clear maxima in cumulative Laplacian-weighted gray value histograms. Only one pass through the data volume is required to compute the histogram. Several other features which may be useful for exploration of data of unknown origin can be efficiently computed in a similar manner, e.g. enclosed volume, isosurface area, mean gradient. The detected intensity transitions can be used for setting of visualization parameters for surface rendering, as well as for direct volume rendering of 3-D datasets. When using surface rendering, the detected dominant intensity transition values correspond to the optimal surface isovalues for extraction of boundaries of the objects of interest. In direct volume rendering, such transitions are important for generation of the transfer functions, which are used to assign visualization properties to data voxels and determine the appearance of the rendered image. The proposed method is illustrated by examples with synthetic data as well as real biomedical datasets.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Efficient volume visualization procedures are becoming more and more important due to the increasing amount of 3-D data which is routinely acquired and processed for many scientific and technological applications. One important area is medical imaging, where large volumetric datasets originate from tomography devices, for example, computer tomography (CT) and magnetic resonance imaging (MRI) scanners <ref type="bibr" target="#b11">[11]</ref>. Volume visualization is generally a complex process, in which many parameters may influence the informative and visual quality of the produced images.</p><p>Objects to be visualized typically consist of several areas of homogeneous material. One wide-spread visualization method is the so-called isosurface display, where the boundaries of different areas are of primary interest for the user to examine. Transitions between different material types correspond to intensity transitions in the datasets which are dominant as compared to relatively small intensity variations in the homogeneous areas. For example, in medical CT datasets there are typically well-defined intensity transitions between soft tissue, fat, and bone <ref type="bibr" target="#b2">[3]</ref>. The important characteristic parameter of a material transition in a volumetric dataset is the intensity isovalue which defines an isosurface representing the boundary of a particular area.</p><p>Surface rendering or direct volume rendering can be applied to visualize isosurfaces. For surface rendering, an isocontouring algorithm, e.g. marching cubes <ref type="bibr" target="#b8">[8]</ref>, can be applied to generate polygonal representations of the surfaces corresponding to the given intensity isovalues. These surfaces are then rendered by using a standard computer graphics pipeline. When using direct volume rendering <ref type="bibr" target="#b7">[7]</ref>, by placing the steepest slopes of the opacity transfer functions around the isovalues, the corresponding material boundaries are made visible in the rendered image.</p><p>For routine examinations of certain data types acquired by some standard imaging protocols, the isovalues can be predefined for use in volume visualization procedures. However, if the origin of the data is not known, a time-costly process, consisting of manual parameter tuning, rendering, and visual assessment of the results, is usually required to produce informative visualizations.</p><p>The volume visualization process can be made much more efficient if it is possible to automatically derive optimal rendering parameters by direct analysis of the volume data to be visualized. Automatically detected isosurfaces and corresponding isovalues can be used directly during surface rendering, or in order to define approximate forms for the opacity transfer function for direct volume rendering. This is particularly important in cases where no information about the data origin and imaging protocol is available.</p><p>In this paper, we propose a computationally very efficient method which requires only a single pass through the data volume and allows important intensity transitions to be determined. These are detected as maxima in cumulative Laplacian-weighted gray value histograms, which correspond to the thresholds that segment parts of the data volume with large contour surfaces and/or large gradient values along the contour surfaces. The proposed method can be used to support a surface rendering or a direct volume rendering process. We have tested our method on a synthetic model dataset as well as on several types of real medical data.</p><p>The structure of the paper is the following: Section 2 briefly describes other work related to the proposed method. In Section 3, we present our method for fast detection of meaningful isosurfaces, including the definition of the objective function, its efficient computation using Laplacian-weighted cumulative histograms, and the interpretation of the histogram curve. In Section 4, some examples with synthetic and real data are shown which illustrate the proposed method. Conclusions are drawn in Section 5.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Related Work</head><p>Several approaches aimed at simplifying parameter selection for volume data visualization have been proposed in the literature. In some methods, analysis of the rendered images is performed to find the optimal rendering parameters. He et al. <ref type="bibr" target="#b3">[4]</ref> use a rendering pipeline, where the initial population of transfer functions for volume rendering is iteratively updated by stochastic search procedures. The evolution of the population is controlled by visual evaluation of intermediate renderings and the suitable transfer function is interactively selected by the user or determined automatically by using certain user-defined criteria. Another approach has been proposed by Marks et al. <ref type="bibr" target="#b9">[9]</ref>. There, a very large automatically generated set of rendered images, called the "design gallery", is created, where each image is associated with a certain visualization parameters setting. The creation of the design gallery is computationally very expensive and is typically done off-line. The end user then selects the most appealing images from the gallery.</p><p>Another group of methods directly analyzes the volume data to be visualized. Bergman et al. <ref type="bibr" target="#b1">[2]</ref> proposed a rule-based approach for optimal colormap selection based on analysis of spatial frequency characteristics in the data. A method to automatically find intensity transitions between boundaries of different structures in volume data has been described by Kindlmann and Durkin <ref type="bibr" target="#b5">[6]</ref> for semi-automatic generation of transfer functions for volume rendering. In this method, a histogram volume is filled, whose bins correspond to the combination of the intensity values with locally evaluated first and second directional derivatives. Intensity transition values corresponding to boundary regions in the volume can then be analytically computed in a known intensity range, assuming the boundary model to be a step function blurred with a Gaussian. Of most relevance to the present paper is the work of Bajaj et al. <ref type="bibr" target="#b0">[1]</ref>, where a user interface has been developed, which provides data quantification for isocontour rendering of triangular meshes. This allows interactive determination of optimal isovalues by computing certain characteristics of the corresponding isosurfaces (contour length, contour area, gradient integral), called the contour spectrum, at a selected isovalue. The approach proposed in the present paper is based on similar principles as the aboved mentioned work <ref type="bibr" target="#b0">[1]</ref>, but uses a completely different method to compute isosurface spectra and additionally offers some new features of potential interest.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Method</head><p>In this section, we describe our method for isosurface detection in detail. The task of detecting intensity transitions between different materials in a volumetric dataset is formulated as finding gray value thresholds which extract binary regions from the dataset corresponding to imaged structures. First, we define our objective function to determine optimal intensity thresholds, then we present an efficient method for its computation using the divergence theorem and Laplacian-weighted gray value histogram. Lastly we describe the histogram interpretation, and the computation of some other useful features, such as isosurface volume, isosurface area, mean gradient.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Definition of the objective function</head><p>In a given volumetric dataset, let the gray value at position x be I(x). If we make a complete pass through the intensity range of the dataset, each gray value threshold Ti ∈ [Imin, Imax] yields a binary volume B(Ti) = Bi, where a voxel has a binary value Bi(x) = 1 for I(x) ≥ Ti, and 0 otherwise. Every binary volume Bi contains a set of contour surfaces Γi which divide the data volume into regions of Bi(x) = 0 and regions of Bi(x) = 1.</p><p>The aim is to find a certain gray value threshold Topt that optimally transfers the voxels of a given volumetric data set into a binary volume. The threshold value is considered to be appropriate if it corresponds to a material transition in the data volume. To detect intensity transitions between different material types, we typically have to look for contour surfaces consisting of voxels with high gray value gradients ∇I, where the gradient operator is ∇ = (∂/∂x , ∂/∂y , ∂/∂z) t . These contour surfaces correspond to data structures with long and/or highly contrasted boundaries.</p><p>Hence, the objective function to measure the goodness of a certain partitioning B(T ) can be defined as the surface integral of the intensity gradient magnitude g = ∇I over the set of surfaces Γ:</p><formula xml:id="formula_0">F (T ) = Γ |g| dγ .<label>(1)</label></formula><p>The latter integral can be computed for each threshold Ti by finding the partitioning surfaces and computing their gradient vectors at all points. We consider a threshold value T as appropriate if the objective function F (T ), which we call the total gradient integral takes a maximum at this value.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Application of the divergence theorem</head><p>A very efficient approach to compute the objective function F (T ) is based on the divergence theorem <ref type="bibr" target="#b4">[5]</ref>, which states that an integral of a vector field g over a contour surface Γ can be replaced by the volume integral of the divergence ∇• g over the volume Ω enclosed by the contour surface.</p><p>The objective function F (T ) in Eq. 1 can be rewritten (taking into account the property that the gradient is orthogonal to an isosurface) as:</p><formula xml:id="formula_1">F (T ) = Γ |g| dγ = Γ g • g |g| dγ = − Γ g • n dγ . (2)</formula><p>The negative sign of the last integral is due to the direction of the gradient which is opposite to the outer normal n in the thresholded image. By using the divergence theorem, we obtain:</p><formula xml:id="formula_2">F (T ) = − Γ g • n dγ = − Ω ∇• g dx ,<label>(3)</label></formula><p>where the divergence of the gradient vector field ∇ • g is equal to the Laplace operator L = ∂ 2 /∂x 2 + ∂ 2 /∂y 2 + ∂ 2 /∂z 2 applied to the intensity field of the data volume. Let L(x) be the Laplace value at position x. Thus:</p><formula xml:id="formula_3">F (T ) = − Ω L(x) dx .<label>(4)</label></formula><p>For a volume dataset consisting of discrete gray value voxels, the goodness of the partitioning F (T ) can be computed by identifying all voxels x with gray values I(x) above the threshold T , and replacing the latter integral by the sum:</p><formula xml:id="formula_4">F (T ) = − I(x)≥T L(x) .<label>(5)</label></formula><p>The evaluation of the goodness F (T ) can be performed efficiently by using a cumulative Laplacian-weighted gray value histogram. The histogram computation, described in the next section, requires only one pass through the dataset.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Objective function computation using a histogram</head><p>To compute the Laplacian-weighted gray value histogram G(T ), we compute at each voxel position x the Laplace value L(x). The histogram is incremented at bin I(x), where I(x) is the image intensity, by the amount of the Laplace value L:</p><formula xml:id="formula_5">G(I(x)) ⇐ G(I(x)) + L(x) .<label>(6)</label></formula><p>After the values for all voxels have been inserted into the histogram, we accumulate it in such a way that each cumulative histogram value Gc(T ) is set as the sum of all higher histogram values G(I) with I ≥ T . The principle of the cumulative histogram computation is illustrated in <ref type="figure" target="#fig_0">Fig. 1</ref>. It corresponds to the computation of the sum in Eq. 5 for a certain gray value threshold T . Thus each cumulative histogram value Gc(T ) gives a discrete approximation of the volume integral (4) over all voxels with a gray value I ≥ T . Hence, the total gradient F (Ti) for each threshold Ti ∈ [Imin, Imax] can simply be read as the cumulative histogram value Gc(Ti) = F (Ti).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Interpretation of the histogram curve</head><p>The optimal threshold Topt with respect to the gradients, which are orthogonal to the contour surface of the partitioning B(Topt) = Bopt, is found as the global maximum of the histogram curve Lc(T ), and corresponds to the most dominant material transition.</p><p>Other interesting intensity transitions can be found as local maxima in Gc(T ) curve. The curve combines the abundance of contour surface voxels at a specific threshold T with the strength of the gradient there. Thus, local maxima in the histogram curve Gc(T ) can be caused by partitionings with very long contour surfaces, by partitionings with contours at very steep gradients, or by a combination of both.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.5">Additional features: volume, surface, mean gradient</head><p>Some additional useful features can be computed in a manner analogous to that described above. For the general case, let us consider an anisotropic volume data set with a grid spacing ∆x, ∆y and ∆z.</p><p>The volume enclosed by an isosurface can obviously be computed by building a histogram V (T ), where the bin at histogram position I(x) is incremented by the voxel volume dV = ∆x ∆y ∆z for every voxel in the volume. The accumulated histogram Vc(T ) =</p><p>I≥T V (I) then provides the discrete approximation for the volume Ω enclosed by the isosurface with isovalue T .</p><p>The area of an isosurface, which is often an important feature, can be computed as follows. We compare the intensity I(x) at position x with the intensity I(x ) of each of its neighbors x . We consider the face between the voxels x and x . If the neighboring voxel x is in x-direction from the center voxel x, then the surface of the face between the voxels is dS = ∆y ∆z; for y and z-direction it is dS = ∆x ∆z and dS = ∆x ∆y, respectively. A new histogram S(T ) is incremented at bin I(x) by the amount of the face area dS if I(x) &gt; I(x ), and decremented by dS if I(x) &lt; I(x ). Each value in the cumulative histogram Sc(T ) = I≥T S(I) then sums up the total area of voxel faces which are exposed to the contour surface at a given threshold T . The cumulative histogram Sc(T ) thus gives the approximate value of the isosurface area at a certain threshold T . As an illustration let us imagine lowing the threshold T from T = Imax: When the threshold T decreases to the value I(x) of voxel x, then the face between x and its neighboring voxel x with I(x ) &lt; I(x) becomes part of the isosurface, and the cumulative histogram Sc increases by the face area dS. When the threshold T sinks further and reaches the value I(x ) the cumulative histogram Sc decreases again by dS and thus falls back to the original surface area value. The method described here to estimate the area of the isosurface is certainly biased in that surfaces which are running oblique to the voxel grid axes yield up to a factor √ 2 more voxel faces than for surfaces aligned with the x, y or z direction: nevertheless it yields a reasonable approximation which is very fast to compute.</p><p>Given the isosurface area estimation, the feature mean gradient Gc(T ) can then be computed by dividing the values in the total gradient curve Gc(T ) by the isosurface area values: Gc(T ) = Gc(T )/Sc(T ). For certain applications the mean gradient is more informative than the total gradient, since it puts the gradient strength at a certain material transition in relation to the size of the corresponding structure.</p><p>There is another feature curve which can be derived at low cost from the original feature of isosurface area. Following the concept of surface fractality, we can compute the isosurface area curve Sc(T ) at different levels in a Gaussian pyramid of the original image data. The original image data set is smoothed and subsampled. This is carried out several times in order to yield a series of scale space images I k . (If the spatial subsampling is done in steps of 2, the additional overall computing cost is ∞ n=1 ( 1 2 3 ) n = 1 7 ≈14%.) For each of the subsampled images I k , the surface area curve S k c (T ) is computed in the manner described above. Then the surface area curves of different spatial resolutions can be compared. At each threshold T , the fractal dimension D f (T ) of each isosurface T can be assessed by linear regression of log S k c (T ) as a function of k. Since this is regression is carried out only for each histogram bin but is independent of the number of voxels, the computation cost is negligible. The fractal dimension is properly defined only for self-similar surface structures. Thus, the linear regression for each threshold T should, in addition to the inclination, also check the correlation coefficient, in order to determine whether the fractality measure is meaningful for a particular isosurface threshold T .</p><p>Another possible feature is the surface curvature of an isosurface at isovalue T . Here we are interested only in the absolute magnitude of the curvature components which are perpendicular to the isosurface normal. For example, we may want to merit isosurfaces which are smooth and show little bending. As in the surface area computation described above, we consider whether a certain face between a voxel x and its neighboring voxel x is part of the isosurface for a certain threshold T . If so, then the root mean square of the second derivative components perpendicular to the voxel face will be added to the histogram bin C(T ). For a face in x-direction between two voxels we thus estimate the curvature of this surface patch as dC = (∂ 2 /∂y 2 ) 2 + (∂ 2 /∂z 2 ) 2 and increment at bin I(x) by dC if I(x) &gt; I(x ), and decrement by dC if I(x) &lt; I(x ). (Respectively, for y and z-direction it is dC = (∂ 2 /∂x 2 ) 2 + ∂ 2 /∂z 2 ) 2 and dC = (∂ 2 /∂x 2 ) 2 + ∂ 2 /∂y 2 ) 2 .) As for the other features, after building the such weighted histogram C(T ) it is accumulated starting from high intensity bins, so that the cumulative histogram Cc(T ) =</p><p>I≥T C(I) provides an approximation of the surface curvature of the isosurface at isovalue T . As explained previously, a certain bin Cc(T ) only holds contributions from voxel faces which are 'exposed' (part of the isosurface) at a certain threshold T . Again, we are aware that the approximation of the curvature described here is biased for isosurfaces not aligned with the (x, y, z) -voxel grid, and rather crude compared to the appropriate projection of the local Hessian or curvature matrix onto the local gradient vector. However, the emphasis here is on the fast computability as a trade-off against estimation accuracy.</p><p>All features described can be computed during the same pass over the image volume, and rely only on local operations such as first and second derivatives, which in their simplest form can be estimated from differences in the 6-neighborhood of each voxel (optionally with prior Gaussian smoothing). The common link of all those features is that they are all linear in nature and can thus be computed by means of histogram accumulation. The underlying idea for all these features is to increment a histogram at the corresponding intensity bin once the threshold becomes so low that a voxel face starts to be part of the isosurface. The histogram is decremented at another bin by the same amount once the threshold becomes so low that a voxel face ceases to be part of the isosurface, so that the cumulative histogram displays the effect in the interval between those two isovalues.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Examples</head><p>In this section, we present some examples of the application of our method to detect intensity transitions between different material types in volume data, focusing on biomedical data. For the experiments, a direct volume rendering environment was developed in which the computed cumulative histograms are displayed jointly with the opacity transfer function, to support the rendering process. The user interactively adjusts the form of the opacity curve in accordance to the computed feature curve, and inspects changes in the rendered image. The Visualization Toolkit (VTK) <ref type="bibr" target="#b12">[12]</ref> was used as a software platform for our tool.</p><p>Our first experiment was made with a synthetic 3-D image which represented a model of a CT dataset <ref type="figure" target="#fig_1">(Fig. 2/left</ref> image at the top). Our model dataset consisted of two materials corresponding to soft tissue (dark material) and bone (light material). The material boundaries were blurred by convolving the model dataset with a 3-D Gaussian. The computed cumulative Laplacian-weighted histogram representing the total gradient contains two clear maxima corresponding to the transitions between the background and the first material and between the first and second material <ref type="figure" target="#fig_1">(Fig. 2/right  image at the top)</ref>. In order to illustrate how the detected intensity transitions can be used for assignment of visualization properties to data voxels, we rendered the synthetic dataset by using an opacity transfer function, the slopes of which were placed around the detected maxima. The form of the opacity function was chosen to make the "bone" completely opaque and the "soft material" semitransparent. The result of direct volume rendering is shown in the bottom image in <ref type="figure" target="#fig_1">Fig. 2</ref>.</p><p>The complete spectrum of characteristics of the model dataset is presented in <ref type="figure" target="#fig_2">Fig. 3</ref>. There, the conventional gray value histogram, total gradient, isosurface area, isosurface curvature, mean gradient, and total gradient divided by isosurface curvature are shown. Qual-itatively, it can be seen that a combination of features from different curves illustrates quite well the nature of the data.</p><p>The next three experiments were made with CT datasets. These included a tooth scan, which had been used for the Vis 2000 Transfer Function Bake-Off panel <ref type="bibr" target="#b10">[10]</ref>  <ref type="figure" target="#fig_3">(Fig. 4</ref>, the dataset is available at http://visual.nlm.nih.gov/data), a scan of a head from the standard VTK distribution <ref type="figure" target="#fig_4">(Fig. 5)</ref>, and an abdominal dataset <ref type="figure" target="#fig_5">(Fig. 6)</ref>. In all datasets the principal intensity transitions can easily be seen in the feature curves. In our experiments with CT data, the total gradient appears in most cases to be a sufficient feature to find dominant tissue transitions. For the tooth dataset, however, we used the mean gradient, since it allowed for better discrimination of the histogram peaks corresponding to the principal intensity transitions in the dataset, see <ref type="figure" target="#fig_3">Fig. 4</ref>.</p><p>An important application of the proposed technique is the selection of appropriate intensity thresholds for pulmonary nodules segmentation <ref type="bibr" target="#b13">[13]</ref>. In <ref type="figure" target="#fig_6">Fig. 7</ref>, a visualization of a lung nodule in a volume of interest (VOI) is shown. The 30×30×30 mm VOI was extracted from a multi-slice CT scan and consisted of 50×50×50 voxels. For this application it is important to take into accout the isosurface area in order to exclude the surrounding lung parenchyma, thus the mean gradient is a proper feature in this case.</p><p>In MRI datasets it is not usually possible to distinguish different tissue types solely using some global intensity isovalues. Thus for visualization of MRI datasets the use of global features based on intensity information, such as total or mean gradient, is limited. An additional challenge is the considerable amount of noise present in MRI scans. As an example, we applied our method to visualize an MRI sheep's heart dataset. The dataset was again taken from the Vis 2000 Transfer Function Bake-Off panel. In the mean gradient curve in <ref type="figure">Fig. 8</ref>, one can see only one well-defined intensity transition between the heart boundary and the background. It is, however, very difficult to distinguish between the structures inside the heart.</p><p>Our last experiment was made with the volume data originating from confocal microscopy, depicting a chromosome <ref type="figure">(Fig. 9</ref>). Traditional gray value histograms can often also provide hints about the locations of intensity transitions between different materials. However, in this particular case the conventional gray value histogram does not, give any reliable information about the transition between foreground and background; this can be seen in the left image in the figure. In contrast, the total gradient curve contains a clear maximum which is used to visualize the chromosome (the image on the right).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Conclusions</head><p>A computationally efficient method for automated detection of intensity transitions between different material types in volume data has been presented. Material transitions are determined in our approach as local maxima in a total gradient curve computed using a Laplacian-weighted gray value histogram. The histogram computation requires only one pass through the data volume. From the results of experiments, performed with different types of volume data, we can conclude that intensity transitions between the most interesting structures are clearly visible in the histogram curve if well-defined material transitions are present in the dataset, for example, when visualizing CT datasets. The use of the proposed approach for visualization of MRI data is, however, limited, since tissue boundaries in MRI data often cannot be appropriately discriminated using global intensity isovalues. In contrast to the frequently used gray value histogram, the total gradient curve is smooth and often provides better information about locations of isosurfaces. In cases where the isosurface area must be taken into account, e.g. segmentation of pulmonary nodules, the mean gradient should be used instead of the total gradient.</p><p>The intensity transition values used in the rendering process are currently determined by visual assessment of the feature curve. We developed an experimental tool for volume rendering, where the computed cumulative histogram is displayed jointly with the transfer function used for rendering (see <ref type="figure" target="#fig_1">Fig. 2, 5-9</ref>). The user can interactively select the optimal transfer function by editing its form accordingly to the characteristic parts of the histogram. Additional post-processing of the feature curve can also be incorporated into our approach to automatically determine the exact values of intensity transitions. For example, a parametric fit within a known intensity range containing the material transition of interest might be applied for this purpose.</p><p>Several other features of potential interest were described: the volume enclosed by the isosurface, the isosurface area, curvature, and fractality. Their computation can be performed by histogram accumulation in a manner analogous to the computation of the total gradient feature curve. The total and mean gradient were sufficient in most our experiments with biomedical data to find the dominant intensity transitions for visualization purposes. Nevertheless, the above mentioned additional features may be useful in certain cases to better understand the nature of the data to be processed.        </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Principle of cumulative Laplacian-weighted histogram computation.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>Left: one slice of a model dataset. Middle: total gradient feature curve combined with the opacity transfer function. Right: volume rendering of the dataset.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 3 :</head><label>3</label><figDesc>Characteristics of the model dataset. Top row/left: gray value histogram, right: total gradient. Middle row/left: isosurface area, right: isosurface curvature. Bottom row/left: mean gradient, right: total gradient divided by isosurface curvature.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 4 :</head><label>4</label><figDesc>Left: one slice of a CT tooth dataset. Middle: mean gradient feature curve combined with the opacity transfer function.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 5 :</head><label>5</label><figDesc>Left: one slice of a CT head dataset. Middle: total gradient feature curve combined with the opacity transfer function. Right: volume rendering of the dataset (with semi-transparent skin).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 6 :</head><label>6</label><figDesc>Left: one slice of a CT abdominal dataset. Middle: total gradient feature curve combined with the opacity transfer function. Right: volume rendering of the dataset.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 7 :</head><label>7</label><figDesc>Left: one slice from a subvolume of a CT lung dataset containing a nodule. Middle: mean gradient feature curve combined with the opacity transfer function. Right: volume rendering of the nodule.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 8 :Figure 9 :</head><label>89</label><figDesc>Left: one slice from an MR dataset of a sheep's heart. Middle: mean gradient feature curve combined with the opacity transfer function. Right: volume rendering of the dataset. Left: gray value histogram of a confocal microscopy dataset depicting a chromosome (16 slices). Middle: total gradient feature curve combined with the opacity transfer function. Right: volume rendering of the dataset. Note that the gray value histogram cannot provide hints about the locations of dominant isosurfaces.</figDesc></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgments</head><p>The abdominal CT dataset in </p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">The contour spectrum</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">L</forename><surname>Bajaj</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Pascucci</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Schikore</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE Visualization &apos;97</title>
		<meeting>IEEE Visualization &apos;97<address><addrLine>Phoenix, AZ, USA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1997-11" />
			<biblScope unit="page" from="167" to="175" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">A rulebased tool for assisting colormap selection</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">D</forename><surname>Bergman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">E</forename><surname>Rogowitz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">A</forename><surname>Treinish</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE Visualization &apos;95</title>
		<meeting>IEEE Visualization &apos;95<address><addrLine>Atlanta, GA, USA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1995-10" />
			<biblScope unit="page" from="118" to="125" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">A</forename><surname>Drebin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Carpenter</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Hanrahan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Computer Graphics (Proceedings of SIGGRAPH &apos;88)</title>
		<imprint>
			<date type="published" when="1988" />
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="65" to="74" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Generation of transfer functions using stochastic search techniques</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Hong</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kaufman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Pfister</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE Visualization &apos;96</title>
		<meeting>IEEE Visualization &apos;96<address><addrLine>San Francisco, CA, USA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1996-10" />
			<biblScope unit="page" from="227" to="234" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">D</forename><surname>Jackson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Classical Electrodynamics</title>
		<imprint>
			<date type="published" when="1962" />
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Semi-automatic generation of transfer functions for direct volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Kindlmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">W</forename><surname>Durkin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc</title>
		<meeting>null</meeting>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title level="m">ACM/IEEE Symposium on Volume Visualization</title>
		<meeting><address><addrLine>Research Triangle Park, NC, USA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1998-10" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Display of surfaces from volume data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Levoy</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Computer Graphics and Applications</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="29" to="37" />
			<date type="published" when="1988" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Marching cubes: A high resolution 3D surface construction algorithm</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Lorensen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Cline</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Computer Graphics (Proceedings of SIGGRAPH &apos;87)</title>
		<imprint>
			<date type="published" when="1987" />
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="163" to="169" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Design galleries: A general approach to setting parameters for computer graphics and animation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Marks</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Andalman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">A</forename><surname>Beardsley</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. SIGGRAPH &apos;97</title>
		<meeting>SIGGRAPH &apos;97</meeting>
		<imprint>
			<date type="published" when="1997-08" />
			<biblScope unit="page" from="389" to="400" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">The transfer function bake-off</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">P</forename><surname>Pfister</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Lorensen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Bajaj</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Computer Graphics and Applications</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="16" to="22" />
			<date type="published" when="2001-06" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title level="m" type="main">Three-Dimensional Biomedical Imaging: Principles and Practice</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">A</forename><surname>Robb</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1998" />
			<publisher>Wiley &amp; Sons</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<title level="m" type="main">The Visualization Toolkit: An Object-Oriented Approach to 3D Graphics</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Schroeder</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Martin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Lorensen</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1998" />
			<publisher>Prentice-Hall</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Optimal thresholding for 3D segmentation of pulmonary nodules in high resolution CT</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Wiemker</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Zwartkruis</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. of Int. Conf. Computer Assisted Radiology and Surgery (CARS &apos;01)</title>
		<meeting>of Int. Conf. Computer Assisted Radiology and Surgery (CARS &apos;01)<address><addrLine>Berlin, Germany</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2001-06" />
			<biblScope unit="page" from="611" to="616" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
