<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">CPR -Curved Planar Reformation</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Armin</forename><surname>Kanitsar</surname></persName>
							<email>kanitsar@cg.tuwien</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Graphics and Algorithms † Department of Radiology ‡ VRVis Research Center</orgName>
								<orgName type="institution">Vienna University of Technology University of Vienna Vienna</orgName>
								<address>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dominik</forename><surname>Fleischmann</surname></persName>
							<email>dominik.fleischmann@univie.ac.at</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Graphics and Algorithms † Department of Radiology ‡ VRVis Research Center</orgName>
								<orgName type="institution">Vienna University of Technology University of Vienna Vienna</orgName>
								<address>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Rainer</forename><surname>Wegenkittl</surname></persName>
							<email>rainer.wegenkittl@tiani.com</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Graphics and Algorithms † Department of Radiology ‡ VRVis Research Center</orgName>
								<orgName type="institution">Vienna University of Technology University of Vienna Vienna</orgName>
								<address>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Petr</forename><surname>Felkel</surname></persName>
							<email>petr.felkel@tiani.com</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Graphics and Algorithms † Department of Radiology ‡ VRVis Research Center</orgName>
								<orgName type="institution">Vienna University of Technology University of Vienna Vienna</orgName>
								<address>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Meister</forename><forename type="middle">Eduard</forename><surname>Gröller</surname></persName>
							<email>meister@cg.tuwien</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Graphics and Algorithms † Department of Radiology ‡ VRVis Research Center</orgName>
								<orgName type="institution">Vienna University of Technology University of Vienna Vienna</orgName>
								<address>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">CPR -Curved Planar Reformation</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-19T20:48+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>J.3.2 [Computer Applications]: Life and Medical Sciences-Medical Information Systems I.3.3 [Computing Methodologies]: Computer Graphics-Picture/Image Generation computed tomography angiography</term>
					<term>vessel analysis</term>
					<term>curved planar reformation</term>
				</keywords>
			</textClass>
			<abstract>
				<p>Visualization of tubular structures such as blood vessels is an important topic in medical imaging. One way to display tubular structures for diagnostic purposes is to generate longitudinal crosssections in order to show their lumen, wall, and surrounding tissue in a curved plane. This process is called Curved Planar Reformation (CPR). We present three different methods to generate CPR images. A tube-phantom was scanned with Computed Tomography (CT) to illustrate the properties of the different CPR methods. Furthermore we introduce enhancements to these methods: thick-CPR, rotating-CPR and multi-path-CPR.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>In medical imaging the assessment of tubular structures (i.e., blood vessels, bronchi, and colon) is a topic of high interest. Computed tomography (CT) and magnetic resonance imaging (MRI) provide three-dimensional volumetric data sets of the human body, which contain these objects of interest. The data gained from CT and MRI, however, include many objects of less or no interest. This makes volume-rendering (i.e., Maximum Intensity Projection (MIP), ray casting, shaded surface display) without preprocessing often impossible or inaccurate. Furthermore the objects of interest are hardly located entirely within a single plane. In order to investigate these objects their central axis is derived from the data set. In this respect several algorithms <ref type="bibr" target="#b8">[9,</ref><ref type="bibr" target="#b12">13,</ref><ref type="bibr" target="#b13">14]</ref> have been developed with different properties concerning reliability, speed and accuracy. The central axis, as an output of these algorithms, can be used as a camera path (i.e., virtual endoscopy) <ref type="bibr" target="#b11">[12]</ref>. As vascular structures have a relatively small diameter, the central axis is often taken as input for further vessel analysis. Different properties (i.e., minimal and maximal vessel diameter, average attenuation) can be displayed.</p><p>Another way to visualize structures with small diameter is to resample and visualize the data set according to the high level information gained from the centerline detection process. This process is called CPR -Curved Planar Reformation. This technique displays the whole tubular structure within a single image. Vascular abnormalities (i.e., stenoses, occlusions, aneurysms and vessel wall calcifications) are then investigated by physicians. This process is sometimes referred to as Multi Planar Reformation (MPR). However the term MPR is not precise enough, as it is commonly used for planar cross-sections re-sampled from volumetric data.</p><p>Even though CPR is an established technique in the medical community, the visual properties, the advantages and the problems of different types of CPRs have not been specifically addressed in the literature. Understanding the problems is essential for the accurate interpretation of the resulting images. Typically medical workstations contain some type of CPR, however important properties like length preservation are often not known to the user. This paper thus focuses on the generation, properties, and enhancements of different CPR methods. A comparison of this technique with conventional volume visualization techniques is not the topic of this paper, as such comparisons are already available <ref type="bibr" target="#b1">[2]</ref>.</p><p>Section 2 describes related work in this area. In Section 3 different CPR methods are introduced and their technical details are described. A short evaluation of the proposed methods on a dedicated tube-phantom is presented in Section 4. Section 5 proposes some extensions and variants of the previously introduced CPR methods. Notably a new method for compositing multiple CPRs is proposed. Possible improvements and conclusions are discussed in Section 6.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">RELATED WORK</head><p>Latest CT technology, such as multiple detector-array CT, provide high resolution volumetric data sets. Due to the large size of these data sets (up to 1900 transverse cross-sectional images of the abdomen and entire legs), the investigation of the original images is no longer an option. Therefore volume visualization and data reformation play an important role in medical imaging. As accuracy is an important aspect of medical imaging, most of the literature in this area is written from a medical point of view. There is little literature available on the technical aspects and on issues relevant for implementation of CPR.</p><p>Avants and Williams presented a vessel tracking method consisting of two parts <ref type="bibr" target="#b2">[3]</ref>. From user defined seed points a surface expansion is computed based on the eikonal partial differential equation. A minimal cost path is calculated from these regions. From this path a cross-sectional area/radius profile is generated.</p><p>He et al proposed a path extraction method based on a twodimensional region-growing algorithm with a subsequent shortest path algorithm <ref type="bibr" target="#b7">[8]</ref>. The resulting path was refined using the multiscale medial response. The vascular tree is flattened in a semiautomatic method called Medial Axis Reformation.</p><p>Some authors take the central-axis as an input for the generation of an abstract vessel-model. Abstract vessel-models allow fast rendering, as polygonal meshes of low complexity are generated <ref type="bibr" target="#b4">[5]</ref>. Furthermore non photorealistic rendering provides the possibility to emphasize global properties of the vascular tree <ref type="bibr" target="#b6">[7]</ref>. Bullitt and Aylward <ref type="bibr" target="#b3">[4]</ref> exploits central-axis information for speeding up conventional MIP. In a first step the surrounding of the vascular struc-  tures are projected to a modified z-buffer. In a subsequent step only non-empty areas are rendered according to the z-buffer values. For non tubular vascular structures (i.e., cardiac vessels) a lot of model representations exist. A systematic overview of models for cardiac function analysis is provided by Frangi et al. <ref type="bibr" target="#b5">[6]</ref>.</p><p>A comparison of MPR, MIP, shaded surface display (SSD) and direct volume rendering (DVR) with respect to accuracy is given by Addis et al. <ref type="bibr" target="#b1">[2]</ref>. According to this comparison all rendering techniques accurately display vessels of a diameter greater than 4 mm. Except DVR the error in all visualization methods increases for smaller structures. The problem of finding an appropriate transferfunction, respectively iso-value was not targeted by this paper.</p><p>Further information about the clinical relevance of the CPR visualization technique can be found in <ref type="bibr" target="#b0">[1]</ref>, <ref type="bibr" target="#b8">[9]</ref> and <ref type="bibr" target="#b10">[11]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">CPR METHODS</head><p>The goal of CPR visualization is to make a tubular structure visible in it's entire length within one single image. To accomplish this requirement a-priori information about the tubular structure, notably the object's central axis, is required. Without loss of generality the object's central axis is assumed to be a sequence of points at sub voxel resolution.</p><p>In general the spatial position and shape of the central axis determines which parts of the 3D space are visualized. On the left side of <ref type="figure" target="#fig_1">Figure 1</ref> the central axis is shown. The re-sampled surface is shown on the right side of <ref type="figure" target="#fig_1">Figure 1</ref>. As the surface is not well defined by just one curve in 3D, an additional vector (vector-ofinterest) is introduced. In some cases it is possible to define the vector-of-interest parallel to the xy-plane, which increases the performance of the generation process. Together with a point from the central axis, the vector-of-interest defines a straight line (line-ofinterest). All voxels touched by this line are taken to re-sample the volume along the line-of-interest.</p><p>The following subsections describe different methods for CPR generation with their respective geometric properties pointed out in detail. These properties are summarized in table 1. <ref type="figure" target="#fig_2">Figure 2</ref> illustrates the different CPR methods. The horizontal plane represents the image and the image y-axis as horizontal blue arrow. Corresponding to this axis, the curve in the volumetric data set is sketched by the vertical blue arrow.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Projected CPR</head><p>The projected CPR can be seen as a projection of a data set, taking into account only a thin slice of voxels (see <ref type="figure" target="#fig_2">Figure 2</ref>). This slice is defined by the central axis of the tubular structures and the vectorof-interest. We assume the vector-of-interest to be colinear with thy  <ref type="table">Table 1</ref>: Properties of CPR types y-axis and apply a parallel projection of a free-form surface along the x-axis.</p><p>In particular, for each point of the central axis the line-of-interest is projected to the corresponding line of the image. This relationship is defined by the camera's coordinate system (i.e., the upvector). If the up-vector of the camera is parallel to the z-axis, the z-coordinate of the line-of-interest is mapped directly to the image. The resulting image size only depends on the size of the data set.</p><p>For this camera coordinate system (the up-vector being parallel to the z-axis), a monotonously increasing central axis with respect to the z-axis is the most simple case. Each line in the image buffer may be overwritten without considering the contained values. However this restriction normally does not hold with real-world data sets. Therefore voxel compositing is done using Maximum Intensity Projection (MIP), Minimum Intensity Projection (MinIP), or averaging (AVG).</p><p>Due to parallel projection the spatial relations are maintained by this method. This helps the observer to perceive the spatial arrangement of the vessels.</p><p>The first disadvantage of this method is that structures of higher intensity (i.e., bony structures) still may obscure the structures of interest (i.e., vessels). This situation arises, if parts of the lineof-interest associated with a certain point of the central-axis contains bony structures and this parts are projected to an image region containing vascular structures from a previous or following lineof-interest. The occurrence of such situations heavily depends on the application area. In the case of peripheral vascular structures this case hardly ever arises, however the visualization of the carotid artery at the level of the skull-base often leads to such situations.</p><p>Another disadvantage of the projected CPR method is the distortion of the central axis' length due to parallel projection. Therefore isometry is not preserved.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Stretched CPR</head><p>The surface defined by the vessel central axis and the vector-ofinterest is curved in one dimension and planar in the other one. Stretching the curved dimension results in a plane showing the tubular structure in it's entirety without overlapping (see <ref type="figure" target="#fig_2">Figure 2</ref>). This type of CPR is referred to as Stretched CPR.</p><p>Processing all points of the central-axis successively, the corresponding lines-of-interest are mapped to the image. This is done by rotating the consecutive point of the central axis around the current line-of-interest. The point is rotated in a way that the resulting plane is coplanar to the viewing plane. Isometry is maintained as the distance between the two consecutive points is preserved in image space by this operation. Thus the image size does not only depend on the length of the path, but also on the vector-of-interest. This fact is easy to see as the image height is small, if the path is highly curved in the resulting image.</p><p>Especially we are only interested in the image y-coordinates of the lines-of-interest. Let's assume point P i to be the last processed point and point P i+1 the currently processed point of the central axis. The vector d i = − −− → P i P i+1 represents the path direction at position i. Furthermore l is the normalized direction of the line-of-interest. </p><formula xml:id="formula_0">∆ i = | d i | 2 − ( l • d i ) 2<label>(1)</label></formula><p>The image position y i+1 of the line-of-interest related to point P i+1 is given by y i+1 = y i + ∆ i where y 0 = 0. The central axis is assumed to be sampled with sub-voxel resolution all rows of the image are filled. Introducing a zooming capability requires to interpolate between the lines-of-interest, if necessary.</p><p>The generation process of a stretched CPR ensures that other objects do not cover vascular structures. This is one of the key requirements in vessel visualization. The curvature of the tubular structure is still largely maintained by this kind of visualization, thus spatial orientation is still possible for the user.</p><p>The main advantage of this CPR type is the preserved isometry. This is important for accurate preoperative planning of endovascular stent-graft treatment of aortic aneurysms. The lengths of normal and abnormal vascular segments need to be determined accurately for sizing the endovascular prosthesis. This is possible in the case of a stretched CPR, but not in the case of a projected CPR.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Straightened CPR</head><p>The third type of curved planar reformation fully straightens the tubular structure (see <ref type="figure" target="#fig_2">Figure 2</ref>). This CPR method generates a linear representation of the vessel with varying diameter. The height of the resulting image corresponds to the length of the central axis.</p><p>In contrast to the above mentioned methods, the line-of-interest is no longer necessarily parallel to the axial slices. At each point P i of the central axis the tangent vector t i is calculated. The plane ε i (cross-section) is defined by P i and t i . A local coordinate system is defined by two generating vectors of the plane</p><formula xml:id="formula_1">ε i : − → u i and − → v i whereby − → u i ⊥ − → v i .</formula><p>The line-of-interest is defined within the plane ε i by an angle within the unit circle: the angle-of-interest ϕ.</p><p>As either − → u or − → v is mapped to the local coordinate system's xaxis, excessive rotation along the central axis may cause undesired artifacts. Methods exist to minimize this effect <ref type="bibr" target="#b9">[10]</ref>.</p><p>In particular it is not necessary to re-sample the whole crosssection from the data set. It is more efficient to do a transformation from the local coordinate system to the global coordinate system. The direction of the line-of-interest l i is given by formula (2):</p><formula xml:id="formula_2">l i = cos ϕ • u i + sin ϕ • v i<label>(2)</label></formula><p>The image offset ∆ i for the line-of-interest corresponding to point P i+1 equals the distance from point P i to P i+1 :</p><formula xml:id="formula_3">∆ i = | − −− → P i P i+1 |<label>(3)</label></formula><p>The most obvious disadvantage is the lack of spatial orientation. Only short segments of visible side branches of the parent vessels indicate the topographic position of a given arterial segment. One advantage of this method is the preserved isometry. Furthermore the direct relation between image height and central-axis length makes it easy to create linked displays. Whenever the user points at a certain position of the image, the corresponding crosssection is displayed in a separate view. This feature eases the lack of spatial orientation.</p><p>Another advantage is the easy perception of variances of the diameter. Due to the elimination of curvature of the central-axis the only varying property along the central-axis is the diameter.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">EVALUATION OF THE CPR METHODS</head><p>To evaluate the different CPR methods a phantom (Tubes Phantom) simulating vascular structures in predefined spatial positions was assembled. The phantom was scanned with CT at a resolution of 512x512x509 voxels. The real world size of the phantom was 382 mm in transversal and 509 mm in longitudinal direction. The display window of the CPR images is centered at -251 HU (Hounsfield Units) at a width of 1452 HU.</p><p>Apart from different objects for evaluating measurement accuracy, the phantom contained water-filled tubes simulating blood vessels wrapped around three cardboard cylinders of 6 cm diameter oriented in the three main directions (see <ref type="figure" target="#fig_3">Figure 3</ref>). Each thin tube was 50 cm long and was scaled each 5 cm by a marker. Furthermore a 1.5 m long tube in arbitrary position, also filled with water, was included. The distance between each marker of 1 cm width was 9 cm. The diameter of the thin tubes was 4.6 mm, which is comparable to the arteries distal of the knees. In the case of the projected CPR the voxels are composited using MIP. The first row of <ref type="figure" target="#fig_6">Figure 4</ref> shows the MIP of the phantom data set. The visualized tubes are highlighted, by showing their central-axis in blue color.</p><p>Comparing the projected CPR to the corresponding MIP, the similarity proposed in chapter 3 is quite obvious. Whenever the central-axis is orthogonal to camera coordinate system's up-vector, the visible diameter of a vessel may degenerate. At the inflection point in image space of the projected central-axis at most half of the true diameter is displayed in case of a perfect central-axis. The diameter may degenerate to a line if the critical section is not covered by a point of the central-axis prior or afterwards. These artifacts (red markers) can be seen in the second row of <ref type="figure" target="#fig_6">Figure 4</ref>.</p><p>The stretched CPR method was found out to produce highly reliable results. However any deviation of the central-axis from the optimal central position increases the displayed length of the tubular structure. As the difference is quite small compared to the length of the structure the error is usually negligible. In rare situations not the length of the object, but it's diameter may appear larger than real. This occurs, if the tangent vector of the central-axis is nearly parallel to the vector-of-interest.</p><p>The straightened CPR is highly sensitive to inaccuracies of the underlying central axis. Any deviation of the computed path from the true central axis results in a shift of the object in image space.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">CPR ENHANCEMENT</head><p>All of the above CPR methods have some limitations in common. First, all CPRs depend on the quality of the computed central axis. Second, only those parts of the vascular structures are visible in the image, which are touched by the re-sampled plane. Third, only one tubular structure of an entire vascular tree can be visualized simultaneously.As surrounding tissue may be distorted in the image, it can be difficult to immediately recognize portions of a vessel tree actually displayed. To overcome those limitations of the CPR methods some enhancements are proposed in the following section.</p><p>The enhancements of the CPR methods are demonstrated on a real-world data set with a scanned resolution of 512x512x988. The patient suffers from high graded stenoses in both femoral arteries. Calcifications are visible in both popliteal arteries and a complete occlusion in the left popliteal artery is present.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Thick CPR</head><p>Up to now only a thin surface was taken into consideration to be re-sampled from the data set. Especially in the case of arteries with a small diameter an inaccurate central axis (see <ref type="figure" target="#fig_4">Figure 5a</ref>) immediately results in an artificial stenosis (see <ref type="figure" target="#fig_4">Figure 5b)</ref>. In order to make this visualization method less sensitive to imprecise central paths a slab of a certain thickness is re-sampled from the data set.</p><p>Averaging the voxels projected to one pixel in image space naturally results in blurred images (see top row of <ref type="figure" target="#fig_7">Figure 6</ref>). Especially tiny structures tend to fade out as well as calcified parts may decrease in attenuation. However especially for data with low signal to noise ratio this kind of re-sampling improves the image quality.</p><p>Using maximum intensity projection for re-sampling basically gives the maximum extent of high attenuation objects within the slab from the current viewing direction. Thus no artificial stenosis are possible as long as the true central axis is within the range of the re-sampled slab. Another advantage of MIP re-sampling is an increase of spatial orientation, as side branches and bifurcations of the main arteries become visible (see second row of <ref type="figure" target="#fig_7">Figure 6</ref>).  However, depending on the viewing direction, vascular structures might be obscured by adjacent bones.</p><p>Analogously the minimum intensity re-sampling method is intended to emphasize structures of low attenuation (i.e., bronchi). A comparison between MIP and MinIP on a thoracic data set is shown in <ref type="figure" target="#fig_5">Figure 7</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Rotating CPR</head><p>Visualizing the lumen of the vessel hides features, which are not touched by the displayed longitudinal section. Rotating the longitudinal section around the central-axis provides the possibility to inspect the entire vessel. We call this technique rotating CPR.</p><p>A stretched or projected CPR is generated by rotating the vectorof-interest around a predefined axis. The straightened CPR is rotated by changing the angle-of-interest accordingly.</p><p>In <ref type="figure" target="#fig_8">Figure 8</ref> a stretched CPR from seven different viewing directions is shown. The rotation axis is parallel to the z-axis and centered within the axial slices. The rotation angle is given as the enclosed angle of the viewing direction and the negative y-axis. Vessel wall calcification becomes visible at 90 • , 120 • and 150 • .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Multi-Path CPR</head><p>One substantial disadvantage of CPR visualization for diagnostic purposes is the restriction to only one tubular element. Most clinically relevant 'tubes' are part of a branching, anatomic structure. For instance the peripheral arterial tree begins at the abdominal aorta and branches into the left and right common iliac artery which again branches into internal and external iliac arteries. The latter is in continuity with the common femoral artery, which branches into a deep and into a superficial femoral artery, which becomes the popliteal artery and diverges into the anterior tibial, the posterio tibial, and the peroneal arteries. A comprehensive display of all clinically relevant vessels in one image is highly desirable.</p><p>The straight forward approach of simply compositing all calculated CPRs does not produce the desired result. No matter which re-sampling strategy is applied artifacts are always introduced in the generated image. In <ref type="figure" target="#fig_9">Figure 9</ref> vascular structures are obscured by bones from different layers. Therefore we propose a new image    The tree of central-axes and the volumetric data set is taken as input for the algorithm <ref type="figure" target="#fig_1">(Figure 10a</ref>). An enhanced z-buffer b of the same size as the image provides space for information entries containing a reference to a path, a reference to a point of this path (point), and depth information. Furthermore each entry contains information about an associated span begin and end. A span represents the part of an image line belonging to a certain path segment.</p><p>Tree projection. The tree (10b) is mapped to the buffer b according to the applied CPR method. <ref type="figure" target="#fig_1">Figure 10c</ref> shows the entries of the buffer after the CPR process. If points of different paths are mapped to the same image position, the one spatially closer to the observer is taken.</p><p>Buffer traversal. In a second step two buffer traversals are needed to determine the length of the span. The span is computed so that the space between neighboring paths within a line is equally divided. The image line at the border of the image is assigned to the leftmost or rightmost path segment respectively (see <ref type="figure" target="#fig_1">Figure  10d)</ref>.  <ref type="figure" target="#fig_1">Figure 10e)</ref>.</p><p>A projected multi-path CPR is presented in <ref type="figure" target="#fig_1">Figure 11</ref>. The projected multi-path CPR on the left provides an overview of the processed data set. A close-up of the upper image region is shown from different viewing directions. The CPR can still be rotated.</p><p>As the vessel course in the straightened CPR is fixed to the center of the image, all CPRs would be mapped to the same image position. Therefore we propose a tree-like arrangement of the CPRs from the tree segments. In <ref type="figure" target="#fig_1">Figure 12</ref> the corresponding area was processed using the stretched multi-path CPR method.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">CONCLUSIONS AND DISCUSSION</head><p>In this paper methods for the generation of Curved Planar Reformation (CPR) images have been presented. This method allows the visualization of entire tubular structures with minimal modification of the original data. The main application of this visualization method is Computed Tomography Angiography (CTA). CPR provides the possibility to visualize the interior of vascular structures (i.e., the lumen of the vessel). Direct volume rendering approaches and surface shaded display methods only provide the possibility to inspect the surface of vascular structures. With volume rendering even mild vessel wall calcifications may obscure the true vessel lumen (flow channel), which is the clinically relevant information. In this case the diagnostically relevant information needs to be supplemented by browsing through the original cross-sectional images, which is impractical with large data sets. Diagnostic relevant information in this case is provided by axial slicing through the data, which is tedious for large data sets, or by CPR images. Three different methods (i.e., projected, stretched, and straightened CPR) have been demonstrated. A comparison of the three methods with respect to spatial perception, isometry, and possible occlusions has shown that the stretched CPR is the preferred method for many applications.</p><p>Targeting the drawbacks of visualizing tubular structures using CPRs three enhancements to the basic methods have been introduced. The generalization of the re-sampled slice to a slab of voxels improves the image quality of thin structures. In daily practice the MIP re-sampling strategy was found out to be the most appropriate.</p><p>The rotating CPR significantly improves the quality of vessel investigation and we speculate that it substantially adds to diagnostic confidence. Interactivity is a main property of this improvement. The performance of this image based rendering technique mainly depends on the display size. The length of central-axis has impact on the performance as each point has to be transformed. Finally the volume contributes to the rendering time due to the limited memory bandwidth. Yet all operations are linear thus the overall complexity is linear. The current implementation in Java on a PC workstation with an Intel PIII 1GHz main processor renders 9.8 frames per second of the real-world data set in a 557x523 image using the stretched CPR method for the path shown in <ref type="figure" target="#fig_7">Figure 6</ref>.</p><p>As fewer images have to be generated and as the spatial relationships of the vascular tree are well preserved, we believe that multi-path CPRs are not only very well suited for diagnostic purposes, but also for the documentation and for communicating the extent of diseases to the treating physician.  </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>IEEE</head><label></label><figDesc>Visualization 2002 Oct. 27 -Nov. 1, 2002, Boston, MA, USA 0-7803-7498-3/02/$17.00 © 2002 IEEE</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 :</head><label>1</label><figDesc>Principle of the CPR visualization: The vector-of-interest (vi) and the line-of-interest (li) defining the re-sampled plane.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 2 :</head><label>2</label><figDesc>Different CPR generation methods: a) Projected CPR, b) Stretched CPR, c) Straightened CPR According to formula (1) the offset ∆ i in image space is.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 3 :</head><label>3</label><figDesc>Iso-surface extraction of the´Tubes Phantom´at -224 HU.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 5 :</head><label>5</label><figDesc>Artificial stenosis introduced by imprecise central axis computation.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 7 :</head><label>7</label><figDesc>Left to Right: MinIP of 5 mm thick slab, MIP of 0 mm thick slab, MIP of 5 mm thick slab.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 4 :</head><label>4</label><figDesc>Top to bottom: MIP, Projected CPR, Stretched CPR, Straightened CPR. Left to right: Major central-axis direction parallel to z-axis, parallel to y-axis, parallel to x-axis, in arbitrary direction.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 6 :</head><label>6</label><figDesc>Left side: A stretched CPR of the whole data set. Middle and right side: Enlargement of the upper and lower sector. Top row to bottom row: Averaging, MIP and MinIP with resampling of 0 mm, 5 mm and 10 mm.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 8 :</head><label>8</label><figDesc>Rotating Stretched CPR: 0 • , 30 • , 60 • , 90 • , 120 • , 150 • , 180 • .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Figure 9 :</head><label>9</label><figDesc>MIP compositing of projected CPRs. space driven method for compositing projected or stretched CPRs from multiple central-axes.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head></head><label></label><figDesc>Data re-sampling. In the final step the buffer is traversed again. Each filled entry b[x, y] is processed so that the image line y is filled from position b[x, y].begin to b[x, y].end with the data values associated with point b[x, y].point. This results in a composited CPR through multiple vessel center-paths without overlapping structures, as each tree segment is drawn in a separate image region (see</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Figure 10 :</head><label>10</label><figDesc>Generation of multi-path CPRs.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>Figure 11 :</head><label>11</label><figDesc>Overview of a projected multi-path CPR at 0 • . Enlargement of the projected multi-path CPRs at 30 • , 60 • , 90 • , 120 • , 150 • , 180 • .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13"><head>Figure 12 :</head><label>12</label><figDesc>Overview of a stretched multi-path CPR at 0 • . Enlargements of the stretched multi-path CPRs at 30 • , 60 • , 90 • , 120 • , 150 • , 180 • .</figDesc></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">ACKNOWLEDGEMENTS</head><p>The work presented in this publication has been funded by the ADAPT project (FFF-804544). ADAPT is supported by Tiani Medgraph, Vienna (http://www.tiani.com), and the Forschungsförderungsfonds für gewerbliche Wirtschaft, Austria. See http://www.cg.tuwien.ac.at/research/vis/adapt for further information. The authors thank Dominik Sandner for patient scanning and the staff of the department of radiology at the general hospital Vienna for the support.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Curved Multiplanar Reconstructions for the Evaluation of Contrast-Enhanced Electron-Beam CT of the Coronary Arteries</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Achenbach</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Moshage</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Ropers</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Bachmann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Roentgenol</title>
		<imprint>
			<biblScope unit="page" from="895" to="899" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Addis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Hopper</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Iyriboz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Wise</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Kasales</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Blebea</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Mauger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Angiography</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">In Vitro Comparison of Five Reconstruction Methods. In Am. J. Roentgenol</title>
		<imprint>
			<biblScope unit="volume">177</biblScope>
			<biblScope unit="page" from="1171" to="1176" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">An Adaptive Minimal Path Generation Technique for Vessel Tracking in CTA/CE-MRA Volume Images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Avants</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Williams</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">MICCAI 2001</title>
		<imprint>
			<date type="published" when="2000" />
			<biblScope unit="page" from="707" to="716" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Volume Rendering of Segmented Tubular Objects</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Bullitt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Aylward</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">MICCAI 2001</title>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="page" from="161" to="168" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Surface Reconstruction Of The Branching Vessels For Augmented Reality Aided Surgery</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Felkel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Fuhrmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kanitsar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Wegenkittl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">BIOSIGNAL 2002</title>
		<imprint>
			<date type="published" when="2002" />
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page" from="252" to="254" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Three-Dimensional Modeling for Functional Analysis of Cardiac Images: A Review</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Frangi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Niessen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Viergever</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Medical Imaging</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Visualization and Interaction Techniques for the Exploration of Vascular Structures</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Hahn</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Preim</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Selle</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Peitgen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Visualization</title>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="page" from="395" to="402" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Medial Axis Reformation: A New Visualization Method for CT Angiography</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Dai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Lu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Cao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Bai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Jing</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Academic Radiology</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="726" to="733" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Computed Tomography Angiography: A Case Study of Peripheral Vessel Investigation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kanitsar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Wegenkittl</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Felkel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Fleischmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Sandner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Gröller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Visualization</title>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2001" />
			<biblScope unit="page" from="477" to="480" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Two Moving Coordinate Frames for Sweeping along a 3D Trajectory</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Klok</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Computer Aided Geometry Design</title>
		<imprint>
			<date type="published" when="1986" />
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="217" to="229" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Multi-Detector Row CT Angiography of Lower Extremity Arterial Inflow and Runoff: Initial Experience</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Rubin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Schmidt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Logan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Sofilos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Radiology</title>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="page" from="146" to="158" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title level="m" type="main">VirEn: A Virtual Endoscopy System. Machine Graphics &amp; Vision</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Vilanova</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>König</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Gröller</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1999" />
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="469" to="487" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Fast Delineation and Visualization of Vessels in 3-d Angiographic Images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Wink</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Niessen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Viergever</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Medical Imaging</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="337" to="346" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Reconstruction of Branching Blood Vessels from CT-Data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Zahlten</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Juergens</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Peitgen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Eurographics Workshop on Visualization in Scientific Computing</title>
		<imprint>
			<date type="published" when="1994" />
			<biblScope unit="page" from="161" to="168" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
