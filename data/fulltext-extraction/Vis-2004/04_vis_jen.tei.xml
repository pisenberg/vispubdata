<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">ImageSurfer: A Tool for Visualizing Correlations between Two Volume Scalar Fields</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dennis</forename><surname>Jen</surname></persName>
							<email>dsjen@cs.unc.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Peter</forename><surname>Parente</surname></persName>
							<email>parente@cs.unc.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jonathan</forename><surname>Robbins</surname></persName>
							<email>robbins@cs.unc.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christopher</forename><surname>Weigle</surname></persName>
							<email>weigle@cs.unc.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Russell</forename><forename type="middle">M</forename><surname>Taylor</surname><genName>II</genName></persName>
							<email>taylorr@cs.unc.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alain</forename><surname>Burette</surname></persName>
							<email>alain_burette@med.unc.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Richard</forename><surname>Weinberg</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of North Carolina</orgName>
								<address>
									<settlement>Chapel Hill</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of North Carolina</orgName>
								<address>
									<settlement>Chapel Hill</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of North Carolina</orgName>
								<address>
									<settlement>Chapel Hill</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff3">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of North Carolina</orgName>
								<address>
									<settlement>Chapel Hill</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff4">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of North Carolina</orgName>
								<address>
									<settlement>Chapel Hill</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff5">
								<orgName type="department">Department of Cell and Developmental Biology</orgName>
								<orgName type="institution">University of North Carolina</orgName>
								<address>
									<settlement>Chapel Hill</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff6">
								<orgName type="department">Department of Cell and Developmental Biology Neuroscience Center</orgName>
								<orgName type="institution">University of North Carolina</orgName>
								<address>
									<settlement>Chapel Hill</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">ImageSurfer: A Tool for Visualizing Correlations between Two Volume Scalar Fields</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-20T19:32+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>CR Categories: I.3.7 [Computer Graphics]: Three-Dimensional Graphics and Realism</term>
					<term>I.3.8 [Computer Graphics]: Applications</term>
					<term>J.3 [Computer Applications]: Biology and Genetics scientific visualization, volume visualization, data exploration, biology, confocal microscopy, immunofluorescence</term>
				</keywords>
			</textClass>
			<abstract>
				<p>ImageSurfer is a tool designed to explore correlations between two 3D scalar fields. Our scientific goal was to determine where a protein is located, and how much its concentration varies along the membrane of a neuronal dendrite. The 3D scalar field data sets fall into two categories: dendritic plasma membranes (defining the structure) and immunofluorescent staining (defining protein concentration along the structure). ImageSurfer enables scientists to analyze relationships between multiple data sets obtained with confocal microscopy by providing 3D surface view, height field, and graphing tools. Each tool reduces the complexity of the problem by extracting a restricted subset of data: finding a region of interest in 3D; getting a sense of relative concentrations in 2D, and getting exact concentration values in 1D. The current design is presented, along with the rationale for each design decision. The tool is already proving useful for data exploration, analysis, and presentation.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Confocal microscopy, a widely-used tool in biomedical research, can provide high-resolution 3D images of biological structures. These microscopes are designed to take advantage of widely used techniques that label biological structures with fluorophores (chemicals that fluoresce at specific wavelengths). For instance, if a specimen is labeled with two fluophores, the microscope can capture data from the same locus on the specimen twice, each time illuminating the specimen with a different wavelength of light. Because of the way the data sets are acquired, they are precisely aligned in space and can be easily fused for analysis.</p><p>Although the microscope is designed to provide volume data, analysis of the data sets from confocal microscopes is in practice almost exclusively performed in only two dimensions. This reflects biomedical researchers' unfamiliarity with 3D display tools, and the need for new software tailored to their research.</p><p>Development of ImageSurfer, a program which displays the correlation between two 3D scalar fields, was driven by an experimental study of the distribution of calcium pumps within dendritic spines of neurons.</p><p>Section 2 describes the problem domain. Section 3 describes the scientific goals. Section 4 provides a description of data collection and characteristics of the data relevant to its visualization. Section 5 describes existing systems capable of visualizing confocal data sets. Section 6 describes ImageSurfer. Section 7 documents feedback from the scientists. Finally Section 8 describes how ImageSurfer is being used for studies of cystic fibrosis and outlines planned future improvements. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">BIOLOGICAL BACKGROUND</head><p>The scientific question that motivated the development of Image-Surfer involved a study of proteins embedded in the plasma membrane of neurons (nerve cells).</p><p>Besides the standard machinery used by all cells, each neuron also has a specialized receiver (composed of dendrites) and a long (100 µm-10 cm) thin (0.4-20 µm) transmission line (the axon), which branches and contacts dendrites of other neurons ( <ref type="figure" target="#fig_1">Figure  1a</ref>). These contacts (synapses) are the sites of communication between neurons. To give a sense of its complexity, the human brain contains ~10 <ref type="bibr" target="#b9">10</ref> neurons, making a total of ~10 <ref type="bibr" target="#b13">14</ref> synaptic connections. Electrical depolarization of a neuron triggers an electrochemical spike (the "action potential") which rapidly propagates down the axon to its presynaptic terminal, triggering release of a neurotransmitter chemical. The transmitter diffuses across the synaptic cleft (~20 nm wide) and binds to receptor proteins embedded in the postsynaptic dendritic membrane. This binding leads to depolarization, which can trigger an action potential in the target cell, if enough synapses are active simultaneously <ref type="bibr" target="#b0">[1]</ref>.</p><p>Most synaptic contacts are made through specialized structures called dendritic spines. The spine is a tiny bulbous projection, with a neck typically ~1-2 µm long and ~0.2 µm thick, ending in a spine "head," typically ~0.5 µm in diameter ( <ref type="figure" target="#fig_1">Figure 1b</ref>). Synaptic efficacy can vary. It is believed that changes in synaptic efficacy, especially in one brain region (the hippocampus), represent an important component of memory. Synaptic efficacy is highly regulated, especially by the local concentration of calcium ions, which activate a variety of complex enzyme systems within the neuron. The local concentration of calcium is in constant flux, reflecting the interplay between calcium entry through specialized ionic channels, and calcium extrusion, especially via the plasma membrane calcium ATPase (PMCA) <ref type="bibr" target="#b1">[2]</ref>. While the biological function of spines remains controversial, recent work indicates that one major function is to compartmentalize calcium signals. To gain a better understanding of this compartmentalization, it is important to understand the distribution of PMCA pumps along the dendritic plasma membrane, and in different subregions of the dendritic spine.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">SCIENTIFIC GOALS</head><p>To gain a better understanding of calcium signaling in forebrain neurons, we want to achieve the following:</p><p>Goal 1: Define the distribution of PMCA along dendrites in the rat hippocampus. How is the PMCA distributed along a dendrite?</p><p>Goal 2: Understand PMCA concentration along the length of the spine, from its parent dendritic shaft all the way to its tip (the usual site of synaptic contact). How does concentration vary along a given spine? Where is the highest concentration of PMCA? Where is the lowest concentration?</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DATA</head><p>This section describes how data is collected from brain tissue, and then describes the characteristics of the data collected.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Specimen Preparation</head><p>50 µm-thick sections of formaldehyde-fixed tissue from the brain of Sprague-Dawley rats were immunostained for confocal microscopy. To identify the PMCA protein, we incubated sections with an antibody raised against PMCA, followed by incubation with a second antibody (raised against the first antibody) that has been chemically coupled to a fluorescent dye. To image neurons, the sections were then stained with DiO (dioctadecyloxacarbocyanine perchlorate), a dye that fluoresces at a different wavelength. DiO is freely soluble in the lipids of the plasma membrane of a neuron, thus defining the shape of dendrites and dendritic spines in the region of interest. Tissue sections were then mounted on a microscope slide and covered with a thin coverslip for examination.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Image Capture</head><p>Images of the specimen were acquired using a Leica SP2 confocal microscope <ref type="bibr" target="#b3">[4]</ref>. The specimen was illuminated with a rasterscanned laser beam at a wavelength that causes the PMCAantibody complex to fluoresce.</p><p>The specimen was then (a) (b) illuminated with light of another wavelength, causing fluorescence of DiO, as a second image of the same slice was captured.</p><p>Confocal microscopy yields thin (&lt;1 µm) optical sections in the zaxis. To capture a 3D image, the process is repeated for each optical section in the tissue, yielding a stack of slices, with two images for every slice (currently, 1024 by 1024 pixels). One stack of images shows the concentration of PMCA, and the other stack reveals the general structure of dendrites stained with DiO. Microscope design ensures that the two stacks of images are properly registered. The spatial resolution of confocal microscopy is lower in the zaxis than in x and y, requiring non-uniform scaling in Image-Surfer's display and analysis tools. Each stack of images forms a 3D scalar field.</p><p>ImageSurfer's design was guided by two inevitable confounding factors in the specimens that are imaged. First, brain tissue is packed with dendrites and axons (the "neuropil"); thus, the PMCA data set is cluttered with splotches of light coming from PMCA in neurons completely unrelated to the dendrite under examination. Second, the DiO data set also contains extraneous biological features such as blood vessels and parts of other neurons. These irrelevant features can occlude the features of interest when both data sets are displayed simultaneously.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">RELATED VISUALIZATION SYSTEMS AND VOLUME RENDERING TECHNIQUES</head><p>ImageSurfer displays the two data sets in a single view and includes techniques explicitly designed to help users study the correlations between multiple data sets. It uses the Visualization Toolkit (VTK) <ref type="bibr" target="#b4">[5]</ref> to provide the necessary visualization capabilities. Extending the foundation of VTK and employing techniques used in other visualization systems, ImageSurfer provides custom tools for meeting the scientific goals defined in Section 3. Several existing commercial and research systems provide techniques for visualizing volumetric data in general and confocal microscopy data in particular.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Commercial Systems</head><p>Each brand of confocal microscope comes with its own proprietary visualization software, such as those provided by Leica and Bio-Rad. Other commercial systems, such as Volocity and Vox-Blast, have been built by companies not affiliated with microscope developers. Other commercial systems use open-source toolkits to develop applications capable of visualizing confocal data sets. Two such applications are VolView <ref type="bibr" target="#b5">[6]</ref>, built on VTK, and Amira <ref type="bibr" target="#b6">[7]</ref>, built on Open Inventor <ref type="bibr" target="#b7">[8]</ref>.</p><p>As provided, these applications are developed for broad applicability and do not provide specific tools for reaching our scientific goals.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Research Systems</head><p>Several visualization systems developed for research purposes are built to address specific problems for their users. Several provided insight that was used in ImageSurfer's design.</p><p>VisBio <ref type="bibr" target="#b8">[9]</ref> is a system designed to visualize multidimensional data sets. It provides analysis tools for stacks of images that vary over focal planes (as in confocal microscopy), but it is designed especially for stacks of images that vary over time, as would be encountered in imaging live cells, not fixed tissue. One such analysis tool is a plane that can slice at arbitrary angles, which in turn presents a view of the interpolated data. ImageSurfer extends this tool by enabling scientists to slice dendritic spines at arbitrary angles to answer their scientific questions. The plane placement is essentially the one described in Kniss et al. <ref type="bibr" target="#b9">[10]</ref>, but the plane is used to generate a separate view.</p><p>Hu et al. <ref type="bibr" target="#b10">[11]</ref> describe a system aimed at extracting specific features from confocal image stacks. It also enables rendering volumes of two data sets simultaneously. Proteus <ref type="bibr" target="#b11">[12]</ref> is another system designed for visualizing confocal image sets that vary over time. Notably, de Leeuw et al. <ref type="bibr" target="#b11">[12]</ref> describes a visualization technique in which Proteus displays one data set that is completely enclosed in a second data set with the outer data rendered slightly transparent. Proteus' visualization shows correspondence because the outside data set is a fairly large spherical shape. Because neither of the scientists' data sets will completely enclose the other, ImageSurfer extends Hu et al.'s and Proteus' displays to provide visualization techniques that remove irrelevant details while answering the scientific questions.</p><p>Few systems provide support for overlay and analysis of multiple data sets. Monks et al. <ref type="bibr" target="#b12">[13]</ref> describe one such system that renders confocal image stacks in a way that emphasizes the correspondence between different proteins during cell-cell interactions. This system first renders isosurfaces from two dats set in different colors along with slight transparency. A third isosurface is rendered in a different color, based on a threshold that is a specified function of both volume data sets, producing a threshold data set. When the values from either data set are below specified thresholds, the third data set is set to zero. When above the threshold, values from the first two data sets are summed. This generates the third volume data set, rendered as an isosurface that shows where the volumes intersect at sufficiently high thresholds. Because the PMCA data sets contain concentrations unrelated to the dendrites, rendering them as transparent isosurfaces occludes the structures. Instead, ImageSurfer uses color to display concentrations of the second data set on an isosurface extracted from the first.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Rendering Techniques</head><p>Preliminary attempts using several popular standard volume rendering techniques revealed the difficulty of displaying our 3D scalar field data sets in a manner that makes their correlation comprehensible. Arbitrary slices and stacks of slices through the data can display 2D regions and gradients well, but do not show how the data in the slices relates to the 3D structures; whether the gradient points into or out of the slice is not clear.</p><p>Maximum intensity projection (MIP) reveals hidden "hot spots" of density, but is completely ambiguous about the depth of those spots with respect to each other and other structures.</p><p>The dendritic spines curve and have thinner neck regions and larger head regions and are thus highly anisotropic. Consequently, direct volume rendering (DVR) with opacity accumulation along rays away from the viewer either produces fuzzy and indistinct forms whose shapes are difficult to determine <ref type="figure" target="#fig_3">(Figure 2</ref>) or else produces unlit surface-like displays in which it is difficult to resolve due to occlusion <ref type="figure" target="#fig_8">(Figure 7a)</ref>.</p><p>While displaying isosurfaces of the data volume produces easily-understood external structure extraneous biological features and splotches of light from the PMCA in the dendritic spine data caused occlusion of most of the volume and hid the regions of interest. Gradient-based illumination and surface density based on volume gradients that mix isosurface-like and DVR-like displays fall prey to the same difficulties.  Zoomed in view of a dendritic spine (blue box in 2a).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">IMAGESURFER VISUALIZATION SYSTEM</head><p>This section describes the current state of ImageSurfer, the lessons learned from user feedback during implementation and design, and specific details of the implementation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1">Current Design</head><p>ImageSurfer provides three visualization methods, each tailored to suit a specific user need:</p><p>1. 3D colored isosurface <ref type="figure" target="#fig_5">(Figure 3</ref>): displays a 3D view of the data sets and meets the first tool goal, relating concentrations of PMCA to the structure of dendrites.</p><p>2. 2D height field <ref type="figure" target="#fig_6">(Figure 4</ref>): displays data from a small, arbitrary, user-defined slice of the volume that is extracted from the data sets with the 2D slice extractor tool, reducing the dimension. The PMCA data is shown as a height field rendering and the height field color is derived from the DiO data, representing the structure. This visualization method meets the second goal, understanding the variation of PMCA within a structurally relevant region.</p><p>3. 1D line plot ( <ref type="figure" target="#fig_7">Figure 5</ref>): displays a graph of the DiO and PMCA concentrations sampled from the data sets along a user-defined spline, further reducing the dimension. Besides confirming the quantitative accuracy of the visualization system, this enables the scientists to effectively study the distribution of DiO and PMCA.</p><p>A 2D control window supplies a graphical user interface for setting options and commands for the visualizations. Most options are configurable using slider, menus, drop down lists, list boxes, and text boxes. The interface includes functions to edit, load, and save data sets as well as functions to set the color and opacity of volumes and the color of surfaces. By defining voxel dimensions and a region of interest, a user enables the system to scale and clip the rendering. Users can annotate the view by setting labels on graphics. After setting the rendering parameters, a user can direct the system to save images from the windows, either individually or as a series of images for animation.</p><p>The specialized colored isosurface interface shown in figure 3 directly reveals the PMCA concentration across the dendrite surface and removes the crippling occlusion caused by the large amount of PMCA found outside the dendrites. This technique uses structures from one data set to sample the concentrations in the other, and thus provides an overview ( <ref type="figure" target="#fig_5">Figure 3a)</ref> and a qualitative display of the correspondence between the two data sets within the volume <ref type="figure" target="#fig_5">(Figure 3b</ref>). Several design iterations highlighted the difficulty of displaying two volume data sets in a manner that showed relevant information not occluded by stray PMCA. The final design shown here renders an isosurface of the DiO pseudo-colored by the concentration of PMCA. This colored isosurface uses an isoluminant single-ended saturation map, where decreasing saturation indicates increasing PMCA concentration. Isoluminance is chosen to preserve surface shape information coming from lighting. Saturation was chosen because it is perceptually ordered and continuous. To enable interactive response time on a standard laboratory computer, when exploring the colored isosurface, we use VTK's decimation algorithm for reducing the number of points for generating the isosurface.    <ref type="figure" target="#fig_5">Figure 3b</ref>.</p><p>The colored isosurface shown in <ref type="figure" target="#fig_5">Figure 3</ref> provides a view of the dendrites created from the DiO data set as a surface extracted using VTK's marching cubes algorithim. The confocal microscope file contains information about the relative voxel size in x, y, and z; the system uses this to render a properly-scaled surface and to label axes. Within this window, the user can scale, rotate, and zoom the viewpoint using a mouse or a six-degree-of-freedom (6DOF) tracking device.</p><p>A rectangular planar region is specified within the volume display using a custom built 2D slice extractor. The slice extractor resembles a plane that the user can move, rotate, and scale within the colored isosurface display using a mouse or a 6DOF tracking device. The user positions the slice extractor across a dendritic spine parallel to its principal axis, reducing the dimension of the data. This enables the use of well-known 2D visualization techniques, color and height fields, to display the data in the region of the spine. Selecting a 2D plane instead of a 3D region provides an easily understoond view of the PMCA in relation to its location within a dendrite.</p><p>The 2D height field display shown in <ref type="figure" target="#fig_6">Figure 4</ref> provides a regular resampling of the volume data within the region covered by the 2D slice extractor tool in <ref type="figure" target="#fig_5">Figure 3b</ref>. It provides a display of how PMCA concentration varies within and around a dendritic spine, supplementing the surface correspondence shown in the 3D volume window.</p><p>The first design maintained the mappings from the 3D window, with DiO shown as height difference and PMCA shown as color. Although this maintained a consistent mapping, well-known limitations in the visual perception of color <ref type="bibr" target="#b13">[14]</ref> permitted only a very gross estimate of concentration. Because PMCA concentration is of primary interest and DiO only shows the boundary of the spine, the mapping was reversed. This enables more accurate perception the concentration variation and enables small local variation to be seen within overall structure; mountains represent high concentrations, and valleys represent low concentrations. A bi-valued color map clearly indicates the outline of the spine, setting the frame for analysis.</p><p>The spline tool is shown in <ref type="figure" target="#fig_7">figure 5</ref>. This spline is specified in the height field display and samples concentrations that lie along a curve. The mouse is used to position the spline's control points, shown as gray balls, thus defining the spline. The control points are restricted to a plane positioned below the height field. These concentrations then are displayed in the line plots shown in <ref type="figure" target="#fig_7">Figure  5b</ref>. The plot window offers users an even more restricted view of the region. ImageSurfer samples intensities along the spline and displays a graph of the two data sets as seen in <ref type="figure" target="#fig_7">Figure 5b</ref>.</p><p>The user interacts with the system in several stages to explore the data space and position the various widgets to properly reduce the data from 3D to 2D and finally 1D. <ref type="figure">Figure 6</ref> diagrams the interaction pipeline.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2">Lessons Learned</head><p>Using VTK facilitated rapid generation of functioning visualization prototypes that the scientists could evaluate on actual experimental data sets. User testing of early prototypes eliminated a number of less useful visualization tools:</p><p>•</p><p>Displaying PMCA density throughout the volume obscured the view of the dendritic spines, whether it was done using volume rendering or isosurface rendering as shown in <ref type="figure" target="#fig_8">Figure 7</ref>. This was especially true from (a) (b) viewpoints that looked through the narrow slab at the sides of the dendrites. This led us to split the view of the data into a side-by-side display of a volume rendering of only the DiO, and a height field of only the PMCA, sampled using the slice extractor.</p><p>• Understanding the correspondence between dendrites and PMCA was hindered by a side-by-side display of the two data sets, due to insufficient common features. This led us to color the height field of the PMCA according to the concentration of DiO as described in Section 6.1, thus showing structure to provide a reference for the PMCA concentrations.</p><p>• Blurring of the data during compositing hindered the usefulness of direct volume renderings of the DiO data, resulting in indistinct membrane boundaries. Because the goals for the tools require that the structure of the dendrites be clear, this led us to choose instead an isosurface rendering technique.</p><p>• Enabling the users to obtain data for quantification is useful for their research. This led us to develop the spline widget to provide quantitative data and graphs.</p><p>• Providing a user-friendly method for manipulating the slice extractor proved much harder than expected, since it was difficult to position the plane in a 3D volume using the 2D mouse. This led us to incorporate a 6DOF <ref type="figure">Figure 6</ref>: Interaction pipeline; two data sets are used to generate the colored isosurface, the slice extractor positioned over a spine generates a height field, and a spline tool is used to generate a plot along the spine center.</p><p>tracking and button device to enable a user to translate and rotate the slice extractor naturally with respect to the volume data and to change the viewpoint easily to evaluate placements.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.3">Implementation</head><p>We chose to use Fred Brooks' "driving problem" methodology for tool development. This approach is based on the belief that a tool that completely solves one or two specific problems is likely to be of broader usefulness than a generic tool that is not optimized for any particular problem.</p><p>This approach requires an understanding of the available techniques and questions being asked, the characteristics of the human visual system, and the characteristics of the data sets. We used an iterative design process between users and developers, in which users provide feedback early and often in the design process.</p><p>To enable rapid development of working prototypes, we decided to use pre-written packages. By developing the user interface in Java, we were able to use an object-oriented approach in an interpreted language, enabling rapid integration of suggestions from the users, including implementation of new features. We chose VTK as a rendering library because we were most familiar with it and its pipeline model. Segments of the pipeline were added, modified, or replaced as needed with only minor changes to other neighboring segments. The tremendous number of pre-built visualization components offered by VTK and the excellent VTK community support also aided in rapidly developing and testing versions of the visualization. Several other toolkits such as Open Inventor <ref type="bibr" target="#b7">[8]</ref> and VisAd <ref type="bibr" target="#b14">[15]</ref> are also available.</p><p>ImageSurfer uses Java Swing for user interface design, and the Virtual Reality Peripheral Network (VRPN) library <ref type="bibr" target="#b15">[16]</ref> to communicate with a six-degree-of-freedom tracking and button device. All figures were generated on a Windows-based PC (1.8 GHz processor, 512 MB RAM, nVidia GeForce3 graphics processing unit).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">FEEDBACK</head><p>Frequent meetings with the users ensured that the visualization system progressed towards the fulfillment of their needs. The colored isosurface enables the users to immediately spot spines that have PMCA accumulations (not all spines do). In their original method of exploring the data, the users would alternate between an image of DiO and an image of PMCA, tediously comparing positions of PMCA and spines. The users found that the current technique of coloring the dendrite based on the concentration of PMCA permits rapid understanding of PMCA organization. Because this proves to be a particularly effective way to portray its distribution, the users included images of the colored isosurface in a presentation at the Sixth IBRO World Congress of Neuroscience <ref type="bibr" target="#b16">[17]</ref>.</p><p>Cutting 2D slices from dendrites from any angle proved to be very useful. In our users' original method of alternating between images to explore spines, only 4-5 dendritic spines were aligned in the z plane; our custom-built slice extractor allows the scientists to explore spines at any orientation, drastically increasing the number of useable dendrites in each data set.</p><p>The use of height to display concentration values proved very useful for users. Traditionally, they have relied on comparing color values to determine relative concentrations of proteins. Our approach allows the scientists to compare heights, an easier task for the human visual system. More accurate qualitative conclusions about the concentration and location of PMCA are possible using this alternative technique than using color alone.</p><p>Although it was not anticipated by the implementers, the users indicated that the ability to set the point about which rotations and zooming occur in the colored isosurface window turns out to be particularly valuable. After setting this point, users can explore the visualization by zooming to particular spines and rotating about the spine, rather than the defaulted center of the visualization. This enables easy movement from an overview of the dendrites to a focused view of a spine; by viewing the selected spine from different angles, it becomes possible to understand the shape of the dendrite and the distribution of the PMCA concentrations around the spine.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8">ROADMAP FOR FUTURE WORK</head><p>The existing tool both decreases the time needed to study spines by an order of magnitude and greatly increases the amount of useful data that can be extracted from a single confocal image stack, by enabling the scientists to explore more spines than before. These are the first steps toward the goal of determining significant relationships over a large population of spines. We are currently iterating to determine the most useful statistical measurement to make along the spline (point-sampled data vs. area averages vs. volume averages vs. averages along discs on the membrane surface). The system will export the resulting values in formats accessible to standard analysis tools, along with context snapshots showing where the data was collected.</p><p>We plan to extend ImageSurfer to facilitate understanding of the relationship between mucus and cilia in cystic fibrosis (CF) patients. We discussed the possibility of using 3D visualizations to provide new insight into confocal data sets with researchers at the University of North Carolina Cystic Fibrosis Center. They were skeptical that ImageSurfer would provide any advantages to their existing 2D axis-aligned display and analysis tools. However, when shown the isosurface shown in <ref type="figure">Figure 8</ref> (where both the mucus and cilia were dyed with the same flurophore), the reaction from the scientists was immediate and emphatic: if we could produce the same type of display from a two-fluorophore data set, they would be able to answer a long-standing question about whether the mucus flattens the cilia like a mat, or instead intermingles with the cilia. This question is important to understanding how lung clearance breaks down in CF. We have now designed this capability into the tool, and they are preparing suitable specimens to scan.</p><p>We anticipate that the 2D slice extractor will be used to cut through the 3D data set at various orientations to capture instances of interdigitations or to show that there are none. The 1D spline widget will be used to measure the radius of each cilia "finger" that penetrates the mucus and to measure the height of these fingers. <ref type="figure">Figure 8</ref>: Surface rendering of a CF data set taken with a single fluorophore. The lower surface shows groups of cilia extruding from cells; the upper surface forms the mucus sheet.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="9">AVAILABILITY</head><p>This software is available for download from the ImageSurfer web site at http://www.imagesurfer.org. The download includes an installer for Windows and an HTML-based user manual.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>October 10 -</head><label>10</label><figDesc>15, Austin, Texas, USA IEEE Visualization 2004 0-7803-8788-0/04/$20.00 ©2004 IEEE</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 :</head><label>1</label><figDesc>The Spanish neurohistologist Santiago Ramon y Cajal (1852-1934) won a Nobel Prize for his studies of neurons, including the discovery of dendritic spines. (a) Drawings of neurons from Cajal's work: Red arrowhead: dendrite; thick arrow: cell body (with nucleus); thin arrow: axon. (b) Close-ups, showing dendritic spines [3].</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 2 :</head><label>2</label><figDesc>(a). Direct volume rendering of DiO data set. (b).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 3 :</head><label>3</label><figDesc>(a) Surface rendering enclosed by axes of the DiO data set reveals the structure of the dendrites, colored by PMCA concentration, where white is a high concentration and red is low. (b) Zoomed-in view of a dendritic spine (blue box in 3a). Positioned through the spine is a white plane that represents the slice extractor.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 4 :</head><label>4</label><figDesc>Height field of PMCA values sampled from the volume data specified by the position of the slice extractor in</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 5 :</head><label>5</label><figDesc>(a) Spline widget and slice colored by DiO of the same spine in Figure 4. (b) PMCA and DiO concentration plotted from data collected along the spline. PMCA is represented by the blue line and DiO by the red line.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 7 :</head><label>7</label><figDesc>(a) Volume renderings of the DiO and PMCA data sets. (b) Isosurface renderings of the DiO and PMCA data sets. In both images the DiO is colored red and the PMCA is yellow.</figDesc></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="10">ACKNOWLEDGEMENTS</head><p>Development of ImageSurfer was supported by the National Institutes for Health with grant awards NS44306 (from the National Institute of Neurological Disorders and Stroke) and EB002025 (from the National Institute for Biomedical Imaging and Bioengineering). It was developed within the National Research Resource for Computer-Integrated Systems for Microscopy and Manipulation. We would like to thank Mary Whitton and Alvin Richardson for valuable feedback.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">Principals of neural science</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Kandel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">H</forename><surname>Schawartz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">M</forename></persName>
		</author>
		<imprint>
			<date type="published" when="2000" />
			<publisher>Health Professions Division</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Ca(2+) signaling in dendritic spines</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">L</forename><surname>Sabatini</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Maraval</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Svoboda</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Current Opinion in Neurobiology</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="349" to="356" />
			<date type="published" when="2001-06" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Overview on the structure, composition, function, development, and plasticity of hippocampal dendritic spines</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">E</forename><surname>Sorra</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">M</forename><surname>Harris</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hippocampus, volume</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="501" to="511" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title level="m" type="main">Introduction to Confocal Microscopy: Basic Concepts</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">W</forename><surname>Davidson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">J</forename><surname>Fellers</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">W</forename><surname>Paddock</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title level="m" type="main">The Visualization Toolkit User&apos;s Guide</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Inc</forename><surname>Kitware</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2003" />
			<publisher>Kitware, Inc publishers</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>User's Guide</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Amira</forename><surname>Homepage</surname></persName>
		</author>
		<ptr target="http://www.amiravis.com/" />
		<title level="m">3D Data Visualization</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">An object-oriented 3D graphics toolkit</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">S</forename><surname>Strauss</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Carey</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 19th Conference Annual Conference on Computer Graphics and Interaction Techniques</title>
		<meeting>the 19th Conference Annual Conference on Computer Graphics and Interaction Techniques</meeting>
		<imprint>
			<publisher>ACM Press</publisher>
			<date type="published" when="1992-07" />
			<biblScope unit="page" from="341" to="349" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">VisBio: a biological tool for visualization and analysis</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Hibbard</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ACM SIGGRAPH Computer Graphics</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page" from="5" to="7" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Interactive Volume Rendering Using Multi-Dimensional transfer Functions and Direct Manipulation Widgets</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kniss</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Kindlmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Hansen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Conference on Visualization &apos;01</title>
		<meeting>the Conference on Visualization &apos;01</meeting>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="2001" />
			<biblScope unit="page" from="255" to="262" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Case study: cellular scaffold extraction using crest point for volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Hu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">D</forename><surname>Baluch</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Razdan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">M</forename><surname>Nielson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">E</forename><surname>Farin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">G</forename><surname>Capco</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Symposium on Data Visualization 2003</title>
		<meeting>the Symposium on Data Visualization 2003</meeting>
		<imprint>
			<date type="published" when="2003" />
			<biblScope unit="page" from="123" to="128" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Visualization of time dependent confocal microscopy data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><forename type="middle">C</forename><surname>De Leeuw</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Van Liere</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">J</forename><surname>Verschure</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Van Driel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">E</forename><surname>Visser</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">M M</forename><surname>Manders</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Conference on Visualization &apos;00</title>
		<meeting>the Conference on Visualization &apos;00</meeting>
		<imprint>
			<publisher>IEEE Computer Society Press</publisher>
			<date type="published" when="2000" />
			<biblScope unit="page" from="473" to="476" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Three dimensional visualization of proteins in cellular interactions</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">R F</forename><surname>Monks</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">J</forename><surname>Crossno</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Davidson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Pavlakos</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kupfer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Silva</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Wylie</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 7th Conference on Visualization &apos;96, IEEE Visualization</title>
		<meeting>the 7th Conference on Visualization &apos;96, IEEE Visualization</meeting>
		<imprint>
			<publisher>IEEE Computer Society Press</publisher>
			<date type="published" when="1996" />
			<biblScope unit="page">363</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title level="m" type="main">Information Visualization: Perception for Design</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Ware</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2000" />
			<publisher>Academic Press</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">VisAD: Connecting people to computations and people to people</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Hibbard</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ACM SIGGRAPH Computer Graphics</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="10" to="12" />
			<date type="published" when="1998-08" />
			<publisher>ACM Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">VRPN: A Device-Independent, Network-Transparent VR Peripheral System</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">M</forename><surname>Taylor</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">C</forename><surname>Hudson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Seeger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Weber</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Juliano</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">T</forename><surname>Helser</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the ACM Symposium on Virtual Reality Software and Technology, Virtual Reality Software and Technology</title>
		<meeting>the ACM Symposium on Virtual Reality Software and Technology, Virtual Reality Software and Technology</meeting>
		<imprint>
			<publisher>ACM Press</publisher>
			<date type="published" when="2001" />
			<biblScope unit="page" from="55" to="61" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Organization of the plasma membrane calcium pump</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Weinberg</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">E</forename><surname>Strehler</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Burette</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Sixth IBRO World Congress of Neuroscience</title>
		<meeting><address><addrLine>Prague, Czech Republic</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
