<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Lattice-Based Volumetric Global Illumination</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2007-10-27">27 October 2007</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Feng</forename><surname>Qiu</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Fang</forename><surname>Xu</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zhe</forename><surname>Fan</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Neophytou</forename><surname>Neophytos</surname></persName>
							<email>nneophyt@cs.sunysb.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><roleName>Fellow, IEEE</roleName><forename type="first">Arie</forename><surname>Kaufman</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><roleName>Senior Member, IEEE</roleName><forename type="first">Klaus</forename><surname>Mueller</surname></persName>
							<email>mueller@cs.sunysb.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">•</forename><surname>Feng Qiu</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">Stony Brook University</orgName>
								<address>
									<postCode>11794-4400</postCode>
									<settlement>Stony Brook</settlement>
									<region>NY</region>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Lattice-Based Volumetric Global Illumination</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2007-10-27">27 October 2007</date>
						</imprint>
					</monogr>
					<note type="submission">received 31 March 2007; accepted 1 August 2007; posted online</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-20T19:46+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Volume visualization</term>
					<term>volume rendering</term>
					<term>participating media</term>
					<term>lattice</term>
					<term>FCC lattice</term>
					<term>sampling</term>
					<term>multiple scattering</term>
					<term>GPU</term>
				</keywords>
			</textClass>
			<abstract>
				<p>We describe a novel volumetric global illumination framework based on the Face-Centered Cubic (FCC) lattice. An FCC lattice has important advantages over a Cartesian lattice. It has higher packing density in the frequency domain, which translates to better sampling efficiency. Furthermore, it has the maximal possible kissing number (equivalent to the number of nearest neighbors of each site), which provides optimal 3D angular discretization among all lattices. We employ a new two-pass (illumination and rendering) global illumination scheme on an FCC lattice. This scheme exploits the angular discretization to greatly simplify the computation in multiple scattering and to minimize illumination information storage. The GPU has been utilized to further accelerate the rendering stage. We demonstrate our new framework with participating media and volume rendering with multiple scattering, where both are significantly faster than traditional techniques with comparable quality.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>transport in volumes, which includes multiple scattering. Blinn <ref type="bibr" target="#b1">[2]</ref> has analytically solved the transport equation for constant density medium with single scattering. Kajiya and von Herzen <ref type="bibr" target="#b16">[17]</ref> have proposed tracing rays in inhomogeneous volumes. To calculate multiple scattering, spherical harmonics have been used. Radiosity uses finite element methods to solve the transport equation. Rushmeier and Torrance <ref type="bibr" target="#b26">[27]</ref> have exploited the zonal method for isotropic scattering. Max <ref type="bibr" target="#b19">[20]</ref> has extended the discrete ordinates method to capture anisotropic multiple scattering. Hegeman et al. <ref type="bibr" target="#b13">[14]</ref> have proposed a two-pass approach for strong forward scattering. Harris and Lastra <ref type="bibr" target="#b12">[13]</ref> have used a similar approach to render clouds. Kniss et al. <ref type="bibr" target="#b17">[18]</ref> have introduced a volume lighting model for GPU-accelerated volume rendering with forward scattering using a single pass algorithm based on half angle slicing. Riley et al. <ref type="bibr" target="#b25">[26]</ref> have extended this method to render atmospheric phenomena. Jensen <ref type="bibr" target="#b15">[16]</ref> has presented the photon mapping method for rendering participating media. Cerezo et al. <ref type="bibr" target="#b2">[3]</ref> have provided a nice survey on rendering participating media. Finally, Geist et al. <ref type="bibr" target="#b11">[12]</ref> have revised the Lattice-Boltzmann method to render participating media.</p><p>In this paper, we describe a new volumetric global illumination framework, which exploits both spatial and angular discretization on lattices. In computer graphics, spatial discretization has been wellstudied to simplify the calculation of light-object interaction, but angular discretization has not been fully exploited. Specifically, we adopt the FCC lattice because it has better sampling efficiency compared with the CC lattice and it provides optimal angular discretization among all lattices. We further describe a new two-pass algorithm to render participating media and volumes with multiple scattering. The idea of this algorithm is that the traced photons only move along the lattice links. We call these photons "diffuse photons". Here, the phase function is discretized on the lattice links to simplify the diffuse photon tracing and radiance estimation. The storage of diffuse photons is minimized by storing the number of photons on lattice links. For flexibility and extensibility, we also implemented tracing photons with accurate direction, which are called "specular photons" in this paper. The O-Buffer data structure proposed by Qu et al. <ref type="bibr" target="#b24">[25]</ref> has been exploited to reduce the storage space of specular photons. Our volumetric global illumination framework is capable of producing high quality images and is significantly faster than traditional methods. This general and flexible framework can be extended to render hybrid scenes with both volumes and surface objects.</p><p>Our paper is structured as follows. The definition and mathematical properties of FCC lattices are explained in Section 2. Section 3 analyzes the sampling scheme on FCC lattices. Section 4 and 5 present the rendering methods and implementation details, respectively. The rendering results are shown in Section 6. Finally, we conclude the paper and describe future work. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">FCC LATTICE</head><p>An FCC lattice consists of simple CC cubic cells with additional sampling points located at the center of each cell face (see <ref type="figure" target="#fig_1">Fig. 1a</ref>). According to the lattice definition described in Section 1, any FCC lattice site can be constructed via linear combination of the three basis vectors X = (1, 0, 0), Y = (0, 1, 0) and Z = (0.5, 0.5, √ 2/2), which can be obtained by defining an appropriate rotated coordinate system (see <ref type="figure" target="#fig_1">Fig.  1b</ref>). This definition scheme is adopted in our paper due to its simplicity, where the FCC lattice can be decomposed into two interleaved sub cubic lattices with a deviation vector of v = (0.5, 0.5, √ 2/2). This representation provides a framework that enables quick indexing and efficient implementation of many basic lattice operations. For instance, the mapping from an arbitrary FCC lattice site of index (i, j, k) to its CC coordinates (x, y, z) can be defined by the following equations:</p><formula xml:id="formula_0">x = i + (k mod 2)/2, y = j + (k mod 2)/2, z = √ 2k/2.<label>(1)</label></formula><p>Finding the nearest FCC lattice site to a sample point can be implemented by first looking for two neighbors having the shortest Euclidean distance to the sample point in the two sub cubic lattices using Eqn. 1, and then selecting the closer one between them. The geometric layout of the FCC lattice also gives rise to its higher angular discretization granularity than both CC and body-centered cubic (BCC) lattices, which is important for our rendering framework. Each site in the FCC lattice has direct links to a total of 12 nearest neighbors, in contrast to 8 and 6 in the BCC and CC lattices, respectively. This is the best angular discretization rate that any 3D regular lattice can achieve, since in R 3 the maximum number of sphere of radius 1 that can simultaneously touch the unit sphere (i.e., the kissing number) is 12 <ref type="bibr" target="#b5">[6]</ref>. This unique feature has important implications for sampling and interpolation, as we will discuss further below. For example, when a particle is scattered at an FCC lattice site, it has 12 possible moving directions, which is 50% more than a BCC lattice and 100% more than a CC lattice. In addition, the 12 links of an FCC lattice site are symmetric under rotation and reflection, which supports a relatively simple computation framework. <ref type="figure" target="#fig_2">Fig. 2a</ref> shows the cuboctahedron defined by the 12 closest neighbors of a FCC site, while <ref type="figure" target="#fig_2">Fig.  2b</ref> shows the Voronoi cell of an FCC lattice site, which is essentially a rhombic dodecahedron.</p><p>Finally, the reciprocal lattice of FCC yields its representation in the frequency domain, which is essentially a BCC lattice <ref type="bibr" target="#b28">[29]</ref>. As it will be described in the next section, this property gives rise to its nearoptimal sampling behavior that is capable of reconstructing original signals with a minimum number of samples. It has been shown in the literature <ref type="bibr" target="#b28">[29]</ref> that the FCC sampling scheme requires 13.4% and 23% fewer samples in R 2 and R 3 domain compared to CC lattices, respectively. Thus, the FCC lattice presents a much more efficient spacial sampling scheme over the traditional CC lattice.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">SAMPLING ON FCC</head><p>In any lattice used for volume visualization, the lattice sites are discretized or sampled from R n , and an efficient, preferably optimal, sampling scheme is paramount. An optimal lattice structure captures information in the hyper-volume R n using the least number of sampling points. Assuming an isotropic and band-limited sampling function, the resulting frequency support of a sampling point is a hyper-sphere, surrounded by a set of alias replicas. Hence, the most efficient sampling scheme arranges the replicated (hyper-spherical) frequency response as densely as possible in the frequency domain to avoid overlapping of the aliased spectra. As demonstrated in multi-dimensional signal theory <ref type="bibr" target="#b7">[8]</ref> an optimal sampling scheme is obtained when the frequency response of the sampling lattice is an optimal sphere packing lattice <ref type="bibr" target="#b5">[6]</ref>. Optimal sampling lattices can achieve up to 13.4%, 29.3%, and 50% of savings in 2, 3 and 4 dimensions, and they have been used in volume visualization <ref type="bibr" target="#b9">[10,</ref><ref type="bibr" target="#b21">22,</ref><ref type="bibr" target="#b28">29]</ref> with high quality image results. In three dimensions there are infinite optimal sphere packings including the FCC lattice and the HCP (hexagonal closed packing). The spatial equivalent of the FCC lattice in the frequency domain is the BCC lattice, which is the inverse Fourier transform of the FCC and vice-versa. The FCC lattice in the spatial domain corresponds to the BCC lattice in the frequency domain which is not an optimal sphere packing, and the FCC lattice achieves about 23% of savings over the CC lattice in terms of sampling efficiency. It was chosen for our global illumination framework because it is the lattice that maximizes uniform angular discretization with its kissing number of 12. The HCP is another candidate with an optimal kissing number of 12. In strict mathematical definition, HCP is not a lattice but can be defined as the union of the lattice L with generation vectors (1, 0, 0), (1/2, √ 3/2, 0) and (0, 0, 8/3) and the translate L + (1/2, 1/ √ 12, 2/3). However, it has a bias towards the z-direction. For any link with direc-</p><formula xml:id="formula_1">tion d = (d x , d y , d z ) such that d z = 0, the link of direction −d does not exist.</formula><p>When a ray or photon moves from one of such links and is not absorbed or scattered at the lattice site, it cannot continue straight along its original direction. Therefore, HCP is not symmetric and thus unsuitable for use in our framework.</p><p>Given the initial assumption that the represented function is hyperspherically band-limited, the ideal choice for the reconstruction function is also a radially symmetric kernel. We have studied a set of Gaussian reconstruction filters and have found that the relatively narrow Gaussian f (r) = e −2r 2 , offers good frequency behavior and reasonable overlap between neighboring sites. We have also tested this experimentally by reconstructing a constant cubic volume (where f (x, y, z) = 1) sampled on an FCC lattice and measuring the mean squared error for varying reconstruction kernel extents.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">RENDERING METHODS</head><p>There are three major processes for the interaction between light and volumetric objects: emission, absorption and scattering. The differential equation <ref type="bibr" target="#b20">[21]</ref> of light propagation in volumetric objects is</p><formula xml:id="formula_2">dI(x, ω) ds = −σ t (x, ω)I(x, ω) + σ e (x, ω) + σ s (x, ω) 4π f (x, ω, ω )I(x, ω )dω<label>(2)</label></formula><p>where I(x, ω) is the light intensity at position x in direction ω, σ t is the extinction or attenuation coefficient (combination of absorption and out-scattering, σ t = σ a + σ s ), σ s is the scattering coefficient or the scattering probability per unit distance. f (x, ω, ω ) is the phase function representing the conditional probability of a photon from direction ω to be scattered in direction ω assuming that the photon is scattered, and it obeys 4π f (x, ω, ω )dω = 4π. In most naturally occurring media, σ t and σ s are independent of direction ω. Also, most media is isotropic and the phase functions only depend on the cosine of the angle θ between ω and ω . The solution of Eqn. 2 is:</p><formula xml:id="formula_3">I(x, ω) = D 0 R(x − sω, ω)exp D 0 σ t (x − tω)dt ds, (3) R(x, ω) = σ s (x, ω) 4π f (x, ω, ω )I(x, ω )dω (4)</formula><p>where D is the distance from x to the view point and R(x, ω) is the radiance at position x from direction ω.</p><p>We describe a new two-pass rendering algorithm on FCC lattices. In the first pass, photons are emitted from light sources and the photon energy is distributed in the scene, illuminating the media. In the second pass, a ray tracing method is used to generate the final image. At each sampling point x on the ray of direction −ω, the radiance R(x, ω) is estimated by the photons in a small neighborhood of x for shading.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Diffuse Photon Tracing</head><p>For volumetric objects where the dominant effect is diffusion, we have developed a new algorithm to trace photons on the lattice links. The volumetric objects are sampled in a finite region of the FCC lattice. As shown in <ref type="figure" target="#fig_3">Fig. 3</ref> on a 2D FCC lattice, when a photon is emitted from a light source, the nearest lattice site to the first hit point on the lattice boundary is calculated and the moving direction of the photon is discretized to one of the link directions. The photon will be traced on the links between lattice sites and its path is composed of line segments of lattice links. A photon emitted from the light sources has an arbitrary direction ω. We first convert the photon direction stochastically to one of the lattice links. An FCC lattice site x i has 12 closest neighboring sites of equal distance, which forms a cuboctahedron as shown in <ref type="figure" target="#fig_2">Fig. 2a</ref>. The ray originated from site x i with direction ω intersects the cuboctahedron at point v on one of its 14 faces. Denoting the vertices of the face</p><formula xml:id="formula_4">containing v as v 0 , v 1 , ••• , v m (m = 2,</formula><p>3) in counterclockwise order and letting ω k = v k − x i , the probability of the photon direction changing to ω k is defined as the barycentric coordinates <ref type="bibr" target="#b10">[11]</ref>:</p><formula xml:id="formula_5">p k = w k ∑ k w k , w k = ∏ t =k−1,k A(v, v t , v t+1 ) (5)</formula><p>where</p><formula xml:id="formula_6">A(v, v t , v t+1 ) is the area of triangle v, v t , v t+1 .</formula><p>The barycentric coordinates of v are well defined with Eqn. 5 because all the faces of the cuboctahedron are regular polygons. When arriving at a lattice site x i from direction ω j the photon might be absorbed, be scattered or continue moving along the extended link of ω j . We use the absorption and the scattering coefficients, σ a (x i , ω j ) and σ s (x i , ω j ), to represent the probabilities of such events. (Please note that this approximation is only correct when the link length l is small compared to 1/σ t . The actual absorption probability should be exp(− l 0 σ a (x i , ω j ))ds. Because the links on an FCC lattice are of identical length, we use σ a , σ s and σ t here for convenience.) The Russian roulette technique <ref type="bibr" target="#b22">[23]</ref> is used to determine whether the photon is absorbed, scattered or transmitted. In detail, the program generates a random number ξ ∈ [0, 1) and the photon:</p><formula xml:id="formula_7">⎧ ⎪ ⎨ ⎪ ⎩ is absorbed if ξ ∈ [0, σ a (x i , ω j )), is scattered if ξ ∈ [σ a (x i , ω j ), σ a (x i , ω j ) + σ s (x i , ω j )), is transmitted if ξ ∈ [σ a (x i , ω j ) + σ s (x i , ω j ), 1). (6)</formula><p>In contrast to the deterministic procedures of absorption and transmission, stochastic scattering requires further processing. In traditional methods, a phase function f (x, ω, ω ) is utilized to describe the probability of a photon being scattered at location x with an input direction ω and an output direction ω . The computation of the new direction is performed using importance sampling. In the widely used models such as the Schlick model <ref type="bibr" target="#b0">[1]</ref>, the probability depends on cos(θ ) = ω • ω only, thus the importance sampling returns the value of cos(θ ). In order to compute ω , a local coordinate system at the scattering position has to be constructed to convert spherical angles to direction vectors, which is computationally expensive.</p><p>In our lattice illumination framework, the computation of the scattering process is greatly simplified because photons only move along discretized lattice links. Here, the continuous phase function f (x, ω, ω ) is discretized to f (i, j, k), which represents the probability of a photon located at site x i being scattered from the input link ω j to the new output link ω k . In practice, this discrete phase function is constructed as a 2D table of n × n resolution to represent all possible combinations of input/output links on a lattice site (n = 12 for FCC lattices). The generation of the discrete phase function via sampling and normalizing the continuous phase function is described by the following equation:</p><formula xml:id="formula_8">f (i, j, k) = f (x i , ω j , ω k ) ∑ n−1 t=0 f (x i , ω j , ω t ) .<label>(7)</label></formula><p>A more accurate method is to calculate the integral over the angular space Ω defined in Eqn. 8, which can be solved numerically for arbitrary continuous phase function:</p><formula xml:id="formula_9">f (i, j, k) = Ω closest(ω, ω k ) f (x i , ω j , ω)dω closest(ω, ω k ) = 1 if the closest link to d is ω k , 0 otherwise.<label>(8)</label></formula><p>Importance sampling of discrete phase functions is simply a binary search for a given random number ξ such that</p><formula xml:id="formula_10">∑ k t=0 f (i, ω j , ω t ) ≤ ξ and ∑ k+1 t=0 f (i, ω j , ω t ) &gt; ξ .</formula><p>The complexity of this binary search is O(log(n)), which is very efficient because n is usually very small (n = 12 for FCC lattices). After determining the photon behavior of each encounter, we record their activity information on the lattice sites. Basically, a stored photon represents a possible light path from the light sources to its location. This information is used in the following rendering pass, where the irradiance of sampling positions is estimated with the stored light paths within a small neighborhood. The lattice-based framework enables us to store photons in a 3D array and the position of the photons is implicitly defined by their index in the array. Moreover, the quantized directions are encoded in a byte using the link index. Since the link vectors are known a-priori, we adopt an optimized solution for photon direction storage, where photons with the same direction are grouped together. Here, a 1D array E(ω j ) of n elements is used for a lattice site x i , such that E(ω j ) is the total energy of the photons at x i with direction ω j . Due to the employed Russian roulette technique <ref type="bibr" target="#b22">[23]</ref>, the photon energy does not change until it is absorbed. Therefore, the stored photons all have the same energy and only the integral number of photons need to be stored at link (i, j). Given the maximum possible number of photons stored on the links, the unsigned byte or short format can be used to represent the actual photon counts instead of storing individual floating point energy values. In other words, we store all photons in a 4D integer array E(i, ω j ) with three dimensions of site position and one dimension for link direction.</p><p>After the recording of diffuse photons, rays are traced from the image plane into the FCC lattice to collect irradiance values. At each sampling point x, the radiance is estimated by the photons inside a small spherical region centered at x. With our 4D array of photon counts, the radiance in Eqn. 4 is calculated with the following simplified formula:</p><formula xml:id="formula_11">R(x, ω) = ∑ X ∑ j σ s (x, ω j ) f (x, ω, ω j )g(x − x)E(x , ω j )dx (9)</formula><p>where ω is the reverse ray direction, f is the continuous phase function and X is the set of lattice sites in the search region. g is a normalized smoothing filtering function used for removing high-frequency noise. Because the lattice sites are positioned regularly, searching for the lattice sites in a sphere is simple and efficient. In our experiments, the medium is isotropic and the phase function only depends on the angle between the ray direction and the lattice link ω j . The dot product of ω and ω j can be pre-computed and reused for all the sampling points on one ray in the rendering process, which yields an efficient implementation of the radiance estimation.</p><p>Our new algorithm greatly simplifies the computation of photonvolume interaction and photon storage. Therefore, our program can trace millions of photons in a short time, which is good for improving image quality by removing the stochastic noise and variance without excessive smoothing in the radiance estimation. Moreover, our method is general and can use arbitrary phase functions including those of strong backward scattering.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Specular Photon Tracing</head><p>The method described in Section 4.1 is capable of calculating multiple scattering events for participating media and volumes where diffusion is the dominant effect. However, specular reflection and refraction may exhibit ray effects when discretized rays hit smooth specular surfaces. This effect has been discovered by the radiative heat transfer community <ref type="bibr" target="#b3">[4]</ref> and found to be caused by the discretization of scattering directions when accurate directions are needed for specularity.</p><p>To mitigate this ray effect, we describe an enhanced algorithm called specular photon tracing, where every photon is associated with its accurate direction ω and start position x. In each time step, the photon moves on the FCC lattice and the new sampling position is calculated by x = d × ω where d is the step size. The lighting properties σ a and σ s are sampled to decide whether the photon is absorbed, scattered or transmitted at x (Eqn. 6). If the photon is scattered, the new direction ω is computed with the continuous phase function. The Russian roulette technique is again used to avoid photon energy change.</p><p>The O-Buffer data structure <ref type="bibr" target="#b24">[25]</ref> is used to store the photon information compactly, where each lattice site stores a sequence of photons in its Voronoi cell <ref type="figure" target="#fig_2">(Fig. 2b)</ref>. For each stored photon at position x, the nearest lattice site x i is computed and only the offset o from x to x i is stored. The offset o is quantized into 256 levels in each axis so that o can be compactly represented in 3 bytes. This 3-byte representation increases the photon position accuracy by 256 times of the lattice resolution, while it only needs 25% of the storage space of the traditional floating point representation. Because the search radius for the radiance estimation is usually much larger than the link length, it is good enough for most rendering applications. The Voronoi cell <ref type="figure" target="#fig_2">(Fig. 2b)</ref> of an FCC lattice site is a rhombic dodecahedron. Assuming a unit distance between neighboring sites, the distance from the lattice site to the vertices of its Voronoi cell is <ref type="table" target="#tab_0">√  2</ref> 2 . The maximum error introduced by this offset quantization scheme is</p><formula xml:id="formula_12">√ 3 2 • 1 255 • √ 2</formula><p>2 . For photon direction encoding, vectors ω are converted to spherical coordinates and represented with 2 bytes <ref type="bibr" target="#b14">[15]</ref>. Because the photon energy does not change, only one byte is used to record the color channel of the photon. In total, the storage space of one photon is just 6 bytes.</p><p>In the rendering pass, the radiance at each sampling point is estimated with the photons stored in the lattice photon O-Buffer. For a spherical search neighborhood S with radius r, the lattice sites in the sphere S of radius r + 2 . Then, the photons stored in these lattice sites are visited. If the distance to the sampling point x is larger than r, the photon is discarded. The radiance at x is summed over all the photons inside S with</p><formula xml:id="formula_13">R(x, ω) = E ∑ p σ s (ω p , x) f (x, ω, ω p )g(x p − x)<label>(10)</label></formula><p>where x p and ω p are the photon position and direction, respectively. The term E is the energy of the photon, which is the same for all photons since the Russian Roulette scheme is used. Our diffuse photon tracing algorithm is capable of tracing multimillion photons in seconds. With the FCC lattice, the photons move on the lattice links and are scattered only on the lattice sites. Therefore, the most time consuming steps in traditional methods such as sampling the lighting properties, calculating scattered directions with phase functions are greatly simplified. Its major disadvantage is the ray effect, which cannot be neglected in certain cases, for example, in reflection, refraction or scattering on specular surfaces, and hard shadows. The specular photon tracing solves this problem but is much slower.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">IMPLEMENTATION</head><p>We have implemented the algorithms described in Section 4 to render participating media and volumetric datasets. Since the reconstruction process in the current scanning modalities such as MRI and CT only produce rectilinear data, the FCC data we used are generated by resampling existing rectilinear volumes or voxelizing geometric objects. In the resampling process, a windowed sinc filter has been used to obtain optimal signal reconstruction quality.</p><p>We use the incremental triangle voxelization method <ref type="bibr" target="#b6">[7]</ref> to voxelize polygonal models to the FCC lattice. The original method was proposed for volumes of CC lattices, but the employed distance-based method enables its direct application to the FCC lattice.</p><p>For surface voxelization, the volume density of a lattice site p is determined by the distance between p and its closest triangle. Each triangle is processed in the following manner. For each lattice site p in the neighborhood of the triangle, the distance d between p and the triangle is computed. The distance d is positive if p is in the normal direction of the triangle, or negative if p is in the reverse direction. If |d| is smaller than the previously stored absolute value of the distance, |d| replaces the previous stored value and the density of p is updated with the following equation:</p><formula xml:id="formula_14">density = ⎧ ⎨ ⎩ 1 i f d &lt; −W, 0 i f d &gt; W, 0.5 × (1 − d W ) otherwise,<label>(11)</label></formula><p>where W is the width of the oriented box filter. While for a CC lattice the optimized width was estimated to be 2 √ 3 voxel units <ref type="bibr" target="#b6">[7]</ref>, we estimate that for an FCC lattice, the optimized width of the filter is decreased to 2 lattice units. Based on the surface voxelization result, the interior of the solid is voxelized using seed growing.</p><p>For inhomogeneous participating media, such as clouds and smoke, the absorption coefficient σ a (x) and scattering coefficient σ s (x) typically do not rely on the light direction, although our algorithm is capable of rendering anisotropic media. The volume data of the medium usually defines the density field ρ(x) of particles. We assume that the σ a (x) and σ s (x) are proportional to the local density ρ(x). For FCC lattices where the lattice links have unit lengths, it implies: σ a (x, ω j ) = σ a ρ(x), and σ s (x, ω j ) = σ s ρ(x). <ref type="bibr" target="#b11">(12)</ref> where σ a and σ s are user-defined scaling coefficients. In real world phenomena, most practical participating media are isotropic and the phase function f (x, ω, ω ) does not vary upon position x. In our implementation, f (x, ω, ω ) = f (ω • ω ) is described with the Schlick model <ref type="bibr" target="#b0">[1]</ref>. The participating medium is represented with an FCC lattice of densities and all the coefficients are calculated by scaling ρ(x).</p><p>Our algorithms support chromatic participating media, where the coefficients σ a (x, λ ) and σ s (x, λ ) are wavelength-dependent. We implement it by defining scaling factors of absorption and scattering in RGB channels. The photons emitted from the light sources can be red, green or blue randomly. The photon tracing program calculates σ a (x, λ ) and σ s (x, λ ) with proper scaling factors in the color channel of the traced photons. In the rendering pass, the opacity value α of a sampling point is the average extinction of those in three channels:</p><formula xml:id="formula_15">α = 1 3 (σ t (x, λ r ) d + σ t (x, λ g ) d + σ t (x, λ b ) d )<label>(13)</label></formula><p>where d is the step size. For general volume datasets, transfer functions have been exploited to define lighting properties from the density field. Some 2D transfer functions might also use the gradient information. Our framework is general and capable of integrating any transfer function as long as the input data (density, gradient or any other data) of the transfer function is defined on the lattice. In our current implementation, a 1D transfer function is defined for σ a and σ s in each RGB channel. Eqn. 13 can be used to compute the opacity α or a separate transfer function can be defined for α.</p><p>Following the photon tracing computation, a single-pass ray-casting approach is employed on the GPU to render the diffuse photon tracing results. We used an algorithm similar to <ref type="bibr" target="#b18">[19]</ref>, except that the sampled volume density is used for obtaining the scattered coefficient as well as transparency values to composite the final radiance results. Here, in addition to the density volume, an additional photon storage volume that records the diffuse photon distribution on each lattice site is sampled to composite ray values. Both the density and the diffuse photon volumes are FCC lattices, stored and indexed as described in Section 2. The diffuse photon storage table is essentially a 12-element array, each of which records the number of photons stored along 12 different lattice links. A two-byte unsigned short is allocated for each such node to provide a count of up to 65536. To compute the radiance estimation at each sampling point, dot-products of each lattice link with the current viewing ray are used to weight individual diffuse radiance value, which is given by indexing the photon distribution previously computed on the lattice. The 12 weighted values are then summed up to yield the final contribution. Filtering on all lattices uses the Gaussian kernel of size 2 and the sum is normalized at the end.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">RESULTS</head><p>We have implemented our algorithms on a 3.4GHz PC with 3GB memory and a Geforce 8800 GTX graphics card. All the resulting images are of 512 × 512 resolution and cropped in <ref type="figure" target="#fig_5">Figs. 4-8</ref>. <ref type="figure" target="#fig_5">Fig. 4</ref> demonstrates the rendering results of participating media with our algorithms. We use a single light of white color placed on top of the smoke dataset. <ref type="table">Table 1</ref> gives the times of different algorithms used to render the corresponding images.</p><p>In <ref type="figure" target="#fig_5">Fig. 4b</ref>, the eccentricity coefficient k of the Schlick phase function is set to 0.2. The absorption and scattering coefficients are σ a = 0.08 and σ s = 0.2, respectively. <ref type="figure" target="#fig_5">Fig. 4c</ref> uses the same coefficients except that the eccentricity k is −0.5 for strongly backward scattering. The photon tracing of 1 million photons and subsequent rendering passes cost about 11 and 48 seconds on the CPU, respectively. With GPU acceleration, the time of the rendering stage is reduced to 2.4s. This performance is significantly faster than the original photon mapping method <ref type="bibr" target="#b15">[16]</ref>, where the tracing 10K photons in a cloud model of similar size takes 8 seconds on an HP computer of 16 180MHz PA-8000 processors, while rendering a 1024 pixel wide image takes 92 seconds. Note that although a higher resolution is used in Jensen and Christensen's method <ref type="bibr" target="#b15">[16]</ref>, the complexity of the algorithms is mainly determined by the number of photons, of which our example generates 100 times more. A major further enhancement of our implementation can be achieved by incorporating empty space skipping or adaptive sampling techniques that are used by Jensen and Christensen <ref type="bibr" target="#b15">[16]</ref>. <ref type="figure" target="#fig_5">Fig. 4d</ref> has been rendered using specular photon tracing with the same medium properties as <ref type="figure" target="#fig_5">Fig. 4b</ref>, and the rendering time is similar to traditional photon mapping methods <ref type="bibr" target="#b15">[16]</ref>. With our compact FCC O-Buffer data structure, 5.8 million stored photons only consume 35MB of memory space. The search radius for radiance estimation is changed from 2.0 to 3.0 to remove the stochastic variance. Given the same number of photons, diffuse photon tracing is approximately 21 times faster than specular photon tracing and the corresponding rendering pass is 15 times faster. We observed that the image produced from our lattice-based framework using diffuse photon tracing <ref type="figure" target="#fig_5">(Fig.  4b)</ref> is comparable to the image using specular photon tracing <ref type="figure" target="#fig_5">(Fig.  4d)</ref>, and has a similar quality and appearance of those computed with traditional photon mapping methods (such as <ref type="figure" target="#fig_1">Figure 12</ref>.10 of <ref type="bibr" target="#b22">[23]</ref>). However, our framework has much better performance.</p><p>In <ref type="figure" target="#fig_5">Fig. 4e</ref>, the absorption coefficient has been made wavelengthdependent and the values in RGB channels are σ a = (0.08, 0.15, 0.3), while the scattering coefficient is the same as in <ref type="figure" target="#fig_5">Fig. 4b</ref>. The time of the rendering pass increases to 52.7 seconds mainly because the radiance estimation is performed in 3 channels. In <ref type="figure" target="#fig_5">Fig. 4f</ref>, the scattering coefficient in the blue channel has been changed to 0.4 and the eccentricity coefficient k has been changed to 0.5. In <ref type="figure" target="#fig_5">Figs. 4e and 4f</ref>, the upper part of the smoke is grey but the lower part under the shadow of the upper part becomes orange because of the different absorption and scattering coefficients in the RGB channels. <ref type="figure" target="#fig_7">Fig. 5</ref> demonstrates another example of participating media. The eccentricity coefficient k of the Schlick phase function is 0.2. The absorption and scattering coefficients are σ a = 0.05 and σ s = 0.1, respectively. One million photons have been traced in 12.7 seconds and the rendering pass amounted to 98.5 seconds on the CPU and 5.5 seconds on the GPU. <ref type="figure">Fig. 6</ref> displays the foot of the visible human CT data. <ref type="figure">Fig. 6a</ref> is rendered using a ray casting method with local illumination. <ref type="figure">Fig .  6b</ref> has been rendered using our diffuse photon tracing algorithm. The bone appears semi-translucent and brighter and has soft self-shadows due to multiple scattering. In <ref type="figure">Fig. 6c</ref>, the muscle and soft tissue are displayed with red color with the absorption coefficient similar to 6a. <ref type="figure">Fig. 7</ref> and <ref type="figure" target="#fig_9">Fig. 8</ref> are the rendering results of the engine and lobster data, respectively. <ref type="figure">Fig. 7a</ref> has been rendered using ray casting with local illumination and the other two images have been rendered with our framework and indeed the objects appear substantially different. In <ref type="figure">Fig. 7b</ref>, the material absorbs green and blue photons faster and becomes more red gradually through the light direction. In <ref type="figure">Fig. 7c</ref>, the high density region appears saturated red for emphasis and the sur-  <ref type="table">Table 1</ref>. Times used to render the smoke in <ref type="figure" target="#fig_5">Fig. 4</ref>. From left to right, the columns represent the algorithm used, the number of photon traced (in millions), photon tracing time (in seconds), and rendering time (in seconds) on the CPU and the GPU.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Algorithm</head><p>Photon count (M) Photon tracing (s) CPU rendering (s) GPU rendering (s) <ref type="figure" target="#fig_5">Fig. 4a</ref> ray casting N/A N/A 20.6 1.0 <ref type="figure" target="#fig_5">Fig. 4b</ref> diffuse photon tracing 1.0 11.3 48.1 2.4 <ref type="figure" target="#fig_5">Fig. 4c</ref> diffuse photon tracing 1.0 11.7 48.1 2.4  rounding region is less saturated red due to color bleeding. The material of the objects is easily controlled and changed using user specified transfer functions. In <ref type="figure" target="#fig_9">Fig. 8b</ref>, the lobster shell absorbs green and blue photons faster than red ones and scatters red photons more than green and blue ones. The shell appears red and the muscle casts soft shadows onto itself. <ref type="figure" target="#fig_9">Fig. 8c</ref> displays the data from a different camera position.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">DISCUSSION</head><p>In our framework, a photon is saved at every step of the first pass, regardless of whether it is scattered or not. A stored photon represents a possible path from the light sources. In the ray tracing pass, the radiance estimation actually calculates the density of photon paths at the sampling positions. In contrast, the traditional photon mapping method uses the probabilistic sampling technique to calculate the step size, and the expected step size is 1/σ t . Usually σ t is small and tracing a photon can generate many more stored photons in our algorithms than in photon mapping. Moreover, the FCC lattice provides a more efficient data structure to store photons. In diffuse photon tracing, each lattice site stores multiple photons. In radiance estimation, the contribution of multiple photons on a lattice link is computed jointly using Eqn. 9. Suppose the radiance estimation searches photons in the spherical neighborhood S, and there are k 0 sites and k 1 photons inside S. It costs O(k 0 ) time for diffuse photon tracing and O(k 0 + k 1 ) for specular photon tracing. However, it costs O(k 1 + log n) time with the k-d tree data structure in photon mapping, where n is the total number of photons. Also, the k-d tree need to be built before the rendering pass, which costs O(n log n) time. However, our algorithms do not need such a preprocessing step. There are other simplified lighting models for participating media and volumes <ref type="bibr" target="#b12">[13,</ref><ref type="bibr" target="#b13">14,</ref><ref type="bibr" target="#b17">18,</ref><ref type="bibr" target="#b25">26]</ref>. For all these methods, only forward scattering is considered and lighting values are propagated from slice to slice. The value of each pixel is calculated by sampling and attenuating neighboring pixels (up to 4) on the previous slice. In other words, forward scattering is calculated in several directions in the 2π    6.0 53.9 37.9 1.9 solid angle. Our algorithms can handle scattering within the entire 4π solid angle. Also, our methods can store photons from multiple light sources in one volume, while previous methods do not support multiple light sources. The method of Max <ref type="bibr" target="#b19">[20,</ref><ref type="bibr" target="#b20">21]</ref> is more accurate than ours but runs slowly. The idea of tracing photons on the lattice links is general and might be applied to other lattices such as the CC lattice. However, a CC lattice site only has 6 nearest neighbors, which is definitely not enough for discretizing the phase function. Consider a strongly forward scattering phase function, a photon arriving from a link can only move forward on its original direction or be scattered to 4 directions perpendicular to its incoming direction. Although we can add links between the secondary or tertiary neighbors, this solution needs to calculate and store the absorption and scattering probabilities of links with varying length (1, √ 2 and √ 3), thus making the photon tracing algorithm more complicated and time consuming. Instead, a FCC lattice site has 12 nearest neighbors, which is sufficient in photon tracing (in previous systems, only 4 or 5 directions are used for forward scattering). The link length in the FCC construction is uniform, which greatly simplifies the computation and storage: the absorption and scattering probabilities on 12 links of a site are the same and stored only once on the site. Moreover, the FCC lattice has better sampling efficiency than the CC lattice. With the same number of sites, FCC captures 23% more information. In addition, the maximum distance of an arbitrary point to its nearest site is </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8">CONCLUSIONS AND ONGOING WORK</head><p>We have presented a novel framework for volumetric global illumination based on FCC lattices. Benefitting from the FCC lattice unique geometric and sampling properties, we were able to develop algorithms that can render participating media and volumes with multiple scattering effects. Our diffuse photon tracing algorithm renders high quality images at a speed significantly faster than conventional methods. We have also described a memory efficient specular photon tracing algorithm. In future work, our plan is to extend our framework to render hybrid scenes of volumetric datasets and surface objects with specular reflection and refraction.</p><p>Our current implementation only uses 12 links to the nearest sites on the FCC lattice. For future efforts, we consider incorporating the links connecting the secondary and tertiary neighbors to increase the angular discretization granularity. With these additional links, the phase function can be discretized with even higher precision, thus more accurate radiance estimation will be obtained. In doing so, a total of 42 neighbors with distance less than √ 3 will have to be considered and different link lengths will participate in the computation of the absorption and scattering coefficients. Hence, a more efficient data structure will be required for diffuse photon storage. We also consider applying our general framework to other types of particles or waves, such as phonons and Huygens' wavelets, to solve their energy and wave propagation problems. Last, we would like to accelerate the photon tracing pass on the GPU to improve the overall framework performance.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Published 14</head><label>14</label><figDesc>September 2007.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 1 .</head><label>1</label><figDesc>An FCC lattice can be constructed by (a) adding (blue) sites at the centers of the faces of cubic cells; (b) interleaving 2D square grids (red and green semi-transparent slices), where slice 2i+1 is shifted from slice 2i by v. The second form (b) can be constructed by rotating the first one (a) π 4 about the z axis.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 2 .</head><label>2</label><figDesc>(a) The 12 neighbors (red spheres) of an FCC lattice site (green sphere) forms a cuboctahedron; (b) The voronoi cell of an FCC lattice site (green sphere) is a rhombic dodecahedron.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 3 .</head><label>3</label><figDesc>Illustration of tracing photons on a 2D FCC lattice. (a) The photon path in green color in the real medium. (b) The photon path on a 2D FCC lattice. The circles represent lattice sites and the black line segments represent lattice links. The red circle is the nearest lattice site to the photon intersection point with the medium boundary. The photon path is composed of the green lattice links.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>√ 2 2</head><label>2</label><figDesc>are retrieved because the maximum distance from a lattice site to the photons stored in it is √ 2</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 4 .</head><label>4</label><figDesc>Inhomogeneous smoke rendered with global illumination (multiple scattering) and an anisotropic phase function. The original data is 100 × 100 × 40 and we sampled it into a 108 × 100 × 56 FCC lattice with a windowed sinc filter. The algorithms used are (a) ray casting; (b) our diffuse photon tracing; (c) our diffuse photon tracing with strong backward scattering; (d) our specular photon tracing; (e) and (f) our multi-channel diffuse photon tracing.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 5 .</head><label>5</label><figDesc>Cloud rendered with our diffuse photon tracing. The resolution of the data is 96 × 74 × 143.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig. 6 .Fig. 7 .</head><label>67</label><figDesc>Global illumination of a CT scan of the visible human foot. The original data is 128 3 and the sampled FCC lattice is 128 × 128 × 180. The images are rendered with (a) ray casting with local illumination; (b) our diffuse photon tracing; (c) our multi-channel diffuse photon tracing. Global illumination of an industrial CT scan of an engine. The original data is 128 × 128 × 64 and the sampled FCC lattice is 136 × 136 × 98. The images are rendered with (a) ray casting with local illumination, (b) and (c) our multi-channel diffuse photon tracing.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig. 8 .</head><label>8</label><figDesc>Global illumination of a CT scan of a lobster. The original data is 128 × 127 × 28 and the sampled FCC lattice is 114 × 113 × 35. The images are rendered with (a) ray casting with local illumination; (b) and (c) our multi-channel diffuse photon tracing.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Algorithm</head><label></label><figDesc>Photon count (M) Photon tracing (s) CPU rendering (s) GPU rendering (s) Fig. 6b diffuse photon tracing 1.0 27.0 98.0 4.7 Fig. 6c multi-channel diffuse photon tracing 3.0 86.1 118.6 5.8 Fig. 7b multi-channel diffuse photon tracing 9.0 136.4 110.6 5.4 Fig. 7c multi-channel diffuse photon tracing 9Fig. 8c multi-channel diffuse photon tracing</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head></head><label></label><figDesc>, which means 18.4% less quantization error of photon positions with the O-Buffer data structure.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 2 .</head><label>2</label><figDesc>Rendering of the foot, engine and lobster data in Figs. 6, 7 and 8. The meaning of the columns are the same as inTable 1.</figDesc><table /><note></note></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>This work was supported, in part, by NSF CCF-0702699, NSF CA-REER grant ACI-0093157, NIH grant CA082402, and NIH grant 5R21EB004099-02. The smoke data is courtesy of Dunc Nguyen and Ron Fedkiw. The engine data is courtesy of GE. The visible human data is courtesy of National Library of Medicine.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">A rendering algorithm for discrete volume density objects</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Blasi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">L</forename><surname>Saëc</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Schlick</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computer Graphics Forum</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="201" to="210" />
			<date type="published" when="1993" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Light reflection functions for simulation of clouds and dusty surfaces</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">F</forename><surname>Blinn</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIGGRAPH</title>
		<imprint>
			<biblScope unit="page" from="21" to="29" />
			<date type="published" when="1982" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title level="m" type="main">A survey on participating media rendering techniques. The Visual Computer</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Cerezo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Pérez</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Pueyo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Seron</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Sillion</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2005-06" />
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="303" to="328" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Ray effect and false scattering in the discrete ordinates method</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">C</forename><surname>Chai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">S</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">V</forename><surname>Patankar</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Numerical Heat Transfer Part B</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="373" to="389" />
			<date type="published" when="1993" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title level="m" type="main">Radiative Transfer</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Chandrasekhar</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1960" />
			<publisher>Dover Publications</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Sphere-packings, Lattices, and Groups</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">H</forename><surname>Conway</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J A</forename><surname>Sloane</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Bannai</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1987" />
			<publisher>Springer-Verlag</publisher>
			<pubPlace>New York, NY, USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Incremental triangle voxelization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Dachille</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kaufman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Graphics Interface</title>
		<imprint>
			<date type="published" when="2000-05" />
			<biblScope unit="page" from="205" to="212" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title level="m" type="main">Multidimensional Digital Signal Processing</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">E</forename><surname>Dudgeon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">M</forename><surname>Mersereau</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1990" />
			<publisher>Prentice Hall Professional Technical Reference</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Abstract Algebra</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">S</forename><surname>Dummit</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">M</forename><surname>Foote</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1999" />
			<publisher>John Wiley and Sons</publisher>
		</imprint>
	</monogr>
	<note>second edition</note>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Linear and cubic box splines for the body centered cubic lattice</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Entezari</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Dyer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Moller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of IEEE Visualization</title>
		<meeting>IEEE Visualization</meeting>
		<imprint>
			<date type="published" when="2004" />
			<biblScope unit="page" from="11" to="18" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">A general construction of barycentric coordinates over convex polygons</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">S</forename><surname>Floater</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Hormann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Kós</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Advances in Computational Mathematics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="issue">1-4</biblScope>
			<biblScope unit="page" from="311" to="331" />
			<date type="published" when="2006-01" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Lattice-boltzmann lighting</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Geist</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Rasche</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Westall</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">J</forename><surname>Schalkoff</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Eurographics Workshop on Rendering Techniques</title>
		<meeting>the Eurographics Workshop on Rendering Techniques</meeting>
		<imprint>
			<date type="published" when="2004" />
			<biblScope unit="page" from="355" to="362" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Real-time cloud rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">J</forename><surname>Harris</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Lastra</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computer Graphics Forum</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="76" to="84" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">A lighting model for general participating media</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Hegeman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Ashikhmin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Premože</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of Symposium on Interactive 3D Graphics and Games</title>
		<meeting>Symposium on Interactive 3D Graphics and Games</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="117" to="124" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Global illumination using photon maps</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">W</forename><surname>Jensen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of Eurographics Workshop on Rendering Techniques</title>
		<meeting>Eurographics Workshop on Rendering Techniques</meeting>
		<imprint>
			<date type="published" when="1996" />
			<biblScope unit="page" from="21" to="30" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Efficient simulation of light transport in scenes with participating media using photon maps</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">W</forename><surname>Jensen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">H</forename><surname>Christensen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIGGRAPH</title>
		<imprint>
			<biblScope unit="page" from="311" to="320" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Ray tracing volume densities</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">T</forename><surname>Kajiya</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">P V</forename><surname>Herzen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIG-GRAPH</title>
		<imprint>
			<biblScope unit="page" from="165" to="174" />
			<date type="published" when="1984" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">A model for volume lighting and modeling</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kniss</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Premoze</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Hansen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Shirley</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Mcpherson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Visualization and Computer Graphics</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="150" to="162" />
			<date type="published" when="2003-06" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Acceleration techniques for GPU-based volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kruger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Westermann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of IEEE Visualization</title>
		<meeting>IEEE Visualization</meeting>
		<imprint>
			<date type="published" when="2003" />
			<biblScope unit="page" from="287" to="292" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Efficient light propagation for multiple anisotropic volume scattering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">L</forename><surname>Max</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Eurographics Workshop on Rendering</title>
		<imprint>
			<biblScope unit="page" from="87" to="104" />
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Optical models for direct volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">L</forename><surname>Max</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Visualization and Computer Graphics</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="99" to="108" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Space-time points: 4D splatting on efficient grids</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Neophytou</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Mueller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of Symposium on Volume Visualization and Graphics</title>
		<meeting>Symposium on Volume Visualization and Graphics</meeting>
		<imprint>
			<date type="published" when="2002" />
			<biblScope unit="page" from="97" to="106" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title level="m" type="main">Physically Based Rendering: From Theory to Implementation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Pharr</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Humphreys</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2004" />
			<publisher>Morgan Kaufmann Publishers Inc</publisher>
			<pubPlace>San Francisco, CA, USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">VolQD: Direct volume rendering of multi-million atom quantum dot simulations</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Qiao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">S</forename><surname>Ebert</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Entezari</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Korkusinski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Klimeck</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of IEEE Visualization</title>
		<meeting>IEEE Visualization</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="319" to="326" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">O-buffer: A framework for sample-based graphics</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Qu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kaufman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Visualization and Computer Graphics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="410" to="421" />
			<date type="published" when="2004-08" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Efficient rendering of atmospheric phenomena</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Riley</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">S</forename><surname>Ebert</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Kraus</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Tessendorf</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">D</forename><surname>Hansen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of Eurographics Symposium on Rendering</title>
		<meeting>Eurographics Symposium on Rendering</meeting>
		<imprint>
			<date type="published" when="2004" />
			<biblScope unit="page" from="374" to="386" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">The zonal method for calculating light intensities in the presence of a participating medium</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">E</forename><surname>Rushmeier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">E</forename><surname>Torrance</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIGGRAPH</title>
		<imprint>
			<biblScope unit="page" from="293" to="302" />
			<date type="published" when="1987" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">M</forename><surname>Sobierajski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">E</forename><surname>Kaufman</surname></persName>
		</author>
		<title level="m">Volumetric ray tracing. Symposium on Volume visualization</title>
		<imprint>
			<date type="published" when="1994" />
			<biblScope unit="page" from="11" to="18" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Optimal regular volume sampling</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Theußl</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Möller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">E</forename><surname>Gröller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of IEEE Visualization</title>
		<meeting>IEEE Visualization</meeting>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="page" from="91" to="98" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
