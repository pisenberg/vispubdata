<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Focus+Context Visualization with Distortion Minimization</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yu-Shuen</forename><surname>Wang</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><roleName>Member, IEEE</roleName><forename type="first">Tong-Yee</forename><surname>Lee</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Chiew-Lan</forename><surname>Tai</surname></persName>
						</author>
						<title level="a" type="main">Focus+Context Visualization with Distortion Minimization</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-20T19:49+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Focus+Context visualization</term>
					<term>magnification</term>
					<term>bounding space</term>
				</keywords>
			</textClass>
			<abstract>
				<p>The need to examine and manipulate large surface models is commonly found in many science, engineering, and medical applications. On a desktop monitor, however, seeing the whole model in detail is not possible. In this paper, we present a new, interactive Focus+Context method for visualizing large surface models. Our method, based on an energy optimization model, allows the user to magnify an area of interest to see it in detail while deforming the rest of the area without perceivable distortion. The rest of the surface area is essentially shrunk to use as little of the screen space as possible in order to keep the entire model displayed on screen. We demonstrate the efficacy and robustness of our method with a variety of models.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Using a magnifying lens to enlarge the focal region of an object is very common in the real world. If the object contains tiny details or is itself very small, observing the object through a magnifying lens is usually helpful and perhaps even necessary. Such local magnification is also useful for the visualization of a high-resolution model on a lowresolution display device. The user moves the mouse cursor to specify a region that he/she wants to observe in more detail, and the system displays an enlarged version of that region in another part of the screen. However, such a straightforward sub-window technique requires the user to interpret translation relation between the sub-window and the main window. Another approach is to zoom in on the region of interest while cropping off parts of object that are farther away. Such local magnification visualization, however, cannot maintain a full view of the model (see <ref type="figure" target="#fig_0">Figure 1)</ref>.</p><p>To display complex models on the screen which has limited resolution, researchers have proposed Focus+Context frameworks, which magnify the area of interest without clipping off the other parts <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b2">3,</ref><ref type="bibr" target="#b4">[5]</ref><ref type="bibr" target="#b5">[6]</ref><ref type="bibr" target="#b6">[7]</ref><ref type="bibr" target="#b7">[8]</ref><ref type="bibr" target="#b13">14]</ref>. These methods expand the region of interest through the theory of optical lens or other distortion methods to achieve this aim. These methods allow the user to clearly observe the model's detail in the region of interest while not losing the overall view of the model's shape and topology. This kind of visualization conveys a complete visual message to the user and reminds the user of the overall perception of the model at all time, while the user's attention is focused on a local region.</p><p>We propose a framework to interactively deform a polyhedral model to achieve Focus+Context visualization. Our goal is to nonhomogeneously rescale different regions while preventing the global bounding space of the model from being expanded (see <ref type="figure">Figure 2</ref>) and thus keeping the entire model displayed on the screen. We construct a uniform grid space for a given model such that the model vertices are embedded in the grid cubes. While enlarging the cubes covering the user-specified focal region, our system automatically reduces the other cubes to keep the entire model within the global bounding space. The deformed model is reconstructed by computing each model vertex as a linear combination of its respective set of cube vertices in the deformed grid space. Since our goal is to constrain the model to be within a bounding space, when the focal region is expanded, some regions must be reduced. We wish to scale each local region of the model but keep it similar to its original appearance. That is, we aim to preserve the aspect ratio of each local region, avoiding squeezing or squashing which would result in distortion. Specifically, we design an optimization procedure that allows cubes covering the model to undergo uniform scales, while letting empty cubes to be stretched to absorb the resulting distortion. Since the transformations of connected cubes are not identical, the deformation inevitably causes distortion. To minimize this resulting distortion, we propose a set of energy terms to form an optimization system and solve for the grid vertex positions of the deformed space in a least-squares sense.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Previous Work</head><p>Many related algorithms have been developed to visualize complicated information of 3D volumetric models. The outer opaque layer always overlays the internal information and results in visualization problems. Hence, Viola et al. <ref type="bibr" target="#b12">[13]</ref> automatically compute the importance of each voxel to avoid hiding the important regions by the outer trivial voxels. Zhou et al. <ref type="bibr" target="#b14">[15]</ref> advocate a feature-based method to enhance the volumetric features and render the parts of the model inside and outside the focal region in different styles. McGuffin et al. <ref type="bibr" target="#b10">[11]</ref> applied deformation techniques to browse volumetric data. Their approach opens up, spreads apart, or peels away the outer layers to reveal the hidden structures.</p><p>To visualize tiny information, such as the bump surface of a human colon, in a clear and detailed view, researchers have proposed many methods to magnify the focal area and either distort or overlay the neighboring regions to highlight the region of interest. Keahey et al. <ref type="bibr" target="#b4">[5]</ref><ref type="bibr" target="#b5">[6]</ref><ref type="bibr" target="#b6">[7]</ref> deformed the texts or 2D images by a transformation grid, determined by nonlinear magnification fields. Bier et al. <ref type="bibr" target="#b0">[1]</ref> presented an intuitive interface for the user to specify the focal region and render the information inside the focal region with a different style to enhance the feature of interest. Carpendale et al. <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b2">3]</ref> proposed several distortion patterns, such as stretch orthogonal and nonlinear radial, to demand more space for the focal region to achieve 3D distortion that is independent of the viewpoint. LaMar et al. <ref type="bibr" target="#b7">[8]</ref> applied hardware acceleration to deform the rendered 2D images or 3D volumes. They accomplished the goal by dynamically computing the texture coordinates for the grid vertices of the applied mask and rendering the texture with the coordinates that are projected onto the homogeneous space to make the results desirable. Unlike the above-mentioned methods, Wang et al. <ref type="bibr" target="#b13">[14]</ref> proposed an interactive technique to render volumetric models according to optical-lens theory. Their method simulates the ray direction that is determined by the position of the focal point and displays the expanded image within the magnifying lens. Both <ref type="bibr" target="#b7">[8]</ref> and <ref type="bibr" target="#b13">[14]</ref> provide different shapes of bounded lens for the user to magnify the regions of interest. Original view of the thorax model. For a detailed observation of the cervical vertebra, an intuitive approach is to shorten the distance between the model and the camera. However, the other regions, such as the lower part of the spine, will be clipped off due to the limited screen space (middle). In contrast, our method magnifies the focal region while keeping the entire model displayed on the same screen (right).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Contribution</head><p>Some previous techniques are similar to our work in that they deform a grid space to magnify the region of interest. However, none of them has addressed the issue of stretching and distorting the remaining parts of the model while magnifying a specific region. While expanding the focal region, these methods simply let the distortion occur in the surrounding area and ignore the artifact. In contrast, our method lets the free space absorb the resulting distortion rather than letting the distortion uniformly spread throughout the nearby spaces (see <ref type="figure" target="#fig_1">Figure  3</ref>). We resize each local region of the given model by an approximate uniform scale such that the locally magnified model resembles the original shape, except that their local sizes are different. Furthermore, our method accomplishes Focus+Context visualization with the regions close to the focal region automatically expanded to reduce the distortion. This is a desirable property since these surrounding areas are likely to be the next focal region during interactive visualization and thus are important as well. Overall, our algorithm can visualize Focus+Context information on the screen while keeping the distortion under control and making it unnoticeable.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">FOCUS+CONTEXT VISUALIZATION</head><p>Given an input model, we first rescale the model to be of unit size. To ensure that the entire model remains displayed on the screen, the given model should be placed at a proper position such that the eight vertices of its 1 × 1 × 1 bounding box are all projected within the screen. Then, we partition the model using a n 3 uniform grid space, G = {V, E, C}, with vertices V, edges E, and cubes C, <ref type="bibr" target="#b2">3</ref> , and v i ∈ ℜ 3 denotes the position of vertex i. In other words, there are n 3 identical cubes inside the bounding space.</p><formula xml:id="formula_0">where V = [v T 0 , v T 1 , ...v T m−1 ] T , m = (n + 1)</formula><p>Using our 2D graphical interface, the user moves a magnifying lens represented by a red dotted circle to specify a focal region to magnify. The user also specifies a parameter λ as the magnification factor of the focal region. We refer to the cubes covering the focal region (i.e., those whose centroids are projected within the red dotted circle) as the focal cubes. The focal cubes are expanded according to the parameter λ , and the remaining cubes are automatically expanded or reduced to obtain a deformed grid space G while maintaining the global bounding size. Our system solves for the grid vertex positions by minimizing a set of energy functions retaining the aspect ratios of the cubes covering the given model as well as constraining the grid vertices to be within the bounding space. After deforming the embedding space, the model is reconstructed by computing each vertex position according to its mean value coordinates within the grid space <ref type="bibr" target="#b3">[4]</ref>. Since the global bounding space remains unchanged during the magnification of the focal region (see <ref type="figure">Figure 4</ref>), and the distance between the model and the camera also remains the same, our system accomplishes the aim of Focus+Context visualization.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Space Deformation</head><p>We compute the deformed grid space by determining the scaling transformation of each cube. Clearly, since the cubes are connected and are not scaled by the same factor, it is impossible to magnify a specific region without causing distortion to other regions. Therefore we strive to minimize the deviation of each local transformation from a uniform scale to keep the resulting distortion under control and unnoticeable. To satisfy the above requirements, we propose several energy functions and formulate an optimization system to compute the deformed grid space.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.1">Individual Cube Rescaling</head><p>Given a cube c k , we compute its deformed version c k = s k c k , where s k is a 3 × 3 uniform scaling matrix. To solve for the entire grid space in <ref type="figure">Fig. 2</ref>. (left) The original model partitioned with a uniform grid space. Since solving for those deformed cubes that do not contain any model information (in green) provides zero contribution to the magnification result, we omit their energy terms from our optimization system (middle). That is, we solve only for the deformed grid vertices of the cubes occupied by the model (in red) and reconstruct the embedded model by space interpolation to achieve magnification visualization (right). is magnified to observe in detail the teeth model using the stretch orthogonal method <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b2">3]</ref> (middle left), radial Gaussian distortion <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b2">3]</ref> with faster (middle) and slower (middle right) fall-off and our method (right). Note that, with the stretch orthogonal method and the radial Gaussian, the surroundings of the focal region are seriously stretched due to the distortion being uniformly distributed on the model; wider Gaussian fall-off only distributes the distortion to a larger region. In contrast, our method minimizes distortion and preserves the shape of the local feature such that each tooth remains similar to its original shape.</p><p>a least-squares sense, we integrate the equations into a linear system C − SC 2 = 0, where</p><formula xml:id="formula_1">S uv = s k i f u = v 0 otherwise , and C = [c 0 , c 1 , ..., c n 3 −1 ] T .<label>(1)</label></formula><p>Rather than uniformly spreading the distortion over the grid space, we float distortion to the cubes that are not occupied by the model because the distortion of those cubes does not influence the magnification result. Thus, we classify the cubes into two groups: the principle cubes which cover the input model C P ⊂ C and the trivial cubes C T ⊂ C which do not. Our goal is to prevent the principle cubes from being squeezed. While solving for the deformed grid space by minimizing the objective function, our algorithm gives higher penalties to the principle cubes C P if their transformations deviate from uniform scales so as to better preserve their aspect ratios. The trivial cubes C T have zero penalties, sacrificing the uniformity of scaling transformation to absorb the distortion. To implement this idea, we rewrite Equation 1 into the form:</p><formula xml:id="formula_2">C P − S P C P 2 + γ C T − S T C T 2 = 0.<label>(2)</label></formula><p>By setting γ = 0 since the distortion on the trivial cubes C T does not influence the model's shape, our system computes only the principle cubes C P by solving the following simplified equation:</p><formula xml:id="formula_3">C P − S P C P 2 = 0.<label>(3)</label></formula><p>Note that a cube is formed by a set of vertices and edges. That is, if a cube is uniformly resized, then its 12 edges would be uniformly expanded or contracted. While deforming the grid space, our algorithm retains the connectivity of the original grid structure and only moves the grid vertices to scale individual cubes to different sizes. Let e p = {i, j} be the p th edge of the cube c k and ε p = v i − v j , we can represent the cube as c T k = q k V, where</p><formula xml:id="formula_4">q k,uv =    1 i f u = p, v = i −1 i f u = p, v = j 0 otherwise , c k = [ε T 0 , ε T 1 , ..., ε T 11 ].</formula><p>Putting the equations together, we can denote Q = [q T 0 , q T 1 , ..., q T n 3 −1 ] T and replace the matrix C by QV. Thus, Equation 3 can be reformulated as</p><formula xml:id="formula_5">Q P V P − S P Q P V P 2 = 0.<label>(4)</label></formula><p>where V P denotes the vertices of the principle cubes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.2">Position Constraint</head><p>To solve Equation 4, we need at least one absolute position to locate the deformed grid space since the equation only expresses relations among vertex positions. However, constraining only one vertex at a specific position may move the model when the focal region is magnified. This is because the optimization may transform individual cubes to different positions to reduce their distortion. <ref type="figure" target="#fig_2">Figure 5</ref> demonstrates this effect. To enhance the stability of the visualization, we want all the cubes to be close to their original positions. Specifically, we constrain each grid vertex to be at its original position with a small weighting factor and introduce the following energy term:</p><formula xml:id="formula_6">ω IV P − V P 2 = 0.<label>(5)</label></formula><p>We set ω = 0.001 in our experiments to retain the overall model's position. Larger ω will lead to immovable grid vertices and failure to deform the grid space.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.3">Non-Linear Constrained Optimization</head><p>We solve for the deformed vertex positions by minimizing the integration of the above energy terms</p><formula xml:id="formula_7">arg min V P ,S P Q P V P − S P Q P V P 2 + ω IV P − V P 2 ,<label>(6)</label></formula><p>which can be formulated as an over-determined linear system</p><formula xml:id="formula_8">AV P = b(V P ), where A = [Q T P , ωI T ] T and b(V P ) = [S T P Q T P V T P , V T P ] T .</formula><p>To prevent the global bounding space from expanding, we add inequality constraints to the objective function such that the grid vertices move only within the bounding space. That is, we minimize</p><formula xml:id="formula_9">arg min V P AV P − b(V P ) 2 , subject to x l ≤ v x ≤ x u , y l ≤ v y ≤ y u , and z l ≤ v z ≤ z u ,<label>(7)</label></formula><p>where x l , x u , y l , y u , z l , and z u are the lower and upper bounds of x, y, and z coordinate, respectively. Since A is not a positive definite matrix, we multiply the equation by A T and solve the system</p><formula xml:id="formula_10">(A T A)V P = A T b(V P )</formula><p>to obtain the unknown variables V P . Note that the uniform scaling transformations of the cubes are still unknown when we determine the deformed grid space. Therefore, we can only solve this non-linear optimization problem by iteratively updating the vertex positions <ref type="bibr" target="#b8">[9]</ref>. The scaling factor for the focal cubes is obtained from the input parameter λ . For the remaining (non-focal principle) cubes, we compute their scaling transformations according to their deformed (M k ) and original (M k ) volumes. Specifically, s k = (M k /M k ) 1/3 I. In the beginning, we set V 0 P = V P to start the iteration. We then compute the scaling transformations for the non-focal cubes from V t P , and use the obtained b(V t P ) to solve for the new vertex positions V t+1 P . Although the scaling transformation obtained from V 0 P is merely an identity matrix, the least-squares solver will still reduce the volumes of some cubes so as to expand the focal region. However, the set of vertex positions computed in the first iteration is not the optimum solution of our proposed objective function because the applied scales are only determined by the initial guess. Therefore, we repeat the process to update the vertex positions until the solution converges.</p><p>While iteratively updating the grid vertex positions, we detect whether any vertex violates the inequality constraints. Since only a <ref type="figure">Fig. 4</ref>. (left) Original model and its global bounding space. While magnifying the gargoyle's head without imposing inequality constraints, the entire model is uniformly expanded and some regions may go out of the bounding space (middle). We constrain the outer grid vertices to be located on the bounding surface (right), and thus ensure that the deformed model is always displayed on screen in its entirety. few vertices might be transformed outside the bounding space, not all the inequality constraints have influence on the optimization problem. Therefore, we consider an inequality constraint f x (v) as</p><formula xml:id="formula_11">active i f v x &gt; x u or v x &lt; x l inactive i f x l ≤ v x ≤ x u .</formula><p>Similarly, f y (v) and f z (v) are inactive if v y and v z satisfy their respective constraints. In the beginning, we consider all the inequality constraints as inactive since all the grid vertices are located within the bounding space. After computing the new vertex positions in each iteration, our algorithm detects if any inequality constraint has become active, and if so, restricts that vertex to be sliding on the space boundary in the next iteration. To combine the inequality constraints with our proposed objective function, these constraints are transformed into energy terms <ref type="bibr" target="#b9">[10]</ref> (for example,</p><formula xml:id="formula_12">(v x − x l ) 2 = 0 if v x &lt; x l )</formula><p>and are added into the linear system if they are active. Note that the active constraints of x, y, and z coordinates are different; therefore, the three coordinates of the grid vertices should be solved separately. Let</p><formula xml:id="formula_13">F x = { f x,0 , f x,1 , f x,2 , .</formula><p>..} be the index set of active inequality constraints of the x coordinate. We can solve the linear system</p><formula xml:id="formula_14">A x V P,x = b x (V P )</formula><p>to obtain the x coordinates of the grid vertices, where</p><formula xml:id="formula_15">A x = [Q T P , ωI T , R T x ] T , b x (V P ) = [S T P Q T P V T P,x , V T P,x , H x ] T , R x,uv = δ i f v = f x,u ∈ F x 0 otherwise , H x = δ x l i f v x &lt; x l δ x u i f v x &gt; x u ,</formula><p>and δ is a large number to enforce the soft constraint (we set δ = 100 in our experiments). The other two coordinates of the vertices can be determined in the same manner. Since the number of equations changes whenever any inequality constraint becomes active, causing the size and the structure of the linear system to change as well, our system needs to re-factorize the matrix A x (or A y , A z ) to compute the new vertex set. Fortunately, the factorization only takes place when an inequality constraint is activated or deactivated, which occurs very infrequently because only the boundary vertices of the principle cubes might violate the inequality constraints. Although our algorithm deforms the grid space in an iterative manner, the computation is still efficient because the factorization of the linear system is not necessary in every step. In most steps, we need only to apply back substitutions to compute the new vertex set and thus the grid space can be deformed in real time. For grid vertices whose inequality constraints are active, we examine their positions to decide when to deactivate them. Since our system solves for the deformed grid space using soft constraints, the vertices with active inequality constraints are not exactly located on the grid space boundary, rather they may be slightly inside or outside the boundary. Specifically, the activated inequality constraint of an outside vertex pulls the vertex close to the space boundary, but the vertex remains outside. Then, subsequent movement of the focal region may cause the vertex to move in. When this happens, its inequality constraint can be deactivated.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.4">Initial Guess</head><p>Solving a nonlinear optimization problem always needs a starting position, which is commonly called the initial guess. Obviously, an initial guess that is close to the optimum solution would lead to faster convergence. Choosing a good starting point is therefore an important issue. Although it is always possible to start deforming the grid space from its uniform shape, the extra iterations needed will increase the computation cost and thus slow down the interactive rate. <ref type="figure">Figure 6</ref> shows an example to demonstrate the initial guess and the subsequent iterations. Here, we assume that the cursor movement of the user while specifying the focal region is continuous and the algorithm starts the iteration from the previous frame because the magnification results should be similar if their magnified regions are close to each other. In the beginning, we set the original grid space as the initial guess since there is no previous frame. Our system repeats the updating process until the movement of each grid vertex is less than 0.001, which takes 8 iterations on average to achieve the minimum solution.  <ref type="table">Table 1</ref>. The second and third columns show the model information and the last three columns show the timing statistic. The computation cost of reconstructing the model depends on the model's vertex number while the computation cost of grid space deformation (i.e., factorization and back-substitution) depends on the grid's vertex number. <ref type="figure">Fig. 6</ref>. We magnify the dragon's head (in the red dotted circle) to achieve Focus+Context visualization. From left to right are the original model and the locally magnified models computed by our algorithm after 1, 5, 10, 30 iterations. Notice that the surrounding region of the dragon's head is more distorted in the beginning but the distortion is rapidly reduced in subsequent iterations. The results obtained in 10 and 30 iterations are very similar because the iterative solver has converged.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Model Reconstruction</head><p>We reconstruct the given model by space interpolation after the grid space is deformed. Since each model vertex is embedded in a local cube, we can determine its new position by a combination of their respective 8 cube vertices. Let u be a vertex of the given model, and v 0 ∼ v 7 be its surrounding cube vertices. The model vertex u can be represented as ∑ 7 i=0 w i v i , where w i is the weight determined by the mean value coordinates <ref type="bibr" target="#b3">[4]</ref>. We compute the weighting factor w i in the pre-computation step and use these values to reconstruct the model each time the bounding space is deformed since the w i 's remain the same.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS AND DISCUSSION</head><p>We have implemented our algorithm on an Intel Core2 2.33 GHz PC with 2 Gb RAM. The linear system is solved with Cholesky Factorization provided by the Taucs library <ref type="bibr" target="#b11">[12]</ref>. We partition each input model by a 20 3 grid space, except the ball joint model <ref type="figure">(Figure 2</ref>) by 10 3 . Clearly, partitioning the model with a finer grid space (especially for complex models) will lead to better results but increase the computation cost. To balance between the quality and interactive rate, we found that a 20 3 grid space is a good compromise. <ref type="table">Table 1</ref> shows the timing statistic and the model information. The slowest part of our algorithm is the matrix factorization, which mainly depends on the number of grid cubes. The reconstruction of the given model is efficient because computing each vertex only requires a linear combination of the surrounding cube vertices. For example, the Ramesses model in <ref type="figure" target="#fig_2">Figure 5</ref> contains 826,266 vertices, which requires only 0.144 seconds to determine the positions of all the model vertices.</p><p>Our system can provide Focus+Context information to the user, allowing the user to view detailed content of the focal region while maintaining the overall perception of the model. The results shown in <ref type="figure">Figure 9</ref> demonstrate the effectiveness of our technique. For each input model, we expand different focal regions specified with a dotted red circle and the model is deformed smoothly to keep the deformed shape within the global bounding box. In addition, due to the distortion minimization in our formulation, our system not only retains the aspect ratios of non-focal regions but also results in the smooth magnification of the surroundings of the focal region. This means the user needs not carefully specifies the shape and size of the magnifying lens to fit the feature of interest, leading to an easy and intuitive interface.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Distortion Measurement</head><p>We determine the degree of similarity between the original and deformed models by considering the distortion of each local region. The distortion can be measured in terms of the amount of stretching of individual cubes because the embedded input model is deformed by space interpolation. Obviously, a deformed cube that is of the same shape, but different size, as the original cube suffers from zero distortion. Therefore, to determine the amount of distortion, we first scale each pair of original and deformed cubes to the same size and then accumulate the difference of their 12 edge vectors. Specifically, we compute the equation</p><formula xml:id="formula_16">∑ {i, j}∈E k |δ (v i − v j ) − (v i − v j )| 2 ,<label>(8)</label></formula><p>where E k denotes the 12 edges of the local cube k, and δ = (M k /M k ) 1/3 , with M k and M k denoting the volume of its original and deformed cubes, respectively. The region with lower distortion value means that it is similar to its original shape and the region with higher distortion value is naturally stretched. For example, in <ref type="figure" target="#fig_3">Figure 7</ref>, we expand a portion of the colon and measure the resulting distortion due to the magnification. It can be clearly observed that, without distortion minimization, the regions surrounding the focal region are seriously distorted. In comparison, our system produces results with much smaller and unnoticeable distortion. In the case when all the cubes are principle cubes, our system produces results similar to those with radial Gaussian distortion <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b2">3]</ref> since there is no space to absorb distortion. Under this situation, the distortion is uniformly propagated outward from the focal region to other regions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Soft Constraint</head><p>An interesting feature of our system is the use of soft constraints to solve for the deformed grid space in a least-squares sense. This leads to the actual size of the deformed focal region being slightly smaller than the user-specified magnifying factor for the focal region. We take the gargoyle model in <ref type="figure">Figure 4</ref> as an example to illustrate this situation. Although we apply a 2 × I transformation on the focal region to determine the deformed grid space, the average volume of the deformed focal region is 1.46 × 10 −4 while their original volume is 0.26 × 10 −4 . The expanding ratio, i.e., 6.35, is less than the expected 2 <ref type="bibr" target="#b2">3</ref> because the uniformity and the magnification requirements conflict with each other (i.e., within the limited space, it is impossible for the focal region to expand with no distortion), and the least-squares solver finds the optimum solution to satisfy the overall requirements. Solving for the deformed grid space using soft constraints inevitable causes a little distortion to the focal region because the system compromises the uniformity of the focal cubes to reduce the distortion of the overall model. Some applications may require the focal region to be expanded without distortion. Minimizing the objective function with hard constraints can achieve this aim and ensure that the size of the deformed focal cube is equal to the user's specification. Unfortunately, this approach would rapidly increase the cost if the focal region changes constantly since the modification of the hard constraints (i.e., focal region) changes the structure of the linear system and thus requires matrix refactorization. For efficiency, we solve the objective function with only soft constraints while the user is changing the focal region interactively and change the soft constraints into hard constraints to exactly retain the size and uniformity of the focal cubes after the user's specification remains fixed for some time.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Pros and Cons</head><p>Our system deforms the entire model to achieve Focus+Context visualization. While magnifying the focal region to display it with higher resolution, some regions are expanded while some are reduced to minimize distortion of every local region. Unlike the radial Gaussian distortion method <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b2">3]</ref>, which deforms only the cubes inside or close to the focal region, our system rescales almost all the cubes covering the model. Although the deformation is everywhere, the user can easily observe the continuous variation of the model's shape because the model is deformed interactively. Since every local region is rescaled, our method can not retain the model's global shape while minimizing the local distortion. For example, in <ref type="figure">Figure 8</ref>, the global shape of the foot bone model is changed with our approach but is better preserved by the radial Gaussian distortion. We argue that the change of the global shape is not necessarily a bad feature. According to the the- <ref type="figure">Fig. 8</ref>. Original model (left). Observe that the Gaussian distortion method (middle) better preserves the global shape of the foot bone than our method (right). However, the user usually pays more attention to the regions inside and surrounding the magnifying lens and our method produces very little artifact in these regions.</p><p>ory of human central vision, only a small area in the center of retina contains a rich collection of cone cells, which is sensitive to light, fine detail and color. Therefore, users usually concentrate on a region of interest and its surroundings when using a magnifying lens. This means that the model's overall shape is only a concept and the variation of the global shape is not disturbing to the user. In addition, since our system achieves real time performance, the user can easily move the magnifying lens to any free space not occupied by the model any time to see the model's undeformed global shape.</p><p>Our system offers another advantage for Focus+Context visualization. The magnifying lens is of limited size (i.e., smaller than the screen size), and during interactive visualization, the user is often also interested in the non-focal regions close to the lens border. Thanks to the distortion minimization, these surrounding regions, which are likely to be the next focal regions, are also enforced to expand because the cubes are connected.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">CONCLUSIONS</head><p>We introduce a novel and interactive technique to achieve Fo-cus+Context visualization of 3D models. The main contribution of our method is to minimize the resulting distortion so that each local region appears similar to its original counterpart. Our algorithm retains the original global size of the model by constraining the grid vertices to move within the global bounding space and prevents the local regions from squeezing through approximating the applied transformations to be close to uniform scales. Although solving this nonlinear constrained optimization problem takes several iterations to obtain the optimum solution, the computation is still efficient because updating the positions of grid vertices requires only back substitutions in most of the iterative steps. In addition, our algorithm has the potential to handle point models and volumetric data since the embedded model is deformed by space interpolation. While the cubes are transformed to satisfy the local magnification requirement, the positions of the point clouds or the voxels are recomputed as the combination of its surrounding cube vertices. <ref type="figure">Fig. 9</ref>. Original models (leftmost column). Our algorithm expands the focal region and reconstructs the embedded model from the deformed grid space to achieve Focus+Context visualization (the remaining columns).</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>(left)  </figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 3 .</head><label>3</label><figDesc>(left) Original model. The focal region (inside the red dotted circle)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 5 .</head><label>5</label><figDesc>(top row) Only one position constraint is applied at the bottom right of the Ramesses model (black point). While magnifying his feet (top middle) and head (top right), his body would move to the right or left as our algorithm tries to minimize distortion. (bottom row) All the grid vertices are slightly constrained to their original positions. The model's position is now more stable after local magnification.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 7 .</head><label>7</label><figDesc>(left) Original model. (middle) Deformed models by radial Gaussian distortion (top)<ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b2">3]</ref> and by our method (bottom). We use different shades of red to represent the distortion distribution (right). Notice that the distortion is much smaller with our method and does not gather around the focal region.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>•</head><label></label><figDesc>Yu-Shuen Wang and Tong-Yee Lee are with the Computer Graphics Group/Visual System Laboratory, Department of Computer Science and Information Engineering, National Cheng-Kung University, No. 1,</figDesc><table /><note>Ta-Hsueh Road, Tainan 701, Taiwan, R.O.C., E-mail: braveheart@csie.ncku.edu.tw; tonylee@mail.ncku.edu.tw.• Chiew-Lan Tai is with the Department of Computer Science &amp; Engineering, Hong Kong University of Science and Technology, Clear Water Bay, Hong Kong. E-mail: taicl@cse.ust.hk Manuscript received 31 March 2008; accepted 1 August 2008; posted online 19 October 2008; mailed on 13 October 2008. For information on obtaining reprints of this article, please send e-mailto:tvcg@computer.org.</note></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>We thank the anonymous reviewers for their insightful comments that helps us improve the paper. We also thank AIM@SHAPE Shape Repository, Stanford 3D Scanning Repository and Cyberware for the </p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Toolglass and magic lenses: the see-through interface</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">A</forename><surname>Bier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">C</forename><surname>Stone</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Pier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Buxton</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">D</forename><surname>Derose</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">SIGGRAPH &apos;93: Proceedings of the 20th annual conference on Computer graphics and interactive techniques</title>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="1993" />
			<biblScope unit="page" from="73" to="80" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Distortion viewing techniques for 3-dimensional data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">S T</forename><surname>Carpendale</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">J</forename><surname>Cowperthwaite</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">D</forename><surname>Fracchia</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">INFOVIS &apos;96: Proceedings of the 1996 IEEE Symposium on Information Visualization (INFO-VIS &apos;96)</title>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="1996" />
			<biblScope unit="page">46</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Extending distortion viewing from 2d to 3d</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">S T</forename><surname>Carpendale</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">J</forename><surname>Cowperthwaite</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">D</forename><surname>Fracchia</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Comput. Graph. Appl</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="42" to="51" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Mean value coordinates for closed triangular meshes</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Ju</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Schaefer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Warren</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ACM Trans. Graph</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="561" to="566" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">The generalized detail-in-context problem</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">A</forename><surname>Keahey</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">INFOVIS &apos;98: Proceedings of the 1998 IEEE Symposium on Information Visualization</title>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="1998" />
			<biblScope unit="page" from="44" to="51" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Techniques for non-linear magnification transformations</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">A</forename><surname>Keahey</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">L</forename><surname>Robertson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">INFOVIS &apos;96: Proceedings of the 1996 IEEE Symposium on Information Visualization (INFOVIS &apos;96)</title>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="1996" />
			<biblScope unit="page">38</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Nonlinear magnification fields</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">A</forename><surname>Keahey</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">L</forename><surname>Robertson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">INFOVIS &apos;97: Proceedings of the 1997 IEEE Symposium on Information Visualization (InfoVis &apos;97)</title>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="1997" />
			<biblScope unit="page">51</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">A magnification lens for interactive volume visualization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Lamar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Hamann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">I</forename><surname>Joy</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">PG &apos;01: Proceedings of the 9th Pacific Conference on Computer Graphics and Applications</title>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="2001" />
			<biblScope unit="page">223</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Methods for nonlinear least squares problems</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Madsen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Nielsen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Tingleff</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Informatics and Mathematical Modelling</title>
		<imprint>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
	<note type="report_type">Tech. rep</note>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Optimization with constraints</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Madsen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Nielsen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Tingleff</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Informatics and Mathematical Modelling</title>
		<imprint>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
	<note type="report_type">Tech. rep</note>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Using deformations for browsing volumetric data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">J</forename><surname>Mcguffin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Tancau</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Balakrishnan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">VIS &apos;03: Proceedings of the 14th IEEE Visualization 2003 (VIS&apos;03)</title>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="2003" />
			<biblScope unit="page">53</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title level="m" type="main">Taucs: A library of sparse linear solvers, version 2.2</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Toledo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Rotkin</surname></persName>
		</author>
		<ptr target="http://www.tau.ac.il/stoledo/taucs/" />
		<imprint/>
		<respStmt>
			<orgName>Tel-Aviv University</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Importance-driven volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Viola</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kanitsar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">E</forename><surname>Groller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">VIS &apos;04: Proceedings of the conference on Visualization &apos;04</title>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="2004" />
			<biblScope unit="page" from="139" to="146" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">The magic volume lens: An interactive focus+context technique for volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Zhao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Mueller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">E</forename><surname>Kaufman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Visualization</title>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page">47</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<monogr>
		<title level="m" type="main">Focal region-guided feature-based volume rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Zhou</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Hinz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">D</forename><surname>Tonnies</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002" />
			<publisher>IEEE Computer Society</publisher>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="87" to="90" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
