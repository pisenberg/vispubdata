<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Analyzing Complex FTMS Simulations: a Case Study in High-Level Visualization of Ion Motions</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Wojciech</forename><surname>Burakiewicz</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Robert</forename><surname>Van Liere</surname></persName>
						</author>
						<title level="a" type="main">Analyzing Complex FTMS Simulations: a Case Study in High-Level Visualization of Ion Motions</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-20T19:41+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Particle visualization</term>
					<term>motion</term>
					<term>motion features</term>
				</keywords>
			</textClass>
			<abstract>
				<p>Current practice in particle visualization renders particle position data directly onto the screen as points or glyphs. Using a camera placed at a fixed position, particle motions can be visualized by rendering trajectories or by animations. Applying such direct techniques to large, time dependent particle data sets often results in cluttered images in which the dynamic properties of the underlying system are difficult to interpret. In this case study we take an alternative approach to the visualization of ion motions. Instead of rendering ion position data directly, we first extract meaningful motion information from the ion position data and then map this information onto geometric primitives. Our goal is to produce high-level visualizations that reflect the physicists&apos; way of thinking about ion dynamics. Parameterized geometric icons are defined to encode motion information of clusters of related ions. In addition, a parameterized camera control mechanism is used to analyze relative instead of only absolute ion motions. We apply the techniques to simulations of Fourier transform mass spectrometry (FTMS) experiments. The data produced by such simulations can amount to 5 • 10 4 ions and 10 5 timesteps. This paper discusses the requirements, design and informal evaluation of the implemented system.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Complex physical models involving large number of particles are often investigated with the aid of computer simulations. Simulations allow the researchers to gain insight into the model, and help them design optimal experimental setups or complete instruments, such as mass spectrometers or particle accelerators. Particle simulations usually produce huge amounts of data. Due to the inherent complexity of the particle motion, it is often necessary to use visualization techniques for its analysis to interpret the simulation results. Visualization would broaden the understanding of the underlying model and help explain the resulting physical phenomena.</p><p>Many visualization systems have been developed to cope with particle simulation data. The most straightforward visualization technique is to render particle position data directly as a point in threedimensional space. Particle properties such as mass, velocity, charge or energy may also be incorporated as attributes of the point. Particle motion can be visualized by drawing trajectories for each particle or by animation. Other techniques, such as particle subset selection or rendering glyph representations of particles, can be employed to simplify the image. Finally, the user can explore the resulting point cloud in a perspective projection using basic camera movements: rotation, panning and zooming.</p><p>A major problem with the direct rendering of large particle data sets is that the resulting images depict only low-level particle position data and contain no explicit semantical information of the particle motions. The resulting animations can be very cluttered and it is left to the user how to interpret the simulated phenomena from the images. The goal of this case study is to produce animations that reflect mass spectrometry physicists' way of thinking about ion dynamics. By understanding what motion information the physicists want to see from an ion data set, visualization techniques that depict more high-level semantical concepts can be developed.</p><p>In this case study, we take an alternative approach to the visualiza- tion of ion motions. Instead of rendering ion position data directly, we first extract meaningful motion information from the ion position data and then map this information onto geometric primitives. We have applied our particle visualization system to the analysis of Fourier transform mass spectrometry (FTMS) simulations. Data sets produced by such simulations can be large: 5•10 4 ions and 10 5 timesteps are typical data set sizes. We employ two basic techniques: parameterized geometric icons and parameterized camera control, in which parameters are derived by extracting motion properties from the data. Geometric icons are used to simplify the image while retaining the essential motion properties of a related cluster of ions. Camera control can be used to analyze relative (instead of absolute) ion motions and to visualize very specific motions that are of interest to the mass spectrometry researcher. For example, consider <ref type="figure" target="#fig_1">Figure 1</ref>. The left panel shows an ion data set as a direct rendering; some ions are shown with their trajectories. In the middle panel, ion clusters are displayed as geometric icons. The shapes of the icons resemble comets illustrating the varying ion density. The right panel shows a parameterized camera view; the camera is positioned relative to the comet allowing for relative motions of ions within a cluster to be viewed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.1">Fourier transform mass spectrometry</head><p>Mass spectrometry is a powerful analytical technique that is used to identify unknown compounds, to quantify known compounds, and to elucidate the structure and chemical properties of molecules. The power of mass spectrometry is that compounds can be detected and identified at very low concentrations in chemically complex mixtures. Fourier transform mass spectrometry (FTMS) is a particular technique used in mass spectrometry. For FTMS devices to operate robustly, very accurate detection of mass to charge ratio (m/z) of ions trapped in an electromagnetic field is required. The more accurate the ions can be detected, the more resolving power can be achieved. The aim of FTMS simulations is to obtain insight into the dynamics of ion motions and to study how initial conditions can influence the ion behavior.</p><p>The central part of a FTMS model is a cubic vacuum cell. The sides of the cell are called trapping, excitation and detection plates (marked as T, E and D on <ref type="figure">Figure 2</ref>). Ions remain trapped in the cell: static magnetic field parallel to the Z-axis prevents the ions from escaping in X and Y directions. By maintaining electric potential between the trapping plates, the ion movements are also constrained in the Z direction. There are three phases of the experiment. During cooling phase, ions are injected into the cell and cooled to room temperature. Then, in excitation phase, an electric field perpendicular to the magnetic field is generated between the excitation plates. This causes the ions with the same m/z ratios to form clusters and oscillate with a frequency depending on their m/z value. During the detection phase, the oscillating ion clusters induce a signal on the detection plates.</p><p>If the initial conditions of the experiment are optimally set, then each m/z ion cluster will result in a distinguishable peak in the signal's Fourier spectrum. The peaks in the signal are used to discern the ion species (different m/z values) within the cell. In practice however, different peaks tend to merge and the ion species cannot be distinguished. During the experiment it is important that the ions move in phase coherent clusters. If ion clusters are not coherent (i.e. dephase) the signal cannot be detected as a single peak. The initial conditions that can influence the detection accuracy are the excitation frequency profile and time, magnetic field strength, density of ions, and initial temperature.</p><p>We list a number of phenomena that are important for the mass spectrometry physicist to obtain insight into the simulation output:</p><p>1. Specific ion motions: Ion motions can be split into three separate motions that emerge from well known physical laws <ref type="bibr" target="#b5">[6]</ref>:</p><p>• cyclotron motion -the circular motion in the XY plane. In theory, the cyclotron motion frequency of an ion is expressed as: ω c = zB m in which B is the static magnetic field, m is the ion mass and z is the ion charge. Cyclotron frequencies in our studies are in 100 -200 kHz range.</p><p>• trapping motion -oscillation along the Z axis due to the trapping potential between the trapping plates (see <ref type="figure">Figure</ref> 2). The trapping motion frequency of an ion is expressed as: ω t = kz m in which k is a constant related to the quadradtic z-potential. Frequency of this motion is 1 -10 kHz.</p><p>• magnetron motion -also called B × E drift. It arises as a second solution of the ion motion equation in the static magnetic and electric fields. The magnetron motion frequency is 1 -100 Hz.</p><p>2. Frequency perturbations: Many factors can influence ion motions during the experiment and simulation. For example, ion cluster interactions can occur, ion-ion interactions within a cluster, non-optimal initial conditions, detection noise, etc., can influence the motion of (a cluster of) ions. Hence, the detected ion frequencies need not to be the same as the theoretical oscillation frequencies; i.e. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">RELATED WORK</head><p>Most of the existing particle visualizations directly render particle data as a point cloud. Traditionally, points, polygons, or icons are used to represent particle positions. Particles are rendered as a point cloud in 3D, or in 2D scatter plots by projecting data onto the XY, XZ and YZ planes. For example, <ref type="figure" target="#fig_3">Figure 3</ref> shows a 2D-scatterplot of a timestep from the FTMS simulation data. Particle properties such as mass, velocity, charge or energy are incorporated as attributes of the point. Particle motion can be visualized by drawing trajectories for each particle or by animation. Due to space restrictions, we discuss two alternative approaches for representing particles: • Co et al. have visualized high-dimensional particle simulation data using a number of coupled, two and three-dimensional scatterplot views, <ref type="bibr" target="#b1">[2]</ref>. As a mean of exploring physical data disk glyphs and interactive selection, reflected in multiple views, are proposed. Brushing techniques are used for particle marking and the selection is immediately reflected in multiple views.</p><formula xml:id="formula_0">1.0 0.5 0.0 -0.5 -1.0 1.0 0.5 0.0 -0.5 -1.0 Y X x10 x10 -2 -2</formula><p>• Volume rendering has been used to render particle trajectories resulting from relativistic heavy ion collider (RHIC) experiments, <ref type="bibr" target="#b8">[9]</ref>. The emphasis is put on displaying huge number of elementary particle trajectories created during ion collisions. The amount of data is reduced by different means of track filtering, range of interest specification and trajectory clustering. Nonlinear magnification (fish-eye camera) is proposed as a mean of displaying part of the data in detail while keeping the global view.</p><p>Both systems render particle position data directly as a point in three-dimensional space. The direct rendering results in only low-level particle position data and contains no explicit semantical information about the particle motions. It is left to the user how to interpret the simulated phenomena from the images.</p><p>There have been many case studies that visualize high-level information of particle motions. For example, Huitema et. al. have discussed techniques for the interactive 3D visualization of protein dynamics, <ref type="bibr" target="#b2">[3]</ref>. They apply essential dynamics methods to filter out uninteresting atom motions from the larger concerted motions. In this way, clear and concise 3D animations of protein motions can be produced. Robbins et. al. have developed novel visual techniques to analyze the structural details of waves in response data from the turtle visual cortex, <ref type="bibr" target="#b7">[8]</ref>. Space-time and latency maps are used to visualize structurally coherent reactions. Finally, Parker et. al. have developed novel visualizations to study tokamak plasma turbulence, <ref type="bibr" target="#b6">[7]</ref>. Poloidal and toroidal slices are used to display electrostatical potential over time. All these case studies use custom visualization techniques for depicting the physical phenomena of the underlying problem. It is not clear, however, if and how these techniques can be generalized.</p><p>Besides novel visual representations of particle motion, much research is focused on designing parallell rendering systems to interactively display giga-to terabytes of data produced by particle simulations, <ref type="bibr" target="#b9">[10,</ref><ref type="bibr" target="#b4">5,</ref><ref type="bibr" target="#b3">4]</ref>. The resulting systems are very robust in the terms of rendering speed and data processing. Our ion visualization system does not put much focus on large data sets. As we show in Section 4, our visualization system does not compute motion properties on the complete data set, but needs only a small history of time steps. We show that for medium-sized datasets (tens of GB) this can be achieved on a modern desktop computer.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">VISUALIZATION IDIOMS</head><p>Since the cyclotron motion frequency of an ion is defined as ω c = zB m (see Section 1.1), we group a cluster of ions whose mass to charge ratio belongs to a user defined interval of values; i.e.</p><formula xml:id="formula_1">G = {i | i ∈ [ m 0 z 0 , m 1 z 1 ]}.<label>(1)</label></formula><p>Various properties of an ion group can be computed. The center of gravity is defined as the average position of the group's ions; i.e.</p><formula xml:id="formula_2">G cog = ∑ G N i=0 pos(i) / G N ,</formula><p>in which pos(i) denotes the position of the ion i, and G N is the number of ions in the group.</p><p>Next, we take the x,y coordinates of the group's center of gravity from three subsequent timesteps:</p><formula xml:id="formula_3">G xy cog (t i−1 ) = (x i−1 , y i−1 ), G xy cog (t i ) = (x i , y i ), G</formula><p>xy cog (t i+1 ) = (x i+1 , y i+1 ). If they are not co-linear, we can compute the center of rotation of the group G in the XY plane. We achieve this by solving the system of three equations obtained from the circle equation</p><formula xml:id="formula_4">(x k − x 0 ) 2 + (y k − y 0 ) 2 = r 2 , by substituting k = i − 1, i, i + 1, where</formula><p>x0, y0, r are the variables. The point (x 0 , y 0 ) is the center of rotation.</p><p>By cyclotron frequency of the group G we mean the frequency of its G cog rotating around the center of rotation. The cyclotron phase φ of an ion is its angular coordinate in the cylindrical coordinate system (r, φ , z) placed at the center of rotation. The dephase of the group G indicates the difference in cyclotron phase between the outermost ions of the group; i.e. ions at φ min and φ max in <ref type="figure" target="#fig_4">Figure 4</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Geometrical Icons</head><p>A comet icon has been developed that encodes the density of the ions in the cluster. The comet icon is chosen since mass spectrometry physicists believe that ions move in coherent groups in which low m/z values belong to the head and high m/z values belong to the tail (see <ref type="figure" target="#fig_3">Figure 3)</ref>. A varying density indicates that ions in the cluster are moving with respect to each other, and will be represented by the comet icon changing its shape. We show how a comet icon can be constructed (see <ref type="figure" target="#fig_4">Figure 4)</ref>. First, the group's dephasing property is used to compute the angles of the outermost ions with respect to the center of rotation of the group (φ min and φ max in <ref type="figure" target="#fig_4">Figure 4)</ref>. Then, the interval [φ min ,φ max ] is partitioned in a number of disjoint volumes. For each volume a circle is constructed perpendicular to the center of gravity trajectory. The radius of the circle is proportional to the number of ions in the volume; i.e. for partition s, the radius is r s = n s • k where n s is the number of ions in partition s and k is a user defined scale factor; r s is further adjusted to fit in a user defined range [r min , r max ]. The comet icon is constructed by connecting the circles, resulting in a tube shaped object. Finally, the comet is scaled along the Z axis, so that its height corresponds to the group's length in the Z direction.</p><p>Comet icon encodes many useful aspects of the group motion. First, by representing all ions in a group by a single geometric object, cyclotron motion is clearly shown (see Point 1 in Section 1.1). Also, the comet shows the dephasing of the group (Point 3 in Section 1.1) -the more the group is dephased the more elongated the comet. Finally, the shape represents the ion density within the group. During animation, changes in the density can be easily monitored.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Frequency Icons</head><p>Various icons have been designed that encode ion group motion as phase and frequency information.</p><p>The frequency icon encodes the difference between the measured group's cyclotron motion frequency and the expected cyclotron frequency (ω theory c − ω measured c in Point 2 of Section 1.1). The frequency icon is represented as a small circle on an axis. <ref type="figure" target="#fig_5">Figure 5</ref> is an example which shows 4 frequency icons. In the normal situation, i.e. ω theory c − ω measured c = 0, the circle will be positioned at the origin of the axis. When the frequency is perturbed, the circle will be positioned to the left or right of the axis.</p><p>The dephase icon encodes the dephasing information of the group. The dephase icon is represented as a dial. For each cluster we compute the difference in phase of the cluster's outermost ions, expressed in degrees. We map this value to the angle of the dial. The dephase icon will represent a phase coherent cluster as a thin arc. When the cluster gradually dephases, the disc gradually fills up to a full circle. Four dephase icons are shown on the right side of <ref type="figure" target="#fig_5">Figure 5</ref>.</p><p>Individual frequency icons depict the measured frequency of an ion cluster with respect to the theoretical frequency. In addition, frequency icons can be plotted together on one plot to depict measured frequency of an ion cluster with respect to other ion clusters. This is schematically shown in <ref type="figure" target="#fig_5">Figure 5</ref>. On the Y-axis are the clusters' mass to charge ratios. On the X-axis are the clusters' frequencies. The theoretical frequency ω c = zB m is plotted. The frequency icons are positioned along the Y-axis according to the cluster's m/z value. Phase locking occurs when frequency icons have different m/z values but similar frequencies. This can be seen easily in the plot. In summary, a mass spectrometry physicist can gain insight to the frequency perturbations of ion clusters (via frequency icons), cluster dephasing (via dephase icons), and phase locking (via relative icon positions).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Camera control</head><p>Camera control is used for analyzing relative motion of an ion cluster. The camera pose is parameterized by ion cluster properties and is positioned at each timestep.</p><p>The camera pose is constructed as follows. For a selected cluster we consider the path of its center of gravity. At each timestep we compute a Frenet frame along the path; i.e. a coordinate system describing the motion of the center of gravity. The camera is positioned relative to this moving coordinate system. In this way, the camera can be tethered to the moving cluster. The camera is positioned along the Z-axis or in the XY plane of the Frenet frame and the field of view is chosen so that all ions of the cluster can be seen ( <ref type="figure" target="#fig_6">Figure 6</ref>).</p><p>When the camera is positioned along the Z-axis of the Frenet frame, the relative motion of ions inside the cluster can be viewed. Trapping motion can be viewed by positioning the camera in the XY plane of the Frenet frame. In addition, when the camera is zoomed out, intercluster interactions, e.g. cluster collisions, can be observed. Vectors are rendered to show the direction and magnitude of the motions relative to the camera.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">IMPLEMENTATION</head><p>The graphical part of the application is implemented with the use of the VTK library. The construction of the VTK pipeline and the graphical interface are implemented in Python with the help of the wxWidgets library. The computational part of the visualization (computing the statistical properties) is done in C++ and wrapped as a Python module.</p><p>The system is able to handle medium size FTMS simulations using a desktop PC with AMD64 CPU, 1 GB memory, 250 GB hard disk and 6600 nvidia graphics. The ion simulations we have visualized involved 5 • 10 4 ions simulated over 10 5 timesteps, resulting in files of approximately 60 GB. A small window of timesteps is cached in main memory, on which statistical properties are computed. As it is now possible to obtain disk capacities of 1TB on a standard desktop PC, simulations involving up to 1 million ions can be visualized with no need for specialized hardware.</p><p>When rendering 50k particles as points, the system can achieve frame rates of about 70fps.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">RESULTS</head><p>The system has been used to visualize FTMS simulations of 5 • 10 4 cytochrome C ions with an accurate isotope and charge state distributions. The data are ion x,y,z coordinates for each timestep and m/z ratio of each ion. The data file contains 10 5 timesteps. Assuming 12 bytes of data per particle (x,y,z coordinates stored as 4-byte floats), this gives the file of size 5 • 10 4 • 10 5 • 12B ≈ 60GB. The duration of the simulation corresponds to an experimental time scale of a few hundred milliseconds. This section provides various visualizations of this dataset. <ref type="figure" target="#fig_7">Figure 7</ref> illustrates an ion cluster represented as a comet icon. The thickness indicates the ion density in a given part of the comet. The maximum thickness is set not to exceed the group's boundaries along the Z-axis. The color bar at the top indicates the m/z distribution of ions: ions with higher m/z (red color on the bar) are at the comet's tail, whereas ions with smaller m/z are located in the comet's head. As we can see on the top image, most ions are concentrated in the middle of the cluster. The bottom image shows the same comet icon at different The ions are concentrated in the middle of the comet, but due to the trapping motion the ion cluster got flattened. The cluster is now more dephased, which is reflected by the elongated icon shape.</p><p>timestep. The shape and size of the icon clearly shows how the ion density in the cluster evolves over time. <ref type="figure" target="#fig_9">Figure 8</ref> shows ion cluster frequencies at two different timesteps represented as frequency icons. The layout of the icons shows how the actual cluster frequencies deviate from the theoretical frequency. On the top image, the clusters seem to be rotating with the frequency close to the theoretical. On the bottom image, however, we can see that some of the clusters have their frequencies perturbed. The reason of those perturbations may be inspected in the 3D perspective view using icons and/or parameterized camera control. The dephase icons on the right indicate how the dephasing of ion clusters changes over time. Finally, <ref type="figure" target="#fig_1">Figure 10</ref> shows an overall view of the simulated FTMS cell. The ion clusters are represented as comet icons with m/z ion distribution illustrated by the color bars over the comets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">EVALUATION</head><p>Fourier transform mass spectrometry is currently playing a leading role in biological mass spectrometry because it demonstrates the highest resolution and mass accuracy. Further improvement of mass accuracy in FTMS is impossible without a better fundamental understanding of the behavior of the ion clouds during the whole cycle of FTMS signal measurement. Novel Particle-in-Cell implementation of the simulations can now ensure realistic conditions by taking into account ion-ion interaction, ion-image charge interaction and ion-neutral collisions. Extracting useful information from the data resulting from these simulations is complicated by the fact that the results span multiple physical dimensions such as x,y,z coordinates, time, density and the parameters derived from the basic ion motion such as frequency and phase of the ion cloud.</p><p>By using the proposed visualization system, mass spectrometry researchers were able to verify two important hypotheses (see also <ref type="bibr" target="#b0">[1]</ref>): 1. FTMS simulations are used to study how the number of ions used in the experiment influences the ion behavior and the measurement accuracy. This is achieved by executing the simulation with different numbers of ions. The researchers found that there are three ranges for the number of ions. Each ion count range results in different ion and ion cloud behavior. For example, when a small number of ions are used, comet like structures appear but dephasing sets in very rapidly. For a moderate number of ions, phase locking of the same m/z clusters occurs. A large number of ions results in phase locking of different m/z clusters.</p><p>2. The excitation profile has also been proven to have considerable influence on ion motions. Simulations are now being used to investigate optimal excitation profiles.</p><p>The mass spectrometry researchers were not able to obtain these insights from visualizations with direct rendering and fixed cameras, such as <ref type="figure" target="#fig_3">Figure 3</ref>. In our case:</p><p>• The comet icon encodes the evolution of ion clusters, such as ion density and mass distributions. The dephasing is quantitatively encoded in the shape of the icon. The evolution of dephasing can be monitored by studying the change of icon shape.</p><p>• Trapping and cyclotron motions of ions within an ion cluster are studied with the camera control mechanism. Relative ion motions with respect to other ions in the cluster can easily be observed. • Ion cluster frequency perturbations are clearly visible using frequency icons. The 'normal' (not disturbed) group motion results in a static frequency icon and a static icon layout. When frequency shifts occur, the icon's appearance is modified, attracting user's attention and providing quantitative information on the amount of shift. Slight perturbations of frequency are impossible to comprehend using only a standard 3D view with rotating ion clouds.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">CONCLUSIONS</head><p>The goal of this case study was to provide mass spectrometry physicists with high-level visualizations that reflect the way they think about ion dynamics. To do so, we have developed and evaluated a set of visualization idioms that extract high-level semantical concepts from the data and depict these concepts as parameterized geometrical icons. The way the physicists think about FTMS is twofold. On the one hand they see the particles rotating in the electromagnetic trap. On the other hand they think in terms of frequencies and phases; ions and ion clusters exist only as objects having certain frequency and phase, regardless to their spatial arrangement.</p><p>Direct rendering of particle positions is not adequate to obtain insight to the real phenomena that govern the motion of trapped ions. The user is not able to understand the complex interactions of ions and ion clusters based only on the animated images of particles and their trajectories. Our visualization system presents ion groups by both spatial and frequency icons.</p><p>Our system is expected to play crucial role in further development of advanced FTMS simulation techniques. In consequence, the visualization system improves the development and callibration of real FTMS instruments by enabling physicists to better analyze FTMS designs through simulation.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>•</head><label></label><figDesc>Wojciech Burakiewicz is with Center of Mathematics and Computer Science, Amsterdam, E-mail: burakiew@cwi.nl. • Robert van Liere is with Center of Mathematics and Computer Science, Amsterdam, E-mail: robertl@cwi.nl. Manuscript received 31 March 2006; accepted 1 August 2006; posted online 6 November 2006. For information on obtaining reprints of this article, please send e-mail to: tvcg@computer.org.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 1 .</head><label>1</label><figDesc>Three views of ion-motion: Left is a low-level direct rendering of an ion-cloud. Trajectories are used to show motion of a few ions. Middle image shows 'comet icons' which encode motion and density properties of clusters of related ions. The right image shows relative ion motions from a camera tethered to the center of the comet.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>ω theory c − ω measured c = 4 .Fig. 2 .</head><label>c42</label><figDesc>0 for cyclotron frequencies. The question is: what causes the frequency perturbations?3. Cluster dephasing: During the excitation phase, ions form phase coherent clusters. Over time, the clusters tend to dephase; i.e. phase differences between ions in a cluster tend to increase. Dephasing can be seen by studying the structural shape of the cluster. The structure of the ions in the cluster will gradually change from a coherent to a less coherent shape.The questions we want to answer are: under what circumstances does dephasing happen and is it an instantaneous or progressive event? Phase locking: Two ion clusters with different m/z ratios should induce signals with different frequencies, even if their m/z are very close. However, clusters with close m/z ratios may start oscillating together with the same frequency and phase, and are therefore detected as a single cluster. This undesirable effect is called phase locking. What triggers the phase lock event? Schematic view of a Fourier transform mass spectrometer cell.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 3 .</head><label>3</label><figDesc>Direct rendering of an ion cloud onto XY plane. Ions form a comet-like structure.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 4 .</head><label>4</label><figDesc>Comet icon construction in 2D: The group is partitioned into a set of disjoint sections. Each section is represented by a circle, with radius proportional to the included number of ions. The comet is constructed by connecting the circles.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 5 .</head><label>5</label><figDesc>Layout of frequency icons: Frequency icons ω measured c (depicted as small gray circles) are laid out with respect to the theoretical frequency ω theory c (depicted as the monotonic decreasing curve).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig. 6 .</head><label>6</label><figDesc>Parameterized camera. Left: The camera is tethered to the Frenet frame computed for the center of gravity trajectory of an ion cluster. Right top: Trapping motion of the ions is viewed when the camera is positioned in the XY plane of the Frenet frame. Right bottom: Relative -inside-cloud -motion of the ions in the cluster can be seen when the camera is positioned along the Z-axis of the Frenet frame.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 7 .</head><label>7</label><figDesc>Comet icon. The thickness indicates the ion density in a given part of the comet. The maximum thickness is set not to exceed the group's boundaries along the Z-axis. The color bar at the top indicates the m/z distribution of ions: ions with higher m/z (red color on the bar) are in the comet's tail, whereas ions with smaller m/z are located in the comet's head. Yellow arrows indicate the Frenet frame of the group's center of gravity trajectory. Top image: Most ions are concentrated in the middle of the comet. Bottom image: The comet at a different timestep.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 9</head><label>9</label><figDesc>illustrates the parameterized camera control mechanism. The top image shows a comet icon from the XY plane of the Frenet frame; i.e. trapping motion can be observed. The local coordinate frame is shown as yellow arrows. Small arrows show ion movements relative to the local frame. Red arrows show the direction of trapping motion. The bottom image shows the same comet icon at the same timestep as seen along the Z-axis of the Frenet frame.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig. 8 .</head><label>8</label><figDesc>Frequency icons. Several icons are drawn representing the expected and measured frequency for the mass to charge ratio of each ion cluster. Top image: A timestep in which the ion cluster frequencies are very close to the expected frequencies. Bottom image: Ion cluster frequencies deviate from the expected frequencies. This may indicate that cluster-cluster interactions or phase locking of ion clusters has occurred.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Fig. 9 .</head><label>9</label><figDesc>Camera tracing ion cluster represented by comet icon. Top image: View from the XY plane. Visible is the local coordinate frame (yellow). Small arrows give idea of ion movements relative to the local frame. Red arrows show the direction of trapping motion. Bottom image: Camera viewing the traced cluster (blue) along Z axis. Collisions with another ion clusters are clearly seen in this view.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Fig. 10 .</head><label>10</label><figDesc>Overall view of the simulated FTMS cell. Multiple ion clusters represented as comets are visible.</figDesc></figure>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">New 3D visualization tools for ion trajectory simulations in FTICR-MS</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Burakiewicz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Van Liere</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">N</forename><surname>Nikolaev</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">M</forename><surname>Popov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><forename type="middle">M</forename><surname>Taban</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ron</forename><forename type="middle">M A</forename><surname>Heeren</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">2006 ASMS Conference on Mass Spectrometry</title>
		<imprint>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Interactive methods for exploring particle simulation data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christopher</forename><forename type="middle">S</forename><surname>Co</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alex</forename><surname>Friedman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><forename type="middle">P</forename><surname>Grote</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jean-Luc</forename><surname>Vay</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">Wes</forename><surname>Bethel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kenneth</forename><forename type="middle">I</forename><surname>Joy</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2004" />
		</imprint>
		<respStmt>
			<orgName>Lawrence Berkeley National Laboratory</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">Technical report</note>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Interactive visualization of protein dynamics</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Henk</forename><surname>Huitema</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Robert</forename><surname>Van Liere</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">VISUALIZATION &apos;00: Proceedings of the 11th IEEE Visu</title>
		<meeting><address><addrLine>Washington, DC, USA</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="2000" />
			<biblScope unit="page" from="465" to="468" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Niclas Andersson, and Anders Ynnerman. Interactive Visualization of Particle-In-Cell Simulations</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Patric</forename><surname>Ljung</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mark</forename><surname>Dieckmann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 11th IEEE Visualization 2000 Conference</title>
		<meeting>the 11th IEEE Visualization 2000 Conference<address><addrLine>VIS</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Advanced visualization technology for terascale particle accelerator simulations</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kwan-Liu</forename><surname>Ma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Greg</forename><surname>Schussman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Brett</forename><surname>Wilson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kwok</forename><surname>Ko</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ji</forename><surname>Qiang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Robert</forename><surname>Ryne</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 2002 ACM/IEEE conference on Supercomputing</title>
		<meeting>the 2002 ACM/IEEE conference on Supercomputing<address><addrLine>Baltimore, Maryland</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE Computer Society Press</publisher>
			<date type="published" when="2002" />
			<biblScope unit="page" from="1" to="11" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alan</forename><forename type="middle">G</forename><surname>Marshall</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Francis</forename><forename type="middle">R</forename><surname>Verdun</surname></persName>
		</author>
		<title level="m">Fourier Transforms in NMR, Optical, and Mass Spectrometry</title>
		<imprint>
			<publisher>Elsevier</publisher>
			<date type="published" when="1980" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Tokamak plasma turbulence visualization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">E</forename><surname>Parker</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Samtaney</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 11th IEEE Visualization 1994 Conference</title>
		<meeting>the 11th IEEE Visualization 1994 Conference<address><addrLine>Washington, DC, USA</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="1994" />
			<biblScope unit="page" from="337" to="340" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Visualizing cortical waves and timing from data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">A</forename><surname>Robbins</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Robinson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Senseman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">VISUALIZATION &apos;04: Proceedings of the 11th IEEE Visualization 2004 Conference</title>
		<meeting><address><addrLine>Washington, DC, USA</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="2004" />
			<biblScope unit="page" from="401" to="408" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Case study: Visualization of particle track data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xiaoming</forename><surname>Wei</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Arie</forename><forename type="middle">E</forename><surname>Kaufman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Timothy</forename><forename type="middle">J</forename><surname>Hallman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">12th IEEE Visualization</title>
		<imprint>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Interactive visualization of particle beams for accelerator design</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Brett</forename><surname>Wilson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kwan-Liu</forename><surname>Ma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ji</forename><surname>Qiang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Robert</forename><surname>Ryne</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">ICCS &apos;02: Proceedings of the International Conference on Computational Science-Part III</title>
		<meeting><address><addrLine>London, UK</addrLine></address></meeting>
		<imprint>
			<publisher>Springer-Verlag</publisher>
			<date type="published" when="2002" />
			<biblScope unit="page" from="352" to="361" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
