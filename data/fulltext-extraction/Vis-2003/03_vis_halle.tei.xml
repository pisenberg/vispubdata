<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">LightKit: A lighting system for effective visualization</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><surname>Halle</surname></persName>
							<email>mhalle@bwh.harvard.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jeanette</forename><surname>Meng</surname></persName>
							<email>meng@bwh.harvard.edu</email>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="institution">Harvard Medical School</orgName>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="department">Department of Radiology, Brigham and Women&apos;s Hospital</orgName>
								<orgName type="laboratory">Surgical Planning Laboratory</orgName>
								<address>
									<settlement>Boston</settlement>
									<region>MA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<address>
									<settlement>Seattle, Washington</settlement>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">LightKit: A lighting system for effective visualization</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-19T20:50+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>I.3.8 [Computer Graphics]: Miscellaneous-Lighting Design Visualization</term>
					<term>lighting design</term>
					<term>light color</term>
				</keywords>
			</textClass>
			<abstract>
				<p>Figure 1: MRI-derived anatomical models rendered with a headlight (a and c) and with LightKit (b and d).</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Visualization is a process of many tasks, from the cerebral to the mundane. The success of all the elements of visualization, from data acquisition to mathematical analysis to graphical display, are often judged based on the effectiveness and lucidity of the final graphical rendition of the data. For geometry-based visualization techniques, few common elements are so important yet typically so cursorily considered as lighting. Aesthetic qualities of lighting play a role in visualization in much the same way as they do in a wellexecuted painting or a persuasive commercial photograph. While a visualization scientist may not explicitly state that creating a visually appealing image is a primary goal, few of us would seek or celebrate an unattractive result.</p><p>Proper lighting is tied to effective visualization through more than just aesthetics, though. Lighting is critical to our comprehension of shape, depth, and orientation. It brings out the threedimensionality of structures that we may have spent countless CPU hours constructing. It pulls objects of interest away from other parts of the scene and the background; it reinforces our sense of orientation as we fly through complex structures. Conversely, poor lighting can help to defeat our best visualization efforts. Improper lighting, for instance, can mislead us into thinking that a convex object is concave, or vice versa. Without good lighting, important details of a visualization might be misinterpreted or missed entirely.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.1">Too simple or too unconstrained</head><p>In practice, lighting in visualization software systems has fallen into two extreme categories: too simple or too general. A typical simple light model consists of a single white "headlight" source attached to the camera, moving whenever and wherever the camera moves. A headlight is a reasonable default choice when only a single light source is available: besides its simplicity, it directly illuminates all surfaces at which the camera is directly looking.</p><p>The headlight has several disadvantages, though. First, it provides no sense of orientation: the shading from the light itself does not reveal which way is up or down. The symmetry of the headlight's illumination may also confuse the interpretation of an object since highlights appearing at the exact center of an object might be mistaken for a feature of a symmetric object itself. Finally, a headlight reduces useful contrast and modeling of some features (ones located on surfaces facing towards the camera), while producing <ref type="figure">Figure 2</ref>: A polygonal model of human ventricles (fluid-filled spaces in the brain) seen lit with a headlight (a) and with LightKit (b). In the headlight image, receding surfaces have excessive contrast and silhouette edges are dark, while front surfaces have reduced contrast. LightKit's illumination appears more natural. LightKit's fill and back lights can be used to brighten lower surfaces as needed in a particular application: in this case, some contrast between the upper and lower surfaces is maintained. excessive contrast on others (surfaces seen almost edge on, with surface normals nearly perpendicular to the view vector).</p><p>A common improvement to the headlight model moves the light source away from the camera to a position somewhat above the scene. This change provides better orientation cues and improves the visual modeling of some surfaces, but places downward-facing parts of the object in darkness. To compensate for this higher contrast, the ambient component of the surface's shading properties is usually increased. Darker areas become visible but are poorly modeled.</p><p>The alternative to these simple single light models is an system consisting of multiple unconstrained light sources. Any number of light sources can be places at any location in space (usually specified in cartesian coordinates), and given any color (often described by red, green, and blue color components). These lights can be attached to the camera, but more commonly they are located in world or scene space.</p><p>While this general lighting model is extremely flexible, it shares none of the simplicity that makes the single light models so appealing. The complexity of positioning many light sources in threedimensional space and choosing colors from an unlimited palette forces the visualization scientist to become a lighting designer without guidance, a task that few are experienced or willing enough to take on. Real-world theatrical stage designers have the intrinsic limitations of gantries, stands and gels and the benefit of past experience to help simplify lighting choices; visualization designers have the complete freedom, and the full burden, to produce effective, intuitive scene illumination. All too often, then, lighting in visualization takes too much time, distracts from the scene, or is just too simple to effectively model the object being inspected.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.2">Introducing LightKit</head><p>We propose a general-purpose lighting system for visualization that strikes a middle ground between the simplicity of a single light model and the unbounded complexity of unconstrained lighting. Our system, called LightKit, simplifies the task of effective lighting by constraining the position and color of lights as well as the interrelationship between the lights and the camera. We take as inspiration traditional photographic studio lighting techniques that simulate natural lighting, accentuate subtle shapes, and minimize excessive scene contrast. Similar light positioning techniques have been developed for the computer graphics cinema industry; they have not been widely implemented as turnkey solutions for visualization systems.</p><p>LightKit adapts this photography-inspired light positioning system with additional features important to simplifying the visualization lighting process. Multiple lights are positioned on a spherical gantry that moves with the camera and is centered at the point of interest. Each light's intensity is set relative to the intensity of a main light, encouraging a dominant overhead source with a variety of different filling lights. The lighting intensity of the entire scene can then be controlled by adjusting the main light source. The color of light sources is restricted to the range of incandescent or natural black body radiation sources (sky blue to sunset red), specified using a single normalized parameter. LightKit further simplifies visualization lighting by providing reasonable default values that work well for many scenes. Finally, LightKit is specifically designed with hardware-based lighting models such as those used in interactive visualization systems in mind; it may also be appropriate with higher quality lighting models, including those that support shadows.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Previous work</head><p>Several efforts have been made to optimize the positioning of lights in a three-dimensional scene. Shacked and Lischinski <ref type="bibr" target="#b16">[Shacked and Lischinski 2001]</ref> propose automatic optimization of light position based on user input and a perception-based image quality objective function. Gumhold <ref type="bibr" target="#b7">[Gumhold 2002</ref>] takes another approach to automatic light placement, relying on maximum entropy measures and experiment-driven, perception-based optimization to position sources. Both systems produce reasonable results for static scenes in a non-interactive environment. Neither system, however, addresses the question of how to light a scene during interaction, such as when a virtual camera is moved through a scene during inspection of a visualization data set. Lights could be repositioned every fixed number of frames to maximize the two methods' re-spective quality metrics. However, this repositioning would have to be done very carefully to minimize any perception that the object itself, rather than the light position, is changing during interaction. Algorithmic extensions to address this important and practical issue are not obvious.</p><p>We seek a different, simpler approach to the problem of lighting based on photographic, cinematographic and theatric experience. Rather than trying to automate the process of lighting, we can choose an approach based on a "case study" or "cookbook" philosophy: identify common examples of successful real-world lighting and design a synthetic analog that provides the flexibility to light to common scenes while discouraging poor lighting choices. Such an effective synthetic lighting system does not eliminate aesthetic judgment: rather, it cultivates it. A user can start from reasonable defaults, perhaps adjust a small number of intuitive lighting parameters (related directly to the lights themselves, not to composite lighting characteristics as in <ref type="bibr">Shacked and Lischinski)</ref>, and quickly optimize the appearance of a scene.</p><p>We base our light position model on Birn's three-point lighting model <ref type="bibr" target="#b1">[Birn 2000</ref>], which in turn is based on a lighting setup widely used in movies and photographic studio work. Related techniques are presented by Gallardo <ref type="bibr" target="#b4">[Gallardo 2001</ref>]. The three-point light model as described by Birn consists of a key light that provides the dominant illumination of the scene, a fill light that opposes the key light and softens its effect (perhaps simulating reflection off a floor or other objects), and a back light that separates the object from the background by better defining the object's edge. Birn's examples assume higher-quality, off-line rendering features such as shadows that are not, in general, available in contemporary hardwareaccelerated rendering subsystems such as those commonly used for interactive visualization.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">LightKit details</head><p>LightKit adapts Birn's three-point light model to the needs of interactive visualization and the limitations of a polygon-based, hardware-rendered environment. In this section, we will describe the aspects of LightKit that make it unique and easy to use, including the mechanism used to position lights, the role the different lights play, and the colors choices available for lights.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Positioning LightKit lights</head><p>Interactive visualization benefits from the ability to explore an virtual world at different scales without constantly adjusting the position of lights. As a general rule, LightKit light sources move along with the camera, much as if the lights were placed on invisible arms attached to a submarine exploring the deep. A camera-relative light model assures that the local environment will be consistently and appropriately lit. One potential disadvantage of such a lighting arrangement might occur if a global three-dimensional sense of orientation needs to be maintained. In this case, the LightKit lights can be detached from the camera and applied to the environment instead.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.1">Normalized subject-centered space</head><p>We define a normalized, subject-centered, camera-relative coordinate space to position LightKit's lights. In this space, the location of interest where the camera is looking is defined as the origin. The camera is located one unit away from the origin at coordinate (0, 0, 1), with an up vector of (0, 1, 0) and looking at the origin. This coordinate system emphasizes the local environment at whatever orientation or scale the visualization is conducted; it is easy to <ref type="figure">Figure 3</ref>: LightKit lights are directional and move with the camera, minimizing frame to frame changes. Images produced during interactive dataset exploration using LightKit are generally well-lit independent of scale and orientation. These images were all created using the same light settings. <ref type="figure">Figure 4</ref>: Three spheres of varying specular exponent are shown illuminated with a headlight (top) and with a LightKit. In contrast to the headlight image with its harsh highlights, LightKit provides more appropriate contrast in addition to a sense of orientation. place a light, say, just above and a little to the right of the subject of interest, no matter what or where that subject is.</p><p>We further reduce complexity by choosing directional lights (lights located at infinity) shining at the subject so that source distance is normalized away, leaving only light direction to be specified.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.2">Spherical lighting gantry</head><p>To position the directional lights, LightKit introduces a spherical light gantry of unit radius, centered on the origin, on top of the normalized subject-centered coordinate system. A light is "attached" to the surface of the gantry by specifying its position as a longitude and latitude (or, equivalently, azimuth and elevation). These values are measured in degrees, with the camera always located on the gantry surface at (longitude=0 • , latitude=0 • ). A negative longitude places the light to the left of the camera (shining from left to right), a positive value places it to the right of the camera. A negative latitude positions a light below the camera, a positive value locates the light above, shining down. Because the lighting gantry moves with the camera, it is easy to visualize from what direction a light source will be shining while inspecting any view.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Types of lights</head><p>Within this positioning framework, LightKit incorporates and extends Birn's three-point lighting arrangement of key, fill, and back lights. Assigning each light in the scene to a particular task helps the visualization designer understand, appreciate, and eventually master the art of scene lighting. Such a process is a type of clustering: transforming a problem so that changes to a small set of variables results in a predictable, isolated, or localized result. If lighting itself is considered a visualization problem of multiple parameters, assigning roles to lights effectively names the terms in an implicit lighting equation in such a way that users can learn to manipulate them intuitively. This section describes details of the roles of different lights in LightKit.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.1">Key and fill lights</head><p>The key light is the dominant light in the scene and is located by default at about (longitude of 10 • , latitude of 50 • ), or above and in front of the point of interest and a little to the right. The key light simulates overhead light from ceiling-mounted fixtures or the sun; it helps our visual system interpret concavity or convexity. The fill light opposes the key light: by default it is located at (longitude -10 • , latitude -75 • ), or below and in front of the "look at" point and a little to the left. As in Birn's lighting arrangement, the fill light is usually less than half the intensity of the key light; it reduces excessive contrast on mostly front-facing surfaces and approximates the secondary illumination reflected from other objects, a floor below the object, or perhaps open sky.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.2">Headlights</head><p>LightKit adds a headlight to the Birn three-point lighting model. This light is similar to the one used as the only light in simple illumination systems. The headlight is always located at the camera position at a longitude and latitude 0 • ; it serves to fill in excessive contrast on front-facing surfaces. The headlight also allows more flexibility in fill light positioning: in conjunction with a headlight, the fill light can be moved more directly underneath the object. Including a headlight further permits LightKit to function as more of a "drop in" replacement in applications already using a headlight model. Some visualization applications, such as the display of a patient's anatomy as it might appear in the operating room, may appear more realistic with a relatively bright headlight (alternatively, the key light may be moved to a position close to the camera).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.3">Backlighting</head><p>In studio photography, particularly portraiture, backlighting is used to separate foreground from background by increasing the brightness of edges near the silhouette of the scene. A real-world back light is usually hidden behind the subject; soft edges such as fabric and hair catch and diffuse light from the source, making its effect visible. (For this reason, a portraiture back light is sometimes known as a halo light.) In simplified computer graphics light models, though, most edges do not have this softness, and lights providing backlighting must be moved out from behind the object to provide useful illumination. Furthermore, backlighting of coarsely polygonalized objects by non-area sources at extreme angles tends to reveal polygonalization artifacts on the surface.</p><p>LightKit provides simple backlighting using two back lights positioned symmetrically on the back-left and and back-right of the <ref type="figure">Figure 5</ref>: A comparison of images using progressively more LightKit lights. In image (a), the key light illuminates the subject from above but produces excessive contrast. A fill light located below the subject (b) reduces contrast on surfaces below the cheek. In (c), Back lights fill in more backward-facing surfaces such as those between the cheek and ear. The introduction of a headlight (d) allows the key light's intensity to be brought down slightly while preserving frontal illumination. The face appears more naturally and more evenly lit in the final LightKit-illuminated image (d) than it does in the headlight-only image (e).</p><p>object. The back lights are adjusted in tandem: changing the latitude of one light moves the other light to the same latitude, while changing one light's longitude moves the other light to the same but negative longitude. By default, back lights are located at or near equator of the gantry (latitude of 0 • ), and somewhat to the rear of the object (longitudes of 110 • and -110 • ) to avoid polygonalization artifacts. Some visualization tasks such as inspecting height fields may benefit from moving the back lights to a higher latitude. Back lights illuminate parts of the object least illuminated by the other lights, so their brightness may be proportionally higher. In LightKit, the default back lights are each about one-third the brightness of the key light.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Light intensity and color</head><p>In basic computer graphics lighting systems, the intensity and color of each light are adjusted simultaneously using the same red, green, and blue components. Dimming or brightening the light requires adjusting three parameters. (Other light models use an intensity or luminance component as part of the color description.) What's more, the intensity of every light in the scene is adjusted independently, so dropping the total scene brightness while maintaining the general appearance of the scene is a time-consuming user task. Light color selection is an additional challenge all its own. LightKit addresses these problems by splitting the tasks of assigning intensities and colors, linking the intensity adjustments of all lights together, and simplifying the process of selecting the color for each light.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3.1">Intensity</head><p>Each LightKit light has a single intensity parameter that controls how bright that particular light is. The underlying hardware light's color is based on the LightKit light's intensity modulating its color. To make it easier to adjust the scene brightness without significantly altering the relative intensity of the different lights, each light intensity is expressed as a ratio relative to the key light. The fill light's intensity, for instance, is specified indirectly as a "key to fill" ratio relative to the key light's intensity. The"key to head" and "key to back" ratios control the relative intensity of their respective lights. This intensity refactoring leads to an intuitive and efficient lighting workflow. After the different LightKit lights are appropriately positioned, the key light ratio is roughly set to avoid an extremely dark or light subject. The fill light is then adjusted to fill in the object opposite the key light while leaving enough contrast to model interesting features in the surface. The backlighting intensity is changed to light features near the grazing angle. Then the headlight's brightness is altered to provide additional fill. Finally, the key light's intensity (along with the intensity of all the lights relative to it) is tuned to avoid clipped highlights or excessively dark shadows while preserving the general appearance of the lit scene.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3.2">Color and warmth</head><p>Choosing reasonable or attractive colors in any unrestricted color space is a challenging task that depends strongly on the aesthetic judgment of the user. Beyond aesthetics, an unfortunate choice of light colors can result in an incorrect interpretation of the color assigned to the surface being visualized. LightKit avoids this problem by assuming that the intention of the majority of visualization tasks is to faithfully portray the color of the underlying object being visualized. In other words, lighting in LightKit is not information bearing. This strong constraint reduces the choices of light to a range that might generally be considered natural, neutral illumination. The color of incandescent sources such as the sun and filament-based light bulbs, otherwise known as black body radiation sources, are a common and excellent choice for this purpose.</p><p>Unfortunately, there is no well-established normalized scale for describing this color range. Color temperature, the color with which a black body heated to a given physical temperature glows, reflects the right natural color range from sunset red to shades of white to sky blue, but suffers from several practical limitations. First, the common color temperature range from about 3,500K to 10,000K is not perceptually linear in color or intensity, nor is it centered around a value uniquely associated with neutral white. Similarly, the scale's numerical properties are neither optimal nor based on any sort of common intuition. Finally, common qualitative terms used to specify light colors like "warmer" (redder) or "cooler" (bluer) are at odds with the color temperature scale, where "warmer" higher temperatures are bluer and "cooler" temperatures are redder. <ref type="bibr">Gooch et. al.</ref> have demonstrated the value of the artistic concepts of warm and cool colors and color scales for tone-based shading in non-photorealistic rendering <ref type="bibr" target="#b6">[Gooch et al. 1998</ref>].</p><p>LightKit uses a new quantitative scale for natural incandescentlike color called warmth. <ref type="figure" target="#fig_0">Figure 6</ref> shows a collection of spheres illuminated by key lights with different warmth values. The warmth scale has several appealing properties. Warmth values are normalized between zero and one. A middle value of 0.5 is neutral, full intensity white. The luminance of colors at the two extremes of the warmth range are approximately equal and about one half of the maximum value. The color scale is non-linear so that the more subtle shades of off-white occupy the middle half of the range: the warmth for lights should generally be chosen in the range from 0.25 to 0.75. On the other hand, relatively deep blues (such as the dusk blue sky) and reds (like the setting sun) are still available at the extremes of the scale 1 . Lastly, common color words are proportional to the warmth scale: "add some more warmth" or "make the scene a little warmer" correctly means "increase the value of the warmth parameter," which results in a redder color. "A little cooler," or "use less warmth," means reduce the warmth value and make the color bluer.</p><p>The default colors of the lights used in LightKit are neutral or close to neutral. The key light is a little warm (0.6) to simulate mid-morning sun. The fill light is a little cool (0.4) to mimic indirect illumination from the open sky. The headlight and back light illumination are both neutral (0.5). Since the colors that correspond to different warmth values are not equiluminant, adjustment of the color of any light may throw off the different light intensity ratios. In practice, this change does not appear to be much of a problem, since more saturated reds or blues are uncommon and are generally not rendered brightly. Alternatively, the process of assigning absolute intensities based on key light ratios can take the luminance of the light sources into account.</p><p>The details of the calculation of the warmth scale can be found in the appendix.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Examples</head><p>The illustrations in this paper demonstrate some of LightKit's versatility. They were generated using a LightKit module implemented as part of VTK, an open source visualization toolkit from Kitware <ref type="bibr" target="#b10">[Kitware, Inc 2003</ref>]. The LightKit module is part of the current VTK release. In some cases, we have used a simple user interface to adjust LightKit's parameters, the LightKitViewer VTK example application. For the medical imaging examples, we used an even simpler LightKit control panel in Slicer, our open source medical visualization and image processing platform <ref type="bibr" target="#b17">[Surgical Planning Lab 2003</ref>].</p><p>VTK's default light model is a simple headlight located at the camera, and for several years Slicer used this default model for all of our medical visualization. LightKit has allowed medical researchers to prepare clearer and more attractive images of anatomical structures without much extra effort or attention. <ref type="figure">Figure 1</ref> shows two examples of polygonal models derived from single anatomical structures and visualized using both a headlight and LightKit. In general, these comparisons show the excessive contrast inherent in most headlight-illuminated scenes. The difference in the rendition of the brain surface in this particular example is especially striking: the LightKit-lit brain appears much more three-dimensional.</p><p>The basic shape of the human face and brain surface is relatively easily recognized. The polygonal model of the human ventricles depicted in <ref type="figure">Figure 2</ref> is an example of the type of less familiar, more complicated structure that visualization is so important for understanding. In this case, the headlight's shading confuses our understanding of the ventricles' shape. Upper surfaces are dark, not light. Excessive contrast can be seen just behind the curve of the frontmost surface. Silhouette edges are rendered dark of black. The LightKit image, on the other hand, expresses the curve of the upper surface of the ventricles more naturally. In some ways, this image approximates natural shadowing of lower parts of the object. Simple adjustments of the fill or back lights can change the contrast between upper and lower surfaces based on their relative importance for a particular visualization task. <ref type="figure">Figure 3</ref> demonstrates LightKit's suitability for use in interactive visualization systems. Unlike other lighting methods that fix lights in the environment or optimize their position and intensity based on camera and scene parameters, LightKit provides static, consistently good illumination over a variety of scales, camera positions, and view angles. To render this image sequence, LightKit's parameters were adjusted slightly from their defaults to preserve the highlights on the brain surface. The same LightKit parameters were then used to render the rest of the images. Effective lighting is maintained. In some cases, of course, new objects of interest entering the scene will be too dark or too light to use the same light settings. In this case, one of LightKit's small number of intensity or position parameters could be tuned, animated, or automatically adjusted to compensate without major alteration of the lighting environment.</p><p>Most of the LightKit examples in this paper, taken from realworld medical visualization, are rendered using Slicer's default matte surface properties. LightKit is also useful in rendering more specular objects such as the colored spheres shown in <ref type="figure">Figure 4</ref>. The high contrast of the headlight image in the top image leads to a choice between a burnt out highlight or an overly dark image. In either case, the contour edges are again very dark. The varying specularities of the spheres alter the size of the specular highlight, but the highlight's symmetry with respect to the object reduces the apparent dimensionality of the spheres. In the LightKit example, the spheres are more evenly illuminated and the dominant specular highlight from the key light falls in a more natural location towards the top of the spheres. The specular highlights of the non-key sources are also visible. In the VTK LightKit implementation, we have chosen to partially attenuate the non-key highlights, while preserving the intensity of diffuse illumination, to reinforce the dominance of the key light.</p><p>A comparison of the effect of different lights in LightKit is shown in <ref type="figure">Figure 5</ref>. To generate this series of images, different LightKit lights were successively enabled. In image (a), illumination with only a key light demonstrates natural illumination but the same sort of excessive contrast that tends to plague headlights and other single light schemes. Image (b) shows less contrast below the cheek due to the presence of a fill light. The key and fill lights do not reach more backward-facing surfaces such as the one between the cheek and ear: the back lights can, as shown in image (c). This image may be perfectly acceptable for many visualization tasks. If the overall contrast of the subject's front surfaces is still too high, a headlight may be added to augment the key light as shown in image (d) (the key light's intensity will, in general, need to be reduced). In comparison, the headlight-only image (e) is both high contrast and unflattering to the subject.</p><p>The process of adding lights to a scene outlined in <ref type="figure">Figure 5</ref> is an excellent way to learn about LightKit's capabilities beyond just using the defaults: studio photographers often use a similar process, with real lights, to produce the exact appearance they want.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Perceptual justification</head><p>In general, LightKit is based on a mix of artistic practice, visualization requirements, and attention to human perception. While LightKit has not been subjected to rigorous human perception or performance studies, several of the ideas upon which it builds have been previously validated.</p><p>LightKit's key light provides dominant overhead illumination that mimics natural sources and aids in the correct interpretation of shape. It is well studied in human visual perception that we prefer a light source that is coming from above <ref type="bibr" target="#b2">[Brewster 1826</ref><ref type="bibr" target="#b15">][Rittenhouse 1786</ref>. Results from numerous psychophysical experiments that systematically examine this assumption have confirmed that human observers strongly bias a light source coming from above when interpreting a visual scene <ref type="bibr" target="#b0">[Berbaum et al. 1983]</ref> <ref type="bibr" target="#b5">[Gibson 1950</ref>] <ref type="bibr" target="#b14">[Ramachandran 1988</ref>]. In an attempt to quantify the preference of light source coming from above, <ref type="bibr" target="#b3">Curran and Johnston [Curran and Johnston 1996</ref>] deployed a shape perception task as a function of the position of the light source. They carried out a series of experiments <ref type="bibr" target="#b8">[Johnston and W. 1996</ref>] to compare stimuli generated through ray tracing computer graphics models <ref type="bibr" target="#b13">[Phong 1975]</ref> with that of real solid objects. With both types of stimuli, the perceived curvature remained accurate when the light source was either from above or from the side. The perceived curvature, however, decreased when the objects, real or virtual, were lit from below.</p><p>Our choice to attach LightKit's light sources to the camera by default was made more for pragmatic than perceptual reasons, and follows the practice of some other visualization systems. Requirements for globally or locally consistent illumination depend on application needs. There is some perceptual evidence that the motion of light sources illuminating a scene can be confused with properties of object motion within the scene itself. <ref type="bibr" target="#b9">Kersten and Mamassian [Kersten et al. 1997]</ref>, for instance, have shown that when a shadow moves in a scene due to the moving light source, observers believe that the object is moving instead of the light source. Their work supports the hypothesis that the human visual system incorporates a stationary light-source constraint in the perceptual processing of spatial layout of scenes. Shading changes due to light source motion may interfere with this constraint. Attaching lights to the virtual camera strongly limits these shading changes.</p><p>The justification for constraining light source color to the black body range, and for the creation of the warmth scale, is based on experience in graphic arts color calibration and color matching as well as on perceptual evidence. Colors in the range of 5,000K to 10,000K are widely used as white points for color monitors and print processes. Lucassen and Walraven <ref type="bibr" target="#b12">[Lucassen and Walraven 1996]</ref> have shown that observers have fairly good color constancy under natural illumination such as daylight (broadband illumination) within the range of 4,000K to 25,000K. Under a wide range of natural lighting colors, humans appear able to determine the true color of a surface and disregard the color component from the illumination itself.</p><p>When observers are subject to any chromatic illumination, even over a short period of time, they start to adapt and may perceive the illumination to be white and attribute all the color to the reflectance of the surface. This process is referred to as chromatic adaptation <ref type="bibr" target="#b11">[Kuriki and Uchikawa 1998</ref>]. If observers are allowed to choose light source color within an unrestricted range, they may unknowingly adapt, fully or partially, to a potentially extreme chromatic illumination. Any colors or textures assigned to the scene, or recognized and interpreted in the scene, may look very different under other lighting conditions. We conjecture that the range of incandescent colors may minimize this problem.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Conclusion</head><p>LightKit fills an outstanding need for a simple to use but effective lighting system in interactive visualization. Based on wellestablished principles of the visual arts, guidance from human perception, and experience in visualization and software design, LightKit constrains the lighting process to encourage meaningful, attractive, and functional visualization results while making it harder to produce misleading or unappealing images. By starting with LightKit's default settings and adjusting a small number of controls, a user can quickly learn how to illuminate a scene. More advanced users have plenty of flexibility to bring out important features of their data using lighting.</p><p>Through its combination of subject-centric, camera-relative geometry, spherical lighting coordinate system, perceptuallymotivated light placement, ratio-based intensity adjustment, and natural light colors, LightKit helps make good lighting be fast and easy.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 6 :</head><label>6</label><figDesc>Key light illumination of a sphere showing different warmth values.</figDesc></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1">Some applications may wish to further restrict the range of colors available to the user by permitting only colors from the middle of the warmth range to be chosen, eliminating the most saturated blues and reds.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgments</head><p>The authors wish to thank Steve Pieper, Wendy Plesniak, and the Vis reviewers for their comments on LightKit and this document, and Ron Kikinis and Ferenc Jolesz for their ever-present support. This work was funded as part of the Visualization Core of the Neuroimage Analysis Center, NCRR grant P41RR13218, and under NIH grant R25CA89017-01.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix: the warmth scale</head><p>LightKit's warmth scale was computed using a color temperature to RGB converter called specren written by John Walker <ref type="bibr" target="#b18">[Walker 2003</ref>]. Warmth over a range of color temperatures was found by converting values in the range into the RGB color space and white balancing them to the color of the middle of the temperature range. Each RGB color was then normalized so that its largest color component was equal to one, brightening the colors as much as possible without clipping.</p><p>The final color temperature range was chosen by repeated trial so that the luminance of the warmth values 0 and 1 were equal and approximately half of full intensity. The color temperatures that correspond to the ends of the warmth scale are 3750K and 1025K, values which only make sense because of white balancing to the middle value of the range.</p><p>As a final modification to the warmth scale, approximately neutral color values near the middle of the warmth scale were emphasized by sampling the warmth function non-linearly. If W l (x) is the linear normalized warmth scale described above, the final warmth function W (x) is defined as follows:</p><p>where α is the emphasis parameter, with a value of 2.5 chosen experimentally. To improve performance, the VTK LightKit implementation approximates the warmth function by sampling the continuous function at discrete points (typically 128 samples or more) and linearly interpolating intermediate values.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Light source position in the perception of object shape</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Berbaum</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Bever</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Et Al</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Perception</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="411" to="416" />
			<date type="published" when="1983" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Digital Lighting and Rendering</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Birn</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2000" />
			<publisher>New Riders Publishing</publisher>
			<pubPlace>Indianapolis, Indiana</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">On the optical illusion of the conversion of cameos into intaglios and of intaglios into cameos, with an account of other analogous phenomena</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Brewster</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Edinburgh Journal of Science</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="99" to="108" />
			<date type="published" when="1826" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">The effect of illuminant position on perceived curvature</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Curran</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Johnston</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Vision Research</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page" from="1399" to="1410" />
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Gallardo</surname></persName>
		</author>
		<title level="m">3D Lighting: History, Concepts, and Techniques. Charles River Media</title>
		<meeting><address><addrLine>Rockland, Massachusetts</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">The perception of the visual world</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">J</forename><surname>Gibson</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1950" />
			<pubPlace>Houghton Mifflin; Boston</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">A non-photorealistic lighting model for automatic technical illustration</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Gooch</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Gooch</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">S</forename><surname>Shirley</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Cohen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of SIGGRAPH 98</title>
		<meeting>SIGGRAPH 98</meeting>
		<imprint>
			<date type="published" when="1998" />
			<biblScope unit="page" from="447" to="452" />
		</imprint>
	</monogr>
	<note>Annual Conference Series</note>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Maximum entropy light source placement</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Gumhold</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the conference on Visualization &apos;02</title>
		<meeting>the conference on Visualization &apos;02</meeting>
		<imprint>
			<publisher>IEEE Press</publisher>
			<date type="published" when="2002" />
			<biblScope unit="page" from="275" to="282" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Investigating shape-from-shading illusions using solid objects</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Johnston</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Vision Research</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page" from="2827" to="2835" />
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Moving cast shadows induce apparent motion in depth</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Kersten</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Mamassian</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Et Al</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Perception</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="171" to="192" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Inc</forename><surname>Kitware</surname></persName>
		</author>
		<ptr target="http://www.vtk.org/" />
		<imprint>
			<date type="published" when="2003-04" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Adaptive shift of visual sensitivity balance under ambient illuminant change</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Kuriki</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Uchikawa</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Opt Soc Am A Opt Image Sci Vis</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="2263" to="2274" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Color constancy under natural and artificial illumination</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Lucassen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Walraven</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Vision Research</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page" from="2699" to="2711" />
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title level="m" type="main">Illumination for Computer Generated Pictures. j-CACM 18</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B.-T</forename><surname>Phong</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1975" />
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="311" to="317" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Perceiving shape from shading</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><forename type="middle">S</forename><surname>Ramachandran</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Scientific American</title>
		<imprint>
			<biblScope unit="volume">259</biblScope>
			<biblScope unit="page" from="76" to="83" />
			<date type="published" when="1988" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Explanation of an optical deception</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Rittenhouse</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Transactions of the American Philosophical Society</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="37" to="42" />
			<date type="published" when="1786" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Automatic lighting design using a perceptual quality metric</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Shacked</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Lischinski</surname></persName>
		</author>
		<idno>1067-7055</idno>
	</analytic>
	<monogr>
		<title level="j">Computer Graphics Forum</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title level="m" type="main">Slicer home page</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Surgical</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Lab</surname></persName>
		</author>
		<ptr target="http://www.slicer.org/" />
		<imprint>
			<date type="published" when="2003-04" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Walker</surname></persName>
		</author>
		<ptr target="http://www.fourmilab.ch/documents/specrend/" />
		<imprint>
			<date type="published" when="2003-04" />
		</imprint>
	</monogr>
	<note>specrend home page</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
