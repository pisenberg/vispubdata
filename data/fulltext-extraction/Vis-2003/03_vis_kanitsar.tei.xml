<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Advanced Curved Planar Reformation: Flattening of Vascular Structures</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Armin</forename><surname>Kanitsar</surname></persName>
							<email>kanitsar@cg.tuwien</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Graphics and Algorithms † Department of Radiology</orgName>
								<orgName type="institution">TIANI Medgraph Vienna University of Technology Stanford University</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Rainer</forename><surname>Wegenkittl</surname></persName>
							<email>rainer.wegenkittl@tiani.com</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Graphics and Algorithms † Department of Radiology</orgName>
								<orgName type="institution">TIANI Medgraph Vienna University of Technology Stanford University</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dominik</forename><surname>Fleischmann</surname></persName>
							<email>dominik.fleischmann@univie.ac.at</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Graphics and Algorithms † Department of Radiology</orgName>
								<orgName type="institution">TIANI Medgraph Vienna University of Technology Stanford University</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Meister</forename><forename type="middle">Eduard</forename><surname>Gröller</surname></persName>
							<email>meister@cg.tuwien</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Computer Graphics and Algorithms † Department of Radiology</orgName>
								<orgName type="institution">TIANI Medgraph Vienna University of Technology Stanford University</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Advanced Curved Planar Reformation: Flattening of Vascular Structures</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-19T20:51+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>J.3.2 [Computer Applications]: Life and Medical Sciences-Medical Information Systems I.3.3 [Computing Methodologies]: Computer Graphics-Picture/Image Generation computed tomography angiography</term>
					<term>vessel analysis</term>
					<term>curved planar reformation</term>
				</keywords>
			</textClass>
			<abstract>
				<p>Traditional volume visualization techniques may provide incomplete clinical information needed for applications in medical visualization. In the area of vascular visualization important features such as the lumen of a diseased vessel segment may not be visible. Curved Planar Reformation (CPR) has proven to be an acceptable practical solution. Existing CPR techniques, however, still have diagnostically relevant limitations. In this paper we introduce two advanced methods for efficient vessel visualization, based on the concept of CPR. Both methods benefit from relaxation of spatial coherence in favor of improved feature perception. We present a new technique to visualize the interior of a vessel in a single image. A vessel is re-sampled along a spiral around its central axis. The helical spiral depicts the vessel volume. Furthermore, a method to display an entire vascular tree without mutually occluding vessels is presented. Minimal rotations at the bifurcations avoid occlusions. For each viewing direction the entire vessel structure is visible.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Non-invasive imaging of the vascular system with computed tomography (CT) and magnetic resonance imaging (MRI) has become a well established alternative to invasive intraarterial angiography. CT and MRI provide high-resolution volumetric data sets of the human body. These data, however, may contain many objects of less or no diagnostic interest. This makes volume-rendering (i.e., Maximum Intensity Projection (MIP), ray casting, shaded surface display) without preprocessing often impossible or inaccurate.</p><p>CPR -Curved Planar Reformation is a way to visualize vascular structures with small diameter. High level information as the vessel's centerline is used to re-sample and visualize the data. By this technique the entire tubular structure is displayed within a single image. Vascular abnormalities (i.e., stenoses, occlusions, aneurysms and vessel wall calcifications) are then investigated.</p><p>Current CPR techniques allow the investigation of the vessel lumen in a longitudinal section through the central axis of the vessel. However, vascular abnormalities might not be touched by this plane and therefore they do not appear in the generated image. One way to overcome this problem is to rotate the re-sampled plane around the central axis. This results in a set of images to be interpreted by the radiologist. A more comprehensive display of the entire vascular lumen in one representative image is highly desirable. A new visualization method was developed to overcome this limitation.</p><p>Another important aspect in computed tomography angiography (CTA) is the efficient visualization of treelike vascular structures using CPR display techniques. Multi-path CPR techniques based on a projective combination of vessel segments provide a spatially coherent display of the vascular anatomy. Depending on the intersecting plane, parts of the arteries might be superimposed by other arteries . For a detailed inspection of the entire vascular tree different sections through the vessel's central axis have to be re-sampled. In order to have diagnostically valuable results the vessel lumen should be visible within each image. Thus a new technique for unobstructed displaying of an arterial tree is proposed.</p><p>Section 2 describes related work in this area. In Section 3 a new method for visualizing the interior of a vascular structure is presented. A technique for displaying the entire vascular tree without <ref type="bibr">IEEE Visualization 2003</ref><ref type="bibr">, October 19-24, 2003</ref>, Seattle, Washington, USA 0-7803-8120-3/03/$17.00 ©2003 IEEE </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Related Work</head><p>The most important prerequisite for CPR visualization is an appropriate estimation of the vessel centerline. Latest CT technology, such as multiple detector-array CT, provide high resolution volumetric data sets. Due to the large size of these data sets (up to 1900 transverse cross-sectional images of the abdomen and entire legs), the manual definition of the vessel centerline is no longer an option. In this respect several algorithms <ref type="bibr" target="#b5">[Kanitsar et al. 2001;</ref><ref type="bibr" target="#b9">Wink et al. 2000;</ref><ref type="bibr" target="#b10">Zahlten et al. 1994]</ref> have been developed with different properties concerning reliability, speed and accuracy.</p><p>Avants and Williams presented a vessel tracking method consisting of two parts <ref type="bibr" target="#b1">[Avants and Williams 2000]</ref>. From user defined seed points a surface expansion is computed based on the eikonal partial differential equation. A minimal cost path is calculated from these regions. From this path a cross-sectional area/radius profile is generated. <ref type="bibr" target="#b4">He et al. [2001]</ref> proposed a path extraction method based on a two-dimensional region-growing algorithm with a subsequent shortest path algorithm. The resulting path was refined using the multi-scale medial response. The vascular tree is flattened in a semiautomatic method called Medial Axis Reformation.</p><p>Some authors propose to take the central axis as an input for the generation of an abstract vessel model. Abstract vessel models allow fast rendering, as polygonal meshes of low complexity are generated <ref type="bibr" target="#b2">[Felkel et al. 2002]</ref>. Furthermore non-photorealistic rendering provides the possibility to emphasize global properties of the vascular tree <ref type="bibr" target="#b3">[Hahn et al. 2001]</ref>. <ref type="bibr" target="#b6">Kanitsar et al. [2002]</ref> compared three methods for CPR generation: Projected CPR, stretched CPR and straightened CPR. In addition three extensions to CPR have been proposed to overcome the most relevant clinical limitations: Thick CPR, rotating CPR and multi-path CPR. The latter provides a display of a whole vascular tree within one image. While superimposition of bones and arteries is prevented, the intersection of arteries itself is not avoided.</p><p>Further information about the clinical relevance of the CPR visualization technique can be found in <ref type="bibr" target="#b0">[Achenbach et al. 1998;</ref><ref type="bibr" target="#b7">Koechl et al. 2003;</ref><ref type="bibr" target="#b8">Rubin et al. 2001]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Helical CPR</head><p>The basic idea of helical CPR visualization is to display the volumetric interior of a vessel within one image.  . The latter might be defined in a local coordinate system of the central axis. In any case the data are re-sampled in a linear way defined by the vector vi. The vector-of-interest describes the re-sampling direction which is orthogonal to the viewing direction. The helical CPR method is based on a non-linear re-sampling of the data. The vector-of-interest as generating element for the surface is replaced by a spiral-of-interest (si) (see <ref type="figure" target="#fig_0">Figure 2b</ref>). This results in a convoluted surface around the central axis. At a sufficiently small distance between each winding the vessel is intersected several times. Stenoses, calcifications, and occlusions are included in the computed surface. The helical surface is flattened and displayed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Method Description</head><p>The helical CPR visualization technique is based on the straightened CPR method. Along the central axis of the vessel crosssections are calculated at an appropriate sampling distance. Within each section a local 2D coordinate system is defined. The center of the cross-section represents the estimated center of the vessel lumen from the corresponding center-line position. Starting from this center point two interleaved spirals s 1 and s 2 are computed (see <ref type="figure" target="#fig_1">Figure 3a)</ref>. In order to maintain a uniform sampling of the vessel cross-sections a spiral with constant inter-winding distance was selected. This requirement is satisfied by the Archimedean spiral which can be expressed in a simple equation using polar coordinates r and θ :</p><formula xml:id="formula_0">r = aθ (1)</formula><p>The transformation of points on the curve into Cartesian coordinates is straightforward. Thus the computation of each point X s 1 on s 1 and X s 2 on s 2 is performed as follows:</p><formula xml:id="formula_1">X s 1 = aθ cos θ sin θ X s 2 = aθ cos θ sin θ where θ = θ + π</formula><p>(2) For an appropriate sampling of the vessel lumen the parameter a was set to 1/π. This assures a constant distance of one between the windings of the two interleaved spirals. The computed points X s 1 and X s 2 on the spiral are transformed back into volume space and re-sampled.</p><p>The center of each row in the final CPR image corresponds to the center of the vessel cross-section. Starting from this reference point the image space to the left is filled with data re-sampled by s 1 and to the right with data from s 2 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Sampling Strategy</head><p>The current implementation of the helical CPR technique supports two sampling strategies for computing points from the spiral. In the case of constant angle sampling (see <ref type="figure" target="#fig_1">Figure 3b</ref>) the angle θ is increased by a constant angle ω for each point. If constant arclength sampling is applied (see <ref type="figure" target="#fig_1">Figure 3c</ref>) for each sampling step a constant distance ∆ on the arc-length of the spiral is covered.</p><p>Constant angle. For each point re-sampled from the spiral the generating angle θ is incremented by a fixed angle ω. Each winding is rendered into an equal sized area in the final image. Therefore the comparably dense sampled area in close vicinity of the vessel center is amplified in image space. The resulting fish-eye zooming effect is achieved at the cost of increased distortion.</p><p>Constant arc-length. Given a fixed sampling distance ∆ between two adjacent points on the spiral the increment ω of the angle θ is approximated. The increment ω is defined by the ratio of ∆ and the circumference calculated from the most recent radius. As usually small sampling distances are used the error introduced by this approximation is negligible. The extent of the vessel in the CPR image is directly proportional to the volume of the vessel lumen. Thus large vessels occupy a superproportional large image space.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Phantom Dataset</head><p>The images generated by helical CPR visualization provide a quite unconventional display of vascular structures. Therefore a phantom dataset containing a set of typical vascular abnormalities was computed. By means of this dataset the typical patterns of each anatomical case are demonstrated (see <ref type="figure" target="#fig_2">Figure 4)</ref>.</p><p>The simulated vessel of the phantom dataset contains a semicircumferential vessel wall calcification, and a circumferential vessel wall calcification without luminal stenosis. An eccentric "softplaque" stenosis and a segmental concentric high-grade stenosis was also simulated, respectively (top-down order). <ref type="figure" target="#fig_2">Figure 4a</ref> shows a direct volume rendering display of this simulated vessel. From this visualization method the flow channel within the circular vessel wall calcification can not be gauged. A coronal and sagittal straightened CPR is presented in <ref type="figure" target="#fig_2">Figure 4b</ref> and c. The partial vessel wall calcification as well as the eccentric stenosis are not visible in the sagittal straightened CPR. This demonstrates the need for different longitudinal sections. <ref type="figure" target="#fig_2">Figure 4d</ref> and e show the result of the helical CPR technique with constant arc-length and constant angle sampling. The vertical lines indicate the image space required for one winding. Partial vessel abnormalities tend to reoccur in a separated fashion several times in the image whenever the area is intersected by a winding. Vessel pathologies clearly stand out in the helical CPR images. The helical CPR "peels-off" the bloodvessel. Thus the extent of abnormalities is enhanced.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Results</head><p>The application of a helical CPR technique on a real world dataset is presented in <ref type="figure" target="#fig_3">Figure 5</ref>. A constant angle and constant arc-length sampled helical CPR display is compared to a straightened CPR image. In contrast to the straightened CPR the helical CPR shows the area of the vessel lumen instead of the diameter. The white arrow illustrates an example where the helical CPR outperforms a traditional CPR. The small flow-channel of the stenosis is not touched by the displayed longitudinal section of the straightened CPR and therefore not visible. However in both helical images this flowchannel is displayed. As eccentric lesions cause repetitive patterns in the image space, the attention of the observer is immediately drawn to those areas even if a lesion is not visible in a standard CPR display.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Untangled CPR</head><p>The aim of untangled CPR visualization is to display a vascular tree without overlapping arteries. This is independent from the spatial position of the intersecting plane. In order to accomplish this requirement the spatial relations of the projected vessels have to be relaxed. Branching points of the vessel tree are used as pivot points. Rotating the corresponding vessels around these pivot points in image space eliminates vessel overlaps. Keeping the introduced distortions small maintains fast perception and reduces the impact of re-sampling artifacts in the final image. Thus the applied transformations are restricted to the branching points (bifurcations) of the arterial tree. In addition to that this transformations should be appropriate in terms of changing the tree layout and appearance without violating the non-intersection criterion. The non-intersection criterion is defined in a way that two vessel hulls must not intersect at any time. The definition of a vessel hull is described below.</p><p>The new CPR technique is based on the stretched CPR and multipath CPR method introduced by Kanitsar et. al. <ref type="bibr" target="#b6">[Kanitsar et al. 2002]</ref>. This method maintains the curvature of the vessel to a high extent and preserves isometry. The vessel's curvature is crucial in approximating a geometrically undistorted appearance of the vessel tree. Isometry on the other hand is important for vascular investigations. Stent planning and stenosis-grading estimation are possible in the final image.</p><p>The input of the algorithm is a tree graph representing the topology of the vascular structure. For each vessel segment the center line of the vessel is stored as a set of adjacent points at an appropriate sampling distance. In practice it turned out that diameter estimations of vessels are not reliable enough in certain cases. Therefore for the purpose of generality the algorithm does not take diameter information into account. However, the adaptation to this additional information would be straightforward.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Method outline</head><p>The untangling CPR method consists of four main steps. As all untangling calculations are performed in image space the tree graph is first mapped to image space using a stretched CPR projection. In a consecutive step the transformation of each subtree with respect to the non-intersection criterion is performed. Afterwards the image space is partitioned in a way that each vessel obtains those parts of the image space which are closest in scan-line direction. Finally the image is rendered.</p><p>Tree projection. The vascular tree is mapped to a projection plane coplanar to the viewing plane. For each two successive points on a vessel path the subsequent point is rotated around an axis defined by the previous point and the vector-of-interest. The rotation is carried out for each point starting from the root of the vascular tree. The result is a stretched vascular tree.</p><p>Untangling operation. From the projected tree graph in image space the necessary transformations for each node are calculated. This is done by recursively circumscribing the subtrees with vessel hulls. The first pass is bottom up maintaining only the correct transformation of the largest enclosing vessel hull. In a second pass the final transformation for each vessel hull segment is accumulated top down.</p><p>Image space partitioning. Before rendering the final image the extent of each vessel segment is cropped in a way that no overlapping image areas remain. This process determines the starting point and the end point of each scan line for rendering.   </p><formula xml:id="formula_2">v right v right ' v left v left '</formula><p>e e <ref type="figure">Figure 6</ref>: The vessel hull primitive</p><p>Rendering. Each vessel strip is rendered separately. Conceptually the vessel strip is first extracted from the dataset using a stretched CPR mapping. Afterwards the strip is transformed to the position defined by the untangling process. In a further step the strip is clipped according to the space partitioning information. Finally each cropped scan line is rendered into the image.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">The vessel hull primitive</head><p>The vessel hull is the basic primitive for further intersection tests. It encloses the vessel's centerline in image space as shown in <ref type="figure">Figure 6</ref>. The centerline is given as a set of points P = {P 0 ..P n−1 }. A vessel hull is a sector of a circle. The root of a vascular subtree defines the center point H center . A matrix ℜ H center associated with each center point describes a rotational transformation of the subsequent tree.</p><p>The points H right and H le f t result from a conservative estimation of the leftmost and rightmost extent of the enclosing subtree seen from the center point. The vessel hull encloses the centerline of the vessel thus two neighboring vessels touching each other is not prevented by this primitive. To overcome this situation the vessel hull is enlarged by a small angle ε as depicted in <ref type="figure">Figure 6</ref>. Depending on the size of the inspected vessels this ε may be adjusted by the user on the fly. However an ε ≤ 2 • was found to be appropriate for most tested datasets. If the vessel diameter is known at the extremal points P i and P j then ε can be easily calculated more accurately. The points comprising the ε-tolerance are referred to as H right and H le f t .</p><p>Each vessel hull primitive can be described as a tuple of</p><formula xml:id="formula_3">V = {H center , H le f t , H right , ℜ H center } where v le f t = −−−−−−−→ H center H le f t and v right = − −−−−−−− → H center H right .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Putting things together</head><p>A rule based approach is applied for combining vessel hulls from various parts of the vascular tree (see <ref type="figure" target="#fig_4">Figure 7)</ref>.  Case 1. The center point H center is defined by the first point P 0 of the vessel segment. The first point on the convex hull of the vessel segment in clockwise orientation is denominated as point P i and in counterclockwise direction as point P j . Because of the stretched CPR mapping from volume to image space, point P n−1 is the point with maximum distance from P 0 . Thus the radius of the vessel hull is computed as |P n−1 − P 0 |. The normalized vectors v le f t and v right represent the directions from H center to P i and P j respectively. These vectors are scaled according to the radius of the vessel hull. The tolerance angle ε is incorporated by a transformation with ℜ ε and ℜ −ε . Finally H right and H le f t are computed.</p><p>Case 2. For the case of two adjacent vessel hull primitives (V 1 and V 2 ) (see <ref type="figure" target="#fig_4">Figure 7)</ref> the ordering of the subtrees has to be determined first. According to this decision the left vessel hull with respect to H center = H 1 center = H 2 center is denominated as V l and the right one as V r . If the vessel hull primitives overlap, an untangling angle γ is computed from v r le f t and v l right (see <ref type="figure">Figure 11a</ref>). From this angle the rotational matrices ℜ H r center and ℜ H l center are calculated. These matrices define a transformation of the vessel hull primitives V r and V l in a way that the primitives do not overlap anymore. This implies a transformation of the associated vascular subtree (see <ref type="figure">Figure 11a)</ref>. If the vessel hull primitives do not overlap the matrices are simply the identity matrices.</p><p>The vectors v le f t and v right of the combined vessel hull are computed from the transformed vectors v l le f t and v r right . The radius of the enclosing vessel hull is defined by the maximum radius of V 1 and V 2 . From this information H le f t and H right is computed. The newly generated vessel hull encloses the non-overlapping underlying vessel hulls.</p><p>Case 3. The combination of two successive vessel hulls is straightforward. V 1 is considered to be the predecessor of V 2 as depicted in <ref type="figure" target="#fig_4">Figure 7</ref>. H 1 center is taken as the new center point H center of the enclosing vessel hull. The direction to the rightmost point of H 1 right and H 2 right with respect to H center is considered to be v right . Vector v le f t is calculated likewise. The radius of the new vessel hull V is defined by the maximum distance from H center to H 1 right , H 1 le f t , H 2 right , and H 2 le f t . Case 3 is similar to the 2 nd case. However no additional transformation is introduced during this step since undersampled areas would occur under these circumstances (see <ref type="figure">Figure 11b</ref>). Any treelike vascular structure can be processed using this set of rules. One bifurcation for instance is subdivided into three cases 1, one case 2 and, one case 3. The recursive algorithm finishes with a hierarchy of enclosing vessel hulls where the root hull contains the entire vessel tree. A detailed description of each assembling case in abstract notation is given in <ref type="figure" target="#fig_5">Figure 8</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Layout definition</head><p>The decision of the vessel hull ordering in case 2 has a significant impact on the layout of the displayed vascular tree. Two different approaches have been investigated (see <ref type="figure">Figure 9</ref>). One possibility is a left-to-right ordering based on the spatial relations of the vascular tree according to the currently used viewing direction. In this case the ordering is based on the spatial location of the vessel hulls according to the current viewing direction. This approach is referred to as adaptive layout. In contrast to that a fixed layout was investigated, too. The fixed layout is independent from the viewing direction. In the present prototype implementation the vessel ordering of the coronal display is maintained for all viewing directions. For clinical routine applications a standardized ordering might be a reasonable solution. According to this standardization the leftmost artery for peripheral CTA examinations might be the left deep femoral artery (profunda femoris) followed by the left anterior tibial artery and so on.</p><p>The advantage of an adaptive tree layout is a more efficient utilization of image space and less distortion introduced by the untangling operation compared to a fixed layout. The introduced distortion measured by the sum of untangling angles γ over a 360 • rotation of a peripheral CTA dataset is depicted in <ref type="figure" target="#fig_7">Figure 10</ref>. However, in the case of an adaptive tree layout discontinuities occur whenever the order of the vessels changes. Thus the inspection of a sequence of images becomes more difficult as the identification of each vascular segment becomes more difficult. Labelling the vessel segments eases this limitation for examinations carried out on a set of images.  </p><formula xml:id="formula_4">V 1 V 2 V 1 V 2 V 1 V 2 V 1 V 2</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.5">Image space partitioning</head><p>Bevor rendering the final image the image space has to be partitioned into fragments for each vascular structure. This step is necessary because arteries are possibly obscured by bones if multiple layers are rendered into a single image area <ref type="bibr" target="#b6">[Kanitsar et al. 2002]</ref>.</p><p>A principle drawing direction is associated with each vessel segment. Each point of the projected vessel center line maintains a scan line deduced from this principal drawing direction. These scan lines are transformed according to the rotational matrix ℜ H center (see <ref type="figure">Figure 11a</ref>). The scan lines represent those parts of the image in which the corresponding re-sampled data from the dataset are rendered into. Because of the applied transformations the scan lines need not be aligned to the pixel rows of the image.</p><p>In order to avoid overlapping areas an appropriate start and endpoint for each scan line has to be determined. For this reason a special sort of distance map is created every time an image is rendered. This distance map is defined by the projected center lines of the vessel tree and its scan lines. In contrast to the traditional distance map the distance metric is not defined by an Euclidean distance but by a distance along scan lines. The result of this operation is a fragmented image space where each vessel segment is assigned a maximal image area.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.6">Results</head><p>A comparison of a stretched multi-path CPR and an untangled CPR is presented in <ref type="figure" target="#fig_0">Figure 12</ref>. In an anterior view the results of the compared methods are rather similar, because there are only few overlapping arteries. In the case of a lateral view the multi-path CPR display provides hardly any diagnostically relevant information. Many superimposed arteries obscure each other. In comparison to that the untangled CPR still provides an unobstructed view of the entire vascular tree. Each vessel segment is displayed in di-  <ref type="figure">Figure 11</ref>: Image space partitioning agnostic quality. For instance the stenosis, heavy calcification, and a long occlusion in the left superficial femoral artery is clearly visible. For both untangled CPRs a fixed layout was used. <ref type="figure" target="#fig_1">Figure 13</ref> presents a sequence of untangled CPR images from an abdominal CT-angiographic dataset. A fixed layout was used. A 1D transfer function was applied to the re-sampled data approximating the tissue color of the anatomical structures. Areas of arterial wall calcification are shown in the distal abdominal aorta (225 • ) and in the left internal iliac artery (270 • ). The abdominal aorta is the main vessel in the upper half of the image. It is branching into the left and right iliac (pelvic) arteries where left and right in the image is interchanged due to the patient orientation. The pelvic artery branches into the thicker external pelvic artery and the thinner inner pelvic artery.</p><p>Even though the examination is intended to be done on a small set of pre-computed images, the performance of the algorithm is acceptable for applications in the clinical workflow. The displayed untangled CPR image in <ref type="figure" target="#fig_0">Figure 12</ref> was calculated from a real world dataset with a scanned resolution of 512x512x988 voxel and an original image size of 1164x1097 pixel. The average rendering time per image of the current Java based implementation on a PC workstation with an Intel PIII 1GHz main processor took 2.3 seconds.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Conclusions and Discussion</head><p>Two methods for efficient vessel visualization were proposed. In both methods the spatial coherence of the investigated objects is relaxed to a certain degree. With the helical CPR the dataset is resampled in a spiral manner making the entire vessel visible. Small distortions of the vascular tree prevent self-intersections in the case of the untangled CPR.</p><p>The helical CPR technique is a new way to display the volume of vascular structures. The motivation for this visualization technique was not an imitation of the natural appearance of the object but the revelation of diseased vessel segments. Helical CPR visualizes the interior of a vessel in a single image. Re-sampling a spiral around the vessel central axis does not involve any compositing of samples. Therefore no features of the vessel are hidden by other structures as long as the vessel area is sampled densely enough. An explorative study has shown that the detection of vessel abnormalities is possible from such visualizations which literally peel-off the vessel volume. A particularly attractive future application of this technique is visualization of coronary artery diseases from recently developed electrocardiographically gated CT.</p><p>The untangled CPR has significant advantages over existing multi-path CPR techniques. This new technique produces an unobscured display of a vascular tree, independent of the viewing direction. Small rotations around the branching points of a vessel tree eliminate occlusions. Therefore the size of the introduced distortion is kept small.</p><p>Even though the use of image space is not optimal, the main requirement of unobscured display of vessels from any viewing direction is fulfilled. In addition, untangled CPR preserves isometry which is an important requirement for vascular lesion assessment. The potential for clinical application of this technique is obvious: A more efficient way to assess any complex arterial trees for the presence and extent of vascular disease. Clinical validity and applicability to other vascular territories are currently investigated.  <ref type="figure" target="#fig_0">Figure 12</ref>: A peripheral CTA dataset rendered from coronal and sagittal view using stretched multi-path CPR (a, c) and untangled CPR (b, d) respectively (fixed layout) <ref type="figure" target="#fig_1">Figure 13</ref>: A color coded sequence of untangled CPR images from different viewing directions.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 2 :</head><label>2</label><figDesc>Traditional CPR (a), and helical CPR (b) generation. overlapping arteries is presented in Section 4. Possible improvements and conclusions are discussed in Section 5.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 3 :</head><label>3</label><figDesc>Spiral-of-interest (a), constant angle sampling (b), constant arc-length sampling (c) of a surface intersecting the volume. This surface is defined by the central axis of the vessel and a vector-of-interest (vi) (seeFigure 2a)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 4 :</head><label>4</label><figDesc>Phantom dataset: Direct volume rendering (a); Coronally (b) and sagittally (c) straightened CPR; helical CPR with constant arc-length (d) and fixed angle (e).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 5 :</head><label>5</label><figDesc>A helical CPR with constant angle sampling (a), a straightened CPR (b), and constant arc-length sampled helical CPR (c) of a real world dataset.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 7 :</head><label>7</label><figDesc>The three vessel hull combination cases.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 8 :</head><label>8</label><figDesc>Assembling of vessel hulls.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head></head><label></label><figDesc>p ti v e la y o u t</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>FigureFigure 10 :</head><label>10</label><figDesc>Comparison of introduced distortion.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>The projected vessel tree is approximated by an enclosing hierarchy of vessel hulls. This hierarchy is constructed bottom up. Combining two vessel hulls at a branching point involves a rotation around the common pivot point H center . This results in a new larger hull which bounds the entire subtree. Constructing the vessel hull hierarchy involves several cases which are discussed in the following. A vessel hull</figDesc><table><row><cell>P 0</cell><cell cols="2">H</cell><cell cols="3">1 center = H</cell><cell cols="2">2 center</cell><cell></cell><cell></cell><cell>H</cell><cell>1 center</cell></row><row><cell>P i</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>H</cell><cell cols="2">1 right</cell><cell>H</cell><cell>1 left</cell></row><row><cell>P j</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>H</cell><cell cols="2">2 center</cell></row><row><cell>P n-1</cell><cell>H</cell><cell cols="2">1 right</cell><cell>H</cell><cell cols="2">1 left right H 2</cell><cell>H</cell><cell>2 left</cell><cell></cell><cell>H</cell><cell>2 right</cell><cell>H</cell><cell>2 left</cell></row><row><cell>Case I</cell><cell></cell><cell></cell><cell cols="4">Case II</cell><cell></cell><cell></cell><cell cols="3">Case III</cell></row></table><note>created from the vessel centerline is based on case 1. Neighbor- ing vessel hulls are combined according to case 2. An enclosing vessel hull from two consecutive vessel hulls is created in case 3. The assembling process is done bottom up. This results in a binary tree of vessel hulls where each node is represented by a vessel hull circumscribing all subjacent vessel hulls.</note></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Acknowledgements</head><p>The authors would like to thank Michael Knapp for the generation of the phantom dataset. The work presented in this publication has been funded by the ADAPT project (FFF-804544). ADAPT is supported by Tiani Medgraph, Vienna (http://www.tiani.com), and the Forschungsförderungsfonds für die gewerbliche Wirtschaft, Austria. See http://www.cg.tuwien.ac.at/research/vis/adapt for further information on this project.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Case 1:</head><p>Case 2: </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Curved Multiplanar Reconstructions for the Evaluation of Contrast-Enhanced Electron-Beam CT of the Coronary Arteries</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Achenbach</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Moshage</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Ropers</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Bachmann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. Roentgenol</title>
		<imprint>
			<biblScope unit="page" from="895" to="899" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">An Adaptive Minimal Path Generation Technique for Vessel Tracking in CTA/CE-MRA Volume Images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Avants</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Williams</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">MICCAI 2001</title>
		<imprint>
			<date type="published" when="2000" />
			<biblScope unit="page" from="707" to="716" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title level="m" type="main">Surface Reconstruction Of The Branching Vessels For Augmented Reality Aided Surgery</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Felkel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Fuhrmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kanitsar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Wegenkittl</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002" />
			<biblScope unit="page" from="252" to="254" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Visualization and Interaction Techniques for the Exploration of Vascular Structures</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Hahn</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Preim</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Selle</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Peitgen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Visualization</title>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2001" />
			<biblScope unit="page" from="395" to="402" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Medial Axis Reformation: A New Visualization Method for CT Angiography</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Dai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Lu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Cao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Bai</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Jing</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Academic Radiology</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="726" to="733" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Computed Tomography Angiography: A Case Study of Peripheral Vessel Investigation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kanitsar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Wegenkittl</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Felkel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Fleischmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Sandner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Gröller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Visualization</title>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2001" />
			<biblScope unit="page" from="477" to="480" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">CPR -Curved Planar Reformation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kanitsar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Fleischmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Wegenkittl</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Felkel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">E</forename><surname>Gröller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Visualization</title>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2002" />
			<biblScope unit="page" from="37" to="44" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Comprehensive assessment of peripheral arteries using multi-path curved planar reformation of CTA datasts</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Koechl</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kanitsar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Lomoschitz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Groeller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Fleischmann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Europ. Rad</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="268" to="269" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Multi-Detector Row CT Angiography of Lower Extremity Arterial Inflow and Runoff: Initial Experience</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Rubin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Schmidt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Logan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Sofilos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Radiology</title>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="page" from="146" to="158" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Fast Delineation and Visualization of Vessels in 3-d Angiographic Images</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Wink</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Niessen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Viergever</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Medical Imaging</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="337" to="346" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Reconstruction of Branching Blood Vessels from CT-Data</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Zahlten</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Juergens</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Peitgen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Eurographics Workshop on Visualization in Scientific Computing</title>
		<imprint>
			<date type="published" when="1994" />
			<biblScope unit="page" from="161" to="168" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
