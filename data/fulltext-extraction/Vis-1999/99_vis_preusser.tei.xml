<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/pisenberg/grobid/grobid-0.6.1/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Anisotropic Nonlinear Diffusion in Flow Visualization</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Preußer</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Rumpf</surname></persName>
						</author>
						<title level="a" type="main">Anisotropic Nonlinear Diffusion in Flow Visualization</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.6.1" ident="GROBID" when="2021-02-19T20:41+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>flow visualization</term>
					<term>multiscale</term>
					<term>nonlinear diffusion</term>
					<term>segmentation</term>
				</keywords>
			</textClass>
			<abstract>
				<p>Vector field visualization is an important topic in scientific visualization. Its aim is to graphically represent field data in an intuitively understandable and precise way. Here a new approach based on anisotropic nonlinear diffusion is introduced. It enables an easy perception of flow data and serves as an appropriate scale space method for the visualization of complicated flow pattern. The approach is closely related to nonlinear diffusion methods in image analysis where images are smoothed while still retaining and enhancing edges. Here an initial noisy image is smoothed along streamlines, whereas the image is sharpened in the orthogonal direction. The method is based on a continuous model and requires the solution of a parabolic PDE problem. It is discretized only in the final implementational step. Therefore, many important qualitative aspects can already be discussed on a continuous level. Applications are shown in 2D and 3D and the provisions for flow segmentation are outlined.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The visualization of field data, especially of velocity fields from CFD computations is one of the fundamental tasks in scientific visualization. A variety of different approaches has been presented. The simplest method to draw vector plots at nodes of some overlayed regular grid in general produces visual clutter, because of the typically different local scaling of the field in the spatial domain, which leads to disturbing multiple overlaps in certain regions, whereas in other areas small structures such as eddies can not be resolved adequately. The central goal is to come up with intuitively better receptible methods, which gives an overall as well as detailed view on the flow patterns. Single particle lines only very partially enlighten features of a complex flow field. Thus, we want to define a texture which represents the flow globally on the computational domain. Here we confine ourselves to stationary flow fields v : ! R n for some domain R n . We ask for a method generating stretched streamline type patterns, which are aligned to the vector field vx. Furthermore, the possibility to successively coarsen this pattern is obviously an desirable property. Methods which are based on such a scale of spaces and enhance certain structures of images are wellknown in image processing analysis. Actually nonlinear diffusion allows the smoothing of grey or color images while retaining and enhancing edges <ref type="bibr" target="#b12">[13]</ref>. Now we set up a diffusion problem, with strong smoothing along streamlines and edge enhancing in the orthogonal directions. Applying this to some initial random noise image we generate a scale of successively coarser patterns which represent the flow field. Finite Elements in space and a semi implicit timestepping is applied to solve this diffusion problem numerically. Furthermore a suitable modification of the approach allows the identification of topological regions. Before we explain in detail the method, let us discuss related work on vector field visualization and image processing. Later on Institut für Angewandte Mathematik, Universität Bonn, Wegelerstraße 6, 53115 Bonn, Germany, tpreuss, rumpf@iam.uni-bonn. <ref type="bibr">de</ref> we will identify some of the well known methods as equivalent to special cases, respectively asymptotic limits of the presented new method.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Related Work</head><p>The spot noise method proposed by van Wijk <ref type="bibr" target="#b17">[18]</ref> introduces spot like texture splats which are aligned by deformation to the velocity field in 2D or on surfaces in 3D. These splats are plotted in the fluid domain showing strong alignment patterns in the flow direction. The originally first order approximation to the flow was improved by de Leeuw and van Wijk in <ref type="bibr" target="#b4">[5]</ref> by using higher order polynomial deformations of the spots in areas of significant vorticity. In an animated sequence these spots can be moved along streamlines of the flow. Furthermore in 3D van Wijk <ref type="bibr" target="#b18">[19]</ref> applies the integration to clouds of oriented particles and animates them by drawing similar moving transparent and illuminated splats. The Line Integral Convolution (LIC) approach of Cabral and Leedom <ref type="bibr" target="#b3">[4]</ref> integrates the fundamental ODE describing streamlines forward and backward in time at every pixelized point in the domain, convolves a white noise along these particle paths with some Gaussian type filter kernel, and takes the resulting value as an intensity value for the corresponding pixel. According to the strong correlation of this intensity along the streamlines and the lack of any correlation in the orthogonal direction the resulting texturing of the domain shows dense streamline filaments of varying intensity. Hege and Stalling <ref type="bibr" target="#b14">[15]</ref> increased the performance of this method especially by reusing portions of the convolution integral already computed on points along the streamline. Max et al. <ref type="bibr" target="#b11">[12]</ref> proposed a similar method on surfaces. Max and Becker <ref type="bibr" target="#b10">[11]</ref> presented a method for visualizing 2D and 3D flows by animating textures. Shen and Kao <ref type="bibr" target="#b13">[14]</ref> applied a LIC type method to unsteady flow fields. Recently a method <ref type="bibr" target="#b1">[2]</ref> has been presented, which generates streakline typ patterns by numerical calculation of the transport of inlet coordinates and inlet position. Interrante and Grosch <ref type="bibr" target="#b6">[7]</ref> generalized line integral convolution to 3D in terms of volume rendering of line filaments.</p><p>In <ref type="bibr" target="#b16">[17]</ref> Turk discusses an approach which selects a certain number of streamlines. They are automatically equally distributed all over the computational domain to characterize in a sketch type representation the significant aspects of the flow. An energy minimizing process is used to generate the actual distribution of streamlines.</p><p>Especially for 3D velocity fields particle tracing is a very popular tool. But a few particle integrations released by the user can hardly scope with the complexity of 3D vector fields. Zöckler et al. <ref type="bibr" target="#b15">[16]</ref> use pseudo randomly distributed, illuminated and transparent streamlines to give a denser and receptible representation, which shows the overall structure and enhances important details. Van Wijk <ref type="bibr" target="#b19">[20]</ref> proposed the implicit stream surface method. For a stationary flow field the transport equations v r = 0 are solved for given v and certain inflow and outflow boundary conditions in a pre-computing step. Then isosurfaces of the resulting function are streamsurfaces and can efficiently be extracted with interactive frame rates even for larger data sets.</p><p>Most of the methods presented so far have in common, that the generation of a coarser scale requires a recomputation. For instance, if we ask for a finer or coarser scale of the line integral con-volution pattern, the computation has to be restarted with a coarser initial image intensity. In case of spot noise larger spots have to be selected and their stretching along the field has to be increased. The approach to be presented here will incorporate a successive coarsening as time proceeds in the underlying diffusion problem.</p><p>As already mentioned in the introduction our method of anisotropic nonlinear diffusion to visualize vector fields is derived from well known image processing methodology. Discrete diffusion type methods are known for a long time. Perona and Malik <ref type="bibr" target="#b12">[13]</ref> have introduced a continuous diffusion model which allows the denoising of images together with the enhancing of edges. Alvarez, Guichard, Lions and Morel <ref type="bibr" target="#b0">[1]</ref> have established a rigorous axiomatic theory of diffusive scale space methods. Kawohl and Kutev <ref type="bibr" target="#b8">[9]</ref> investigate a qualitative analysis of the Perona and Malik model. Recovering of lower dimensional structures in images is analyzed by Weikart <ref type="bibr" target="#b20">[21]</ref>, who introduced an anisotropic nonlinear diffusion method where the diffusion matrix depends on the so called structure tensor of the image. A Finite Element discretization and its convergence properties have been studied by Kavcur and Mikula <ref type="bibr" target="#b7">[8]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">The nonlinear diffusion problem</head><p>Let us now derive our method based on a suitable PDE problem. Here, nonlinear anisotropic diffusion applied to some initial random noisy image will enable an intuitive and scalable visualization of complicated flow fields. Therefore, we pick up the idea of line integral convolution, where a strong correlation in the image intensity along streamlines is achieved by convolution of an initial white noise along the streamlines. As proposed already by Cabral and Leedom <ref type="bibr" target="#b3">[4]</ref> a suitable choice for the convolution kernel is a Gaussian kernel. On the other hand an appropriately scaled Gaussian kernel is known to be the fundamental solution of the heat equation. Thus, line integral convolution is nothing else than solving the heat equation in 1D on a streamline parametrized with respect to arclength. On pixels which are located on different integral lines the resulting image intensity is not correlated. Hence, the thickness of the resulting image patterns in line integral convolution is of the size of the random initial patterns, in general a single pixel. Increasing this size as it has been proposed by Kiu and Banks <ref type="bibr" target="#b9">[10]</ref> leads to broader stripes and unfortunately less sharp transitions across streamline patterns. As described so far, line integral convolution is a discrete pixel based method. It can be regarded as a discretized streamline diffusion process. If we ask for a wellposed continuous diffusion problem with similar properties, we are lead to some anisotropic diffusion, now controlled by a suitable diffusion matrix.</p><p>To begin with, let us at first review the basics of the nonlinear diffusion methods in image processing. We consider a function :</p><p>R + 0 ! Rwhich solves the parabolic problem @ @t , div Ar r = f ; in R + ; 0; = 0 ; on ; @ @ = 0 ; on R + @ for given initial density 0 : ! 0; 1 . Here = is a mollification of the current density, which will later on turn out to be necessary for the wellposedness of the above parabolic, boundary and initial value problem. In our setting we interprete the density as an image intensity, a scalar greyscale or -with a slight extension to the vector valued case -as a vector valued color. Thus, the solution can be regarded as a family of images f tg t2R + 0 , where the time t serves as a scaling parameter. Let us remark, that by the trivial choice A = 1 and f = 0 we obtain the standard linear heat equation with its isotropic smoothing effect. In image processing 0 is a given noisy initial image. The diffusion is supposed to be controlled by the gradient of the image intensity. Large gradients  mark edges in the image, which should be enhanced, whereas small gradients indicate areas of approximately equal intensity. Here denoising, i. e. intensity diffusion is considered. For that purpose we prescribe a diffusion coefficient</p><formula xml:id="formula_0">A = Gkr k</formula><p>where G : R + 0 ! R + is a monotone decreasing function with limd!1 Gd = 0 and G0 = where 2 R + is constant (cf. <ref type="figure" target="#fig_0">Fig. 1</ref>), e. g. Gd = 1+kdk 2 . If we would replace the mollified gradient r as argument of G by the true gradient r , which leads to the original Perona Malik model, we would in general obtain a backward parabolic problem in areas of high gradients, which is no longer wellposed <ref type="bibr" target="#b8">[9]</ref>. The invoked mollification avoids this shortcoming and comes along with a desirable presmoothing effect. Nevertheless the enhancing of steep gradients and thereby edges in the image, known from backward diffusion is retained if we adjust the mollification carefully. A suitable choice <ref type="bibr" target="#b7">[8]</ref> for this mollification is a convolution with the heat equation kernel for small times, that is solving the standard diffusion problem for the corresponding short period of time.  is the standard base in R n (cf. <ref type="figure">Fig. 3</ref>). We consider a diffusion matrix A = Av;r and define Av;d = Bv T kvk GdIdn,1 Bv</p><formula xml:id="formula_1">f = 0 ,</formula><p>where : R + ! R + controls the linear diffusion in vector field In general it does not make sense to consider a certain initial image.</p><formula xml:id="formula_2">B v v</formula><p>As initial data 0 we thus choose some random noise of an appropriate frequency range. This can for instance be generated running a linear isotropic diffusion simulation on a discrete white noise for a short time. Hence patterns will grow upstream and downstream, whereas the edges tangential to these patterns are successively enhanced. Still there is some diffusion perpendicular to the field which supplies us for evolving time with a scale of progressively coarser representation of the flow field. If we run the evolution for vanishing right hand side f the image contrast will unfortunately decrease due to the diffusion along streamlines. The asymptotic limit would turn out to be a averaged grey value. Therefore, we strengthen the image contrast during the evolution, selecting an appropriate function f : 0 ; 1 ! R + (cf. <ref type="figure">Fig. 4</ref>) with f0 = f1 = 0 , f 0 on 0:5; 1 , and f 0 on 0; 0:5 .</p><p>If we -at the first glance -neglect the diffusive term in the equation, one realizes that perturbations below the average value 0:5 are <ref type="figure">Figure 5</ref>: A single timestep is depicted from the nonlinear diffusion method applied to the vector field describing the flow around an obstacle at a fixed time. A discrete white noise is considered as initial data. We run the evolution on the top for a small and on the bottom for a large constant diffusion coefficient .</p><p>pushed towards the zero value and accordingly values above 0:5 are pushed towards 1. Well-known maximum principles ensure that the interval of grey values 0;1 is not enlarged running the nonlinear diffusion. Here the first property of f is of great importance. Finally we end up with the method of nonlinear anisotropic diffusion to visualize complex vector fields. Thereby we solve the nonlinear parabolic problem @ @t , div Av;r r = f starting from some random initial image 0 and obtain a scale of images representing the vector field in an intuitive way (cf. <ref type="figure">Fig. 5</ref>).</p><p>If we ask for pointwise asymptotic limits of the evolution, we expect an almost everywhere convergence to 1; 2 f 0; 1g due to the choice of the contrast enhancing function f. Analytically 0:5 is a third, but unstable fix point of the dynamics. Thus numerically it will not turn out to be locally dominant. The space of asymptotic limits significantly influences the richness of the developing vector field aligned structures. We may ask how to further on enrich the pattern which is settled by anisotropic diffusion. This turns out to be possible by increasing the set of asymptotic states. We no longer restrict ourselves to a scalar density but consider a vector valued : ! 0; 1 m for some m 1 and a corresponding system of parabolic equations. The coupling is given by the nonlinear diffusion coefficient G which now depends on the norm kr k of the Jacobian of the vector valued density r and the right hand side f. We define f = hk k with hs = fs=s for s 6 = 0 , wheref is the old right hand side from the scalar case, and h 0 = 0 . Furthermore we select an initial density which is now a discrete white noise with values in  B10 0; 1 m . Thus the contrast enhancing now pushes the point wise vector density either to the 0 or to some value on the sphere sector S m,1 0; 1 m in R m (cf. <ref type="figure" target="#fig_4">Fig. 6</ref>). Again a straightforward application of the maximum principle ensures t;x 2 S m,1 0; 1 m for all t and x 2 . <ref type="figure" target="#fig_5">Figure 7</ref> shows an example for the application of the vector valued anisotropic diffusion method applied to a convective flow field. An incompressible Bénard convection is simulated in a rectangular box with heating from below and cooling from above. The formation of convection rolls will lead to an exchange of temperature. Furthermore, <ref type="figure" target="#fig_6">Figure 8</ref> shows results of this method applied to several timesteps of the same convective flow. We recognize that the presented method is able to nicely depict the global structure of the flow field, including its saddle points, vortices, and stagnation points on the boundary. <ref type="figure" target="#fig_7">Figure 9</ref> shows results for the same data sets obtained by line integral convolution (Here we used the implementation of Hege and Stalling <ref type="bibr" target="#b14">[15]</ref>). Finally, <ref type="figure" target="#fig_0">Fig. 10</ref> shows a different application to a porous media flow field.   Lenses of lower permeability force the flow to pass through narrow bridges. We depict two timesteps of the diffusion process.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Application in 3D</head><p>The anisotropic nonlinear diffusion problem has been formulated in Section 3 for arbitrary space dimension. It results in a scale of vector field aligned patterns which we then have to visualize. This has already been done in a straightforward manner in the above figures. In 3D we have somehow to break up the volume and open up the view to inner regions. Otherwise we must confine ourselves with some pattern close to the boundary representing solely the shear flow.</p><p>Here a further benefit of the vector valued diffusion comes into operation. We know that for m = 2 the asymptotic limits -which differ from 0 -are in mean equally distributed on S 1 0; 1 2 .</p><p>Hence, we reduce the informational content and focus on a ball shaped neighbourhood B ! of a certain point ! 2 S 1 0; 1 2 . Now we can either look at isosurfaces of the function</p><formula xml:id="formula_3">x = k x , !k 2 ;</formula><p>where the isolevel 2 allows us to depict the boundary of the preimage of B ! with respect to the mapping (cf. <ref type="figure" target="#fig_0">Fig. 11</ref> and <ref type="figure" target="#fig_0">Fig. 12</ref>). Alternatively we might use volume rendering to visualize this type of subvolumes. A detailed discussion of the latter approach is beyond the scope of this paper.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Discretization</head><p>In what follows we discuss the discretization and implementation of the Field Aligned Diffusion method, which requires the solution of a system of nonlinear parabolic equations. For this purpose a Finite Element discretization in space and a semi implicit second order Crank Nicolsson scheme in time are considered. We have restricted ourselves to regular grids in 2D and 3D generated by recursive subdivision. On these grids we consider the bilinear, respectively trilinear Finite Element spaces. Numerical integration is based on the simplest quadrature rule, which evaluates the integrant <ref type="figure" target="#fig_0">Figure 11</ref>: The incompressible flow in a water basin with two interior walls and an inlet (on the left) and an outlet (on the right) is visualized by the anisotropic nonlinear diffusion method. Isosurfaces show the preimage of @B ! under the vector valued mapping for some point ! on the sphere sector. From top to bottom the radius is successively increased. A color ramp blue-green-red indicates an increasing absolute value of the velocity. The diffusion is applied to initial data which is a relatively coarse grain random noise. <ref type="figure" target="#fig_0">Figure 12</ref>: Nonlinear anisotropic diffusion applied to the same 3D data set as in <ref type="figure" target="#fig_0">Fig. 11</ref>, but with a fine grain white noise as initial data.</p><p>solely at the element's center point. These integration formulas are applied to compute the local stiffness matrices. The semi implicit character of our scheme means, that the nonlinearity Gr is evaluated at the old time. In each timestep the computation of is based on a single short implicit timestep for the corresponding heat equation with respect to initial data . We take into account mass lumping to calculate the local mass matrices. The regular grids are procedurally interpreted as quadtrees, respectively octtrees. Finally no matrix is explicitly stored. The necessary matrix multiplications in the applied iterative CG solver are performed in successive tree traversals. Hierarchical BPX type <ref type="bibr" target="#b2">[3]</ref> preconditioning is used to accelerate the convergence of the linear solver. The computation of a single timestep on a 256 2 grid performed on a Silicon Graphics workstation with an R10000 processor requires a few seconds.</p><p>Computing time in 3D is currently even much more expensive. But there is still a great potential to speed up the algorithm considerably, for instance by taking into account better ordering strategies for the unknowns which correspond to the anisotropy. This will be exploited in future. Furthermore, the code is prepared to incorporate spacial grid adaptivity if possible.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Comparison to Other Methods</head><p>So far we have introduced a novel approach which provides as with an intuitive understanding of complex flow fields. We have discussed a variety of important properties and advantages. Let us now rank this method among other visualization methods and compare it with different techniques. Here we especially pick up the line integral convolution method and the spot noise approach. For stationary flow fields we obtain similar results by both methods. Thin flow aligned patterns are generated. Line integral convolution leads to comparable results with the essential difference that the PDE based method carry a nice scale space property. I. e. evolving a longer time in the anisotropic diffusion method we obtain a successive coarsening of the resulting flow representation.</p><p>Furthermore in a restricted sense, line integral convolution (LIC) and spot noise can be regarded as special cases of the anisotropic nonlinear diffusion method. LIC with Gaussian filter kernel can be identified as the asymptotic limit of the latter method for a concentration of the edge enhancing function G at 0 . Other filter kernel shapes correspond to different, in general non linear diffusion processes along streamlines. Further on, generating a single deformed spot on the computational domain like proposed in <ref type="bibr" target="#b4">[5]</ref> can be regarded as an early timestep in the diffusion starting with initial data, that is a characteristic function of a circular disk. If we release a bunch of such disks as initial data in such a way that the evolving patterns do not overlap, then the resulting image is com- <ref type="figure" target="#fig_0">Figure 13</ref>: A sketch of the four sectors at a critical point, the initial spot for the diffusion calculation and the oriented system fv;v ? g . parable to spot noise. Thus, the original spot noise technique can be regarded as a parallel version of short time diffusive vector field visualization.</p><formula xml:id="formula_4">v v</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Towards Flow Segmentation</head><p>The above applications already show the capacity of the anisotropic nonlinear diffusion method to outline the flow structure not only locally. Indeed especially for larger evolution times in the diffusion process the topological skeleton of the flow field becomes clearly visible. We will now investigate a possible flow segmentation by means of the anisotropic diffusion. Let us restrict to the two dimensional case of an incompressible flow with vanishing velocity v at the domain boundary @ . Then topological regions are separated by homoclinic, respectively heteroclinic orbits connecting critical point in the interior of the domain and stagnation points on the boundary. Critical points, by definition points with vanishing velocity v = 0 , may either be saddle points or vortices. Furthermore we assume critical points to be non degenerate, i. e. rv is regular. Saddle points are characterized by two real eigenvalues of rv with opposite sign, whereas at vortices we obtain complex conjugate eigenvalues with vanishing real part. Stagnation points on @ are similar to saddles. For details we refer to <ref type="bibr" target="#b5">[6]</ref>. In each topological region there is a family of periodic orbits close to the heteroclinic, respectively homoclinic orbit. This observation gives reason for the following segmentation algorithm. At first, we search for critical points in and stagnation points on @ . We calculate the directions which separate the different topological regions. In case of saddle points these are the eigenvectors of rv. Next, we successively place an initial spot in each of the sectors and perform an appropriate field aligned anisotropic diffusion. Let us suppose that a single sector is spanned by vectors fs+; s ,g where the sign indicates incoming and outgoing direction. The method presented in Sect. 3 would lead to a closed pattern along one of the above closed orbits for time t large enough. To fill out the interior region we modify the diffusion as follows. Up to now the Perona Malik diffusions enhances edges of the current image in both directions normal to the velocity. Henceforth we select an orientation for a one sided diffusion (cf. <ref type="figure" target="#fig_0">Fig. 13</ref>). I. e. we select a unique normal v ? to v and consider the diffusion matrix</p><formula xml:id="formula_5">Av;r = Bv T Gr v ? + Bv ;</formula><p>where is a positive constant and s+ := maxfs; 0g . Furthermore we consider a non negative, concave function f : R + 0 ! R + 0 with f0; f 1 = 0 as a source term in the diffusion equation. If the orientation of fs+; s ,g coincides with that of fv;v ? g , then linear diffusion in the direction towards the interior will fill up the complete topological region. A segmentation of multiple topological regions at the same time is possible, if we carefully select the sectors to release initial spots. <ref type="figure" target="#fig_0">Figure 14</ref> shows different timesteps of the segmentation applied to a convective incompressible flow. Here we have placed these seeds as close as possible in terms of the grid size in the sectors spanned by the eigenvalues of the Jacobian of the velocity. Only to emphasize the evolution process a single greyscale image from the diffusion calculation (cf. <ref type="figure" target="#fig_5">Fig. 7</ref>) is underlying the sequence of segmentation timesteps. <ref type="figure" target="#fig_0">Figure 15</ref>: The adaptive quadtree on which we approximate the segmentation function at a certain timestep.</p><p>So far we have seen that anisotropic diffusion has strong provisions for flow segmentation as well. In a certain sense we thereby identify the complement of what is usually extracted in topology recognition. An outstanding advantage of the new method is its numerical stability and its self sharpening effect due to the edge enhancing strategy. We pay for this by a higher computational complexity. If we apply a standard implementation on a uniform grid of size n 2 , the segmentation cost is at least On 2 compared to a On count of grid cells met by the direct ODE integration to compute the homoclinic and heteroclinic orbits corresponding to the critical points. <ref type="figure" target="#fig_0">Fig 15 shows</ref> an adaptive quadtree, which allows the same resolution quality for the segmentation function as on a full grid, but now at a much lower cost. Thereby, we consider an piecewise linear and continuous Finite Element space on the adaptive quadtree.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8">Conclusions</head><p>We have introduced a new method based on the solution of a nonlinear anisotropic diffusion problem for the post processing of flow data. From a mathematical point of view one of the major advantages is, that it is based on a physically intuitive continuous model, i. e. streamline aligned diffusion. Most of the properties can be discussed on this level. Finally, it is discretized in an appropriate way making use of recent and efficient numerical algorithms.</p><p>From the authors' point of view exciting future research directions are further investigations of flow visualization in 3D. Expecially the exploiting of adaptive Finite Element paradigms and ordering strategies for the unknowns will be key issues to reduce the computing costs.</p><p>Furthermore, a visualization approach based on anisotropic diffusion and applicable for timedependent vector fields is a challenging topic. Finally, the anisotropic diffusion flow segmentation also carries provisions for the identification of interesting flow regions in 3D, such as recirculation zones and vortex cores.</p><p>Further results and the algorithm running on an nm 2D vector array is available as a source code at the URL:</p><p>http://www.iam.uni-bonn.de/SFB/visual/nonlinear.diffusion</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>The shape G which applied to the gradient of the mollified image intensity serves as a diffusion coefficient in image processing.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>The noisy image on the left is successively smoothed by nonlinear diffusion. On the right the resulting smoothed image with enhanced edges is shown.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 2</head><label>2</label><figDesc>gives an example of such a image smoothing and edge enhancement by nonlinear diffusion. The function f may serve as a penalty which forces the scale of images to stay close to the initial image, e. g. choosing</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 3 :Figure 4 :</head><label>34</label><figDesc>The coordinate transformation B(v). The graphs of the velocity dependent linear diffusion , respectively the scalar contrast enhancing right hand side f. direction, i. e. along streamlines, and the above introduced edge enhancing diffusion coefficient G acts in the orthogonal directions. Here Idn,1 is the identity matrix in dimension n , 1. We may either choose a linear function or in case of a velocity field, which spatially varies over several orders of magnitude, we select a monotone function (cf.Fig. 4) with 0 0 and lims!1 s = max .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 6 :</head><label>6</label><figDesc>A sketch of the vector valued contrast enhancing function f which leads to asymptotic states 1; 2 f 0g S m,1 0; 1 m . Here, the components of the density are interpreted as blue respectively green color values. The arrows indicate the direction of contrast enhancement.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 7 :</head><label>7</label><figDesc>Four successive diffusion timesteps are depicted from the vector valued nonlinear anisotropic diffusion method applied to a convective flow field in a 2D box.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 8 :</head><label>8</label><figDesc>Convective patterns in a 2D flow field are displayed and emphasized by the method of anisotropic nonlinear diffusion. The images show the velocity field of the flow at different timesteps. Thereby the resulting alignment is with respect to streamlines of this timedependent flow.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 9 :</head><label>9</label><figDesc>LIC image generated for one of the data sets that have already been processed inFig. 8by nonlinear diffusion.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 10 :</head><label>10</label><figDesc>Field aligned diffusion clearly outlines the principle features of a porous media flow in the vicinity of a salt dome.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Figure 14 :</head><label>14</label><figDesc>Nonlinear diffusion segmentation is applied to a velocity field from a Bénard convection. Several timesteps are shown starting from initial seed spots in critical point sectors.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>where is a positive constant. Now we incorporate anisotropic diffusion. For a given vector field v : ! R n we consider linear diffusion in the direction of the vector field and a Perona Malik type diffusion orthogonal to the field. Let us suppose that v is continuous and v 6 = 0 on . Then there exists an family of continuous orthogonal mappings Bv : ! SOn such that Bvv = e0 , where feigi=0;;n,1</figDesc><table /><note></note></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgement</head><p>The authors would like to acknowledge Karol Mikula and Jarke van Wijk for inspiring discussions and many useful comments on image processing and flow visualization. Furthermore they thank Eberhard Bänsch from Bremen University and Klaus Johannsen from Stuttgart University for providing the incompressible flow data sets, respectively the porous media simulation data.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Axioms and fundamental equations of image processing</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Alvarez</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Guichard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P.-L</forename><surname>Lions</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J.-M</forename><surname>Morel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Arch. Ration. Mech. Anal</title>
		<imprint>
			<biblScope unit="volume">123</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="199" to="257" />
			<date type="published" when="1993" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Visualization of time-dependent velocity fields by texture transport</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Becker</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Rumpf</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Eurographics Scientific Visualization Workshop &apos;98</title>
		<meeting>the Eurographics Scientific Visualization Workshop &apos;98</meeting>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Parallel multilevel preconditioners</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Bramble</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Pasciak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Xu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Math. of Comp</title>
		<imprint>
			<biblScope unit="volume">55</biblScope>
			<biblScope unit="page" from="1" to="22" />
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Imaging vector fields using line integral convolution</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Cabral</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Leedom</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Computer Graphics (SIGGRAPH &apos;93 Proceedings)</title>
		<editor>J. T. Kajiya</editor>
		<imprint>
			<date type="published" when="1993-08" />
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="263" to="272" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Enhanced spot noise for vector field visualization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><forename type="middle">C</forename><surname>De Leeuw</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">J</forename><surname>Van Wijk</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings Visualization &apos;95</title>
		<meeting>Visualization &apos;95</meeting>
		<imprint>
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Visualizing Vector Field Topology in Fluid Flows</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">L</forename><surname>Helman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Hesselink</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE G&amp;A</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="36" to="46" />
			<date type="published" when="1991" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Stragegies for effectively visualizing 3d flow with volume lic</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Interrante</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Grosch</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings Visualization &apos;97</title>
		<meeting>Visualization &apos;97</meeting>
		<imprint>
			<date type="published" when="1997" />
			<biblScope unit="page" from="285" to="292" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Solution of nonlinear diffusion appearing in image smoothing ansd edge detection</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kacur</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Mikula</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Appl. Numer. Math</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="47" to="59" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Maximum and comparison principle for one-dimensional anisotropic diffusion</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Kawohl</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Kutev</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Math. Ann</title>
		<imprint>
			<biblScope unit="volume">311</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="107" to="123" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Multi-frequency noise for lic</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M.-H</forename><surname>Kiu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">C</forename><surname>Banks</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings Visualization &apos;96</title>
		<meeting>Visualization &apos;96</meeting>
		<imprint>
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Flow visualization using moving textures</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Max</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Becker</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the ICASE/LaRC Symposium on Time Varying Data, NASA Conference Publication 3321</title>
		<meeting>the ICASE/LaRC Symposium on Time Varying Data, NASA Conference Publication 3321</meeting>
		<imprint>
			<date type="published" when="1996" />
			<biblScope unit="page" from="77" to="87" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Visualizing 3D Velocity Fields Near Contour Surface</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Max</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Crawfis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Grant</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of IEEE Visualization &apos;94</title>
		<meeting>IEEE Visualization &apos;94</meeting>
		<imprint>
			<date type="published" when="1994" />
			<biblScope unit="page" from="248" to="254" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Scale space and edge detection using anisotropic diffusion</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Perona</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Malik</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Computer Society Workshop on Computer Vision</title>
		<imprint>
			<date type="published" when="1987" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Uflic: A line integral convolution algorithm for visualizing unsteady flows</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H.-W</forename><surname>Shen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">L</forename><surname>Kao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings Visualization &apos;97</title>
		<meeting>Visualization &apos;97</meeting>
		<imprint>
			<date type="published" when="1997" />
			<biblScope unit="page" from="317" to="322" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Fast and resolution independent line integral convolution</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Stalling</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H.-C</forename><surname>Hege</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">SIGGRAPH 95 Conference Proceedings</title>
		<imprint>
			<publisher>Addison Wesley</publisher>
			<date type="published" when="1995-08" />
			<biblScope unit="page" from="249" to="256" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Fast display of illuminated field lines</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Stalling</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Zöckler</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H.-C</forename><surname>Hege</surname></persName>
		</author>
		<idno>1077-2626</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Visualization and Computer Graphics</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">2</biblScope>
			<date type="published" when="1997-06" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Image-guided streamline placement</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Turk</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Banks</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Computer Graphics (SIGGRAPH &apos;96 Proceedings)</title>
		<imprint>
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Spot noise-texture synthesis for data visualization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">J</forename><surname>Van Wijk</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Computer Graphics (SIG-GRAPH &apos;91 Proceedings)</title>
		<editor>T. W. Sederberg</editor>
		<imprint>
			<date type="published" when="1991-07" />
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="309" to="318" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Flow visualization with surface particles</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">J</forename><surname>Van Wijk</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Computer Graphics and Applications</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="18" to="24" />
			<date type="published" when="1993-07" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Implicit stream surfaces</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">J</forename><surname>Van Wijk</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Visualization &apos;93</title>
		<imprint>
			<date type="published" when="1993" />
			<biblScope unit="page" from="245" to="252" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Anisotropic diffusion in image processing</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Weikart</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Teubner</title>
		<imprint>
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
